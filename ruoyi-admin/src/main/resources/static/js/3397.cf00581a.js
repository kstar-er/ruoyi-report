(self.webpackChunksystem=self.webpackChunksystem||[]).push([[3397],{52262:function(t,e,n){"use strict";var r=n(82109),i=n(47908),s=n(26244),o=n(19303);n=n(51223);r({target:"Array",proto:!0},{at:function(t){var e=i(this),n=s(e);t=o(t),t=0<=t?t:n+t;return t<0||n<=t?void 0:e[t]}}),n("at")},24506:function(t,e,n){"use strict";var r=n(82109),i=n(1702),s=n(84488),o=n(19303),a=n(41340),l=(n=n(47293),i("".charAt));r({target:"String",proto:!0,forced:n((function(){return"\ud842"!=="𠮷".at(-2)}))},{at:function(t){var e=a(s(this)),n=e.length;t=o(t),t=0<=t?t:n+t;return t<0||n<=t?void 0:l(e,t)}})},65006:function(){"object"==typeof window&&window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),"undefined"!=typeof window&&[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach((t=>{Object.prototype.hasOwnProperty.call(t,"append")||Object.defineProperty(t,"append",{configurable:!0,enumerable:!0,writable:!0,value(...t){const e=document.createDocumentFragment();t.forEach((t=>{var n=t instanceof Node;e.appendChild(n?t:document.createTextNode(String(t)))})),this.appendChild(e)}})}))},73397:function(t,e,n){"use strict";n.d(e,{Y:function(){return o}});var r,i=n(3431);n(57658),e=function(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(o=(s<3?i(o):3<s?i(e,n,o):i(e,n))||o);return 3<s&&o&&Object.defineProperty(e,n,o),o};class s extends i.G7{get graph(){return this.options.graph}get boxClassName(){return this.prefixClassName(r.classNames.box)}get $boxes(){return i.is.children(this.container,this.boxClassName)}get handleOptions(){return this.options}constructor(t){super(),this.options=t,this.options.model&&(this.options.collection=this.options.model.collection),this.options.collection?this.collection=this.options.collection:(this.collection=new i.FE([],{comparator:r.depthComparator}),this.options.collection=this.collection),this.boxCount=0,this.createContainer(),this.startListening()}startListening(){var t=this.graph,e=this.collection;this.delegateEvents({["mousedown ."+this.boxClassName]:"onSelectionBoxMouseDown",["touchstart ."+this.boxClassName]:"onSelectionBoxMouseDown"},!0),t.on("scale",this.onGraphTransformed,this),t.on("translate",this.onGraphTransformed,this),t.model.on("updated",this.onModelUpdated,this),e.on("added",this.onCellAdded,this),e.on("removed",this.onCellRemoved,this),e.on("reseted",this.onReseted,this),e.on("updated",this.onCollectionUpdated,this),e.on("node:change:position",this.onNodePositionChanged,this),e.on("cell:changed",this.onCellChanged,this)}stopListening(){var t=this.graph,e=this.collection;this.undelegateEvents(),t.off("scale",this.onGraphTransformed,this),t.off("translate",this.onGraphTransformed,this),t.model.off("updated",this.onModelUpdated,this),e.off("added",this.onCellAdded,this),e.off("removed",this.onCellRemoved,this),e.off("reseted",this.onReseted,this),e.off("updated",this.onCollectionUpdated,this),e.off("node:change:position",this.onNodePositionChanged,this),e.off("cell:changed",this.onCellChanged,this)}onRemove(){this.stopListening()}onGraphTransformed(){this.updateSelectionBoxes()}onCellChanged(){this.updateSelectionBoxes()}onNodePositionChanged({node:t,options:e}){var{showNodeSelectionBox:n,pointerEvents:r}=this.options,{ui:i,selection:s,translateBy:o,snapped:a}=e,n=(!0!==n||r&&"none"===this.getPointerEventsValue(r))&&!this.translating&&!s,r=i&&o&&t.id===o;n&&(r||a)&&(this.translating=!0,s=t.position(),i=t.previous("position"),o=s.x-i.x,n=s.y-i.y,0==o&&0==n||this.translateSelectedNodes(o,n,t,e),this.translating=!1)}onModelUpdated({removed:t}){t&&t.length&&this.unselect(t)}isEmpty(){return this.length<=0}isSelected(t){return this.collection.has(t)}get length(){return this.collection.length}get cells(){return this.collection.toArray()}select(t,e={}){return e.dryrun=!0,t=this.filter(Array.isArray(t)?t:[t]),this.collection.add(t,e),this}unselect(t,e={}){return e.dryrun=!0,this.collection.remove(Array.isArray(t)?t:[t],e),this}reset(t,e={}){if(t){if(e.batch)n=this.filter(Array.isArray(t)?t:[t]),this.collection.reset(n,Object.assign(Object.assign({},e),{ui:!0}));else{var n=this.cells;t=this.filter(Array.isArray(t)?t:[t]);const r={},i={},s=(n.forEach((t=>r[t.id]=t)),t.forEach((t=>i[t.id]=t)),[]),o=[];t.forEach((t=>{r[t.id]||s.push(t)})),n.forEach((t=>{i[t.id]||o.push(t)})),o.length&&this.unselect(o,Object.assign(Object.assign({},e),{ui:!0})),s.length&&this.select(s,Object.assign(Object.assign({},e),{ui:!0})),0===o.length&&0===s.length&&this.updateContainer()}return this}return this.clean(e)}clean(t={}){return this.length&&(!1===t.batch?this.unselect(this.cells,t):this.collection.reset([],Object.assign(Object.assign({},t),{ui:!0}))),this}setFilter(t){this.options.filter=t}setContent(t){this.options.content=t}startSelecting(t){let e,n;t=this.normalizeEvent(t),this.clean();var s,o,a=this.graph.container;n=null!=t.offsetX&&null!=t.offsetY&&a.contains(t.target)?(e=t.offsetX,t.offsetY):(s=i.is.offset(a),o=a.scrollLeft,a=a.scrollTop,e=t.clientX-s.left+window.pageXOffset+o,t.clientY-s.top+window.pageYOffset+a),i.is.css(this.container,{top:n,left:e,width:1,height:1}),this.setEventData(t,{action:"selecting",clientX:t.clientX,clientY:t.clientY,offsetX:e,offsetY:n,scrollerX:0,scrollerY:0,moving:!1}),this.delegateDocumentEvents(r.documentEvents,t.data)}filter(t){const e=this.options.filter;return t.filter((t=>Array.isArray(e)?e.some((e=>"string"==typeof e?t.shape===e:t.id===e.id)):"function"!=typeof e||i.Iw.call(e,this.graph,t)))}stopSelecting(t){var e=this.graph,n=this.getEventData(t);switch(n.action){case"selecting":var r=i.is.width(this.container),s=i.is.height(this.container),o=i.is.offset(this.container),a=(o=e.pageToLocal(o.left,o.top),e.transform.getScale());a=(r/=a.sx,s/=a.sy,new i.Ae(o.x,o.y,r,s)),o=this.getCellViewsInArea(a).map((t=>t.cell));this.reset(o,{batch:!0}),this.hideRubberband();break;case"translating":r=e.snapToGrid(t.clientX,t.clientY),this.options.following||this.updateSelectedNodesPosition({dx:n.clientX-n.originX,dy:n.clientY-n.originY}),this.graph.model.stopBatch("move-selection"),this.notifyBoxEvent("box:mouseup",t,r.x,r.y);break;default:this.clean()}}onMouseUp(t){this.getEventData(t).action&&(this.stopSelecting(t),this.undelegateDocumentEvents())}onSelectionBoxMouseDown(t){this.options.following||t.stopPropagation();t=this.normalizeEvent(t);var e=(this.options.movable&&this.startTranslating(t),this.getCellViewFromElem(t.target));this.setEventData(t,{activeView:e}),e=this.graph.snapToGrid(t.clientX,t.clientY);this.notifyBoxEvent("box:mousedown",t,e.x,e.y),this.delegateDocumentEvents(r.documentEvents,t.data)}startTranslating(t){this.graph.model.startBatch("move-selection");var e=this.graph.snapToGrid(t.clientX,t.clientY);this.setEventData(t,{action:"translating",clientX:e.x,clientY:e.y,originX:e.x,originY:e.y})}getRestrictArea(){var t=this.graph.options.translating.restrict;t="function"==typeof t?i.Iw.call(t,this.graph,null):t;return"number"==typeof t?this.graph.transform.getGraphArea().inflate(t):!0===t?this.graph.transform.getGraphArea():t||null}getSelectionOffset(t,e){let n=t.x-e.clientX,r=t.y-e.clientY;var s,o,a,l,h=this.getRestrictArea();return h&&(l=this.collection.toArray(),l=i.bL.getCellsBBox(l,{deep:!0})||i.Ae.create(),s=h.x-l.x,o=h.y-l.y,a=h.x+h.width-(l.x+l.width),h=h.y+h.height-(l.y+l.height),n<s&&(n=s),r<o&&(r=o),a<n&&(n=a),h<r&&(r=h),this.options.following||(l=t.x-e.originX,t=t.y-e.originY,n=l<=s||a<=l?0:n,r=t<=o||h<=t?0:r)),{dx:n,dy:r}}updateElementPosition(t,e,n){var r=i.is.css(t,"left"),s=i.is.css(t,"top");r=r?parseFloat(r):0,s=s?parseFloat(s):0;i.is.css(t,"left",r+e),i.is.css(t,"top",s+n)}updateSelectedNodesPosition(t){var{dx:e,dy:n}=t;if(e||n)if(this.translateSelectedNodes(e,n),this.boxesUpdated)1<this.collection.length&&this.updateSelectionBoxes();else{var r=this.graph.transform.getScale();for(let t=0,i=this.$boxes,s=i.length;t<s;t+=1)this.updateElementPosition(i[t],e*r.sx,n*r.sy);this.updateElementPosition(this.selectionContainer,e*r.sx,n*r.sy)}}autoScrollGraph(t,e){var n=this.graph.getPlugin("scroller");return n?n.autoScroll(t,e):{scrollerX:0,scrollerY:0}}adjustSelection(t){var e=this.normalizeEvent(t),n=this.getEventData(e);switch(n.action){case"selecting":var r=n,{scrollerX:s,scrollerY:o}=(!0!==r.moving&&(i.is.appendTo(this.container,this.graph.container),this.showRubberband(),r.moving=!0),this.autoScrollGraph(e.clientX,e.clientY)),s=(r.scrollerX+=s,r.scrollerY+=o,e.clientX-r.clientX+r.scrollerX),o=e.clientY-r.clientY+r.scrollerY,a=parseInt(i.is.css(this.container,"left")||"0",10),l=parseInt(i.is.css(this.container,"top")||"0",10);i.is.css(this.container,{left:s<0?r.offsetX+s:a,top:o<0?r.offsetY+o:l,width:Math.abs(s),height:Math.abs(o)});break;case"translating":a=this.graph.snapToGrid(e.clientX,e.clientY),r=n,l=this.getSelectionOffset(a,r),this.options.following?this.updateSelectedNodesPosition(l):this.updateContainerPosition(l),l.dx&&(r.clientX=a.x),l.dy&&(r.clientY=a.y),this.notifyBoxEvent("box:mousemove",t,a.x,a.y)}this.boxesUpdated=!1}translateSelectedNodes(t,e,n,r){const i={},s=[];n&&(i[n.id]=!0),this.collection.toArray().forEach((t=>{t.getDescendants({deep:!0}).forEach((t=>{i[t.id]=!0}))})),r&&r.translateBy&&(n=this.graph.getCellById(r.translateBy))&&(i[n.id]=!0,n.getDescendants({deep:!0}).forEach((t=>{i[t.id]=!0})),s.push(n)),this.collection.toArray().forEach((n=>{if(!i[n.id]){const o=Object.assign(Object.assign({},r),{selection:this.cid,exclude:s});n.translate(t,e,o),this.graph.model.getConnectedEdges(n).forEach((n=>{i[n.id]||(n.translate(t,e,o),i[n.id]=!0)}))}}))}getCellViewsInArea(t){const e=this.graph;var n={strict:this.options.strict};let r=[];return this.options.rubberNode&&(r=r.concat(e.model.getNodesInArea(t,n).map((t=>e.renderer.findViewByCell(t))).filter((t=>null!=t)))),this.options.rubberEdge?r.concat(e.model.getEdgesInArea(t,n).map((t=>e.renderer.findViewByCell(t))).filter((t=>null!=t))):r}notifyBoxEvent(t,e,n,r){var i=this.getEventData(e).activeView;this.trigger(t,{e:e,view:i,x:n,y:r,cell:i.cell})}getSelectedClassName(t){return this.prefixClassName((t.isNode()?"node":"edge")+"-selected")}addCellSelectedClassName(t){var e=this.graph.renderer.findViewByCell(t);e&&e.addClass(this.getSelectedClassName(t))}removeCellUnSelectedClassName(t){var e=this.graph.renderer.findViewByCell(t);e&&e.removeClass(this.getSelectedClassName(t))}destroySelectionBox(t){this.removeCellUnSelectedClassName(t),this.canShowSelectionBox(t)&&(i.is.remove(this.container.querySelector(`[data-cell-id="${t.id}"]`)),0===this.$boxes.length&&this.hide(),this.boxCount=Math.max(0,this.boxCount-1))}destroyAllSelectionBoxes(t){t.forEach((t=>this.removeCellUnSelectedClassName(t))),this.hide(),i.is.remove(this.$boxes),this.boxCount=0}hide(){i.is.removeClass(this.container,this.prefixClassName(r.classNames.rubberband)),i.is.removeClass(this.container,this.prefixClassName(r.classNames.selected))}showRubberband(){i.is.addClass(this.container,this.prefixClassName(r.classNames.rubberband))}hideRubberband(){i.is.removeClass(this.container,this.prefixClassName(r.classNames.rubberband))}showSelected(){i.is.removeAttribute(this.container,"style"),i.is.addClass(this.container,this.prefixClassName(r.classNames.selected))}createContainer(){this.container=document.createElement("div"),i.is.addClass(this.container,this.prefixClassName(r.classNames.root)),this.options.className&&i.is.addClass(this.container,this.options.className),this.selectionContainer=document.createElement("div"),i.is.addClass(this.selectionContainer,this.prefixClassName(r.classNames.inner)),this.selectionContent=document.createElement("div"),i.is.addClass(this.selectionContent,this.prefixClassName(r.classNames.content)),i.is.append(this.selectionContainer,this.selectionContent),i.is.attr(this.selectionContainer,"data-selection-length",this.collection.length),i.is.prepend(this.container,this.selectionContainer)}updateContainerPosition(t){(t.dx||t.dy)&&this.updateElementPosition(this.selectionContainer,t.dx,t.dy)}updateContainer(){const t={x:1/0,y:1/0},e={x:0,y:0};this.collection.toArray().filter((t=>this.canShowSelectionBox(t))).forEach((n=>{n=this.graph.renderer.findViewByCell(n);n&&(n=n.getBBox({useCellGeometry:!0}),t.x=Math.min(t.x,n.x),t.y=Math.min(t.y,n.y),e.x=Math.max(e.x,n.x+n.width),e.y=Math.max(e.y,n.y+n.height))})),i.is.css(this.selectionContainer,{position:"absolute",pointerEvents:"none",left:t.x,top:t.y,width:e.x-t.x,height:e.y-t.y}),i.is.attr(this.selectionContainer,"data-selection-length",this.collection.length);var n,r=this.options.content;r&&("function"==typeof r?(n=i.Iw.call(r,this.graph,this,this.selectionContent))&&(this.selectionContent.innerHTML=n):this.selectionContent.innerHTML=r),0<this.collection.length&&!this.container.parentNode?i.is.appendTo(this.container,this.graph.container):this.collection.length<=0&&this.container.parentNode&&this.container.parentNode.removeChild(this.container)}canShowSelectionBox(t){return t.isNode()&&!0===this.options.showNodeSelectionBox||t.isEdge()&&!0===this.options.showEdgeSelectionBox}getPointerEventsValue(t){return"string"==typeof t?t:t(this.cells)}createSelectionBox(t){var e,n,r,s;this.addCellSelectedClassName(t),this.canShowSelectionBox(t)&&(e=this.graph.renderer.findViewByCell(t))&&(e=e.getBBox({useCellGeometry:!0}),n=this.boxClassName,r=document.createElement("div"),s=this.options.pointerEvents,i.is.addClass(r,n),i.is.addClass(r,n+"-"+(t.isNode()?"node":"edge")),i.is.attr(r,"data-cell-id",t.id),i.is.css(r,{position:"absolute",left:e.x,top:e.y,width:e.width,height:e.height,pointerEvents:s?this.getPointerEventsValue(s):"auto"}),i.is.appendTo(r,this.container),this.showSelected(),this.boxCount+=1)}updateSelectionBoxes(){0<this.collection.length&&(this.boxesUpdated=!0,this.confirmUpdate())}confirmUpdate(){if(this.boxCount){this.hide();for(let n=0,r=this.$boxes,s=r.length;n<s;n+=1){var t=r[n],e=i.is.attr(t,"data-cell-id");t=(i.is.remove(t),--this.boxCount,this.collection.get(e));t&&this.createSelectionBox(t)}this.updateContainer()}return 0}getCellViewFromElem(t){return t=t.getAttribute("data-cell-id"),t&&(t=this.collection.get(t),t)?this.graph.renderer.findViewByCell(t):null}onCellRemoved({cell:t}){this.destroySelectionBox(t),this.updateContainer()}onReseted({previous:t,current:e}){this.destroyAllSelectionBoxes(t),e.forEach((t=>{this.listenCellRemoveEvent(t),this.createSelectionBox(t)})),this.updateContainer()}onCellAdded({cell:t}){this.listenCellRemoveEvent(t),this.createSelectionBox(t),this.updateContainer()}listenCellRemoveEvent(t){t.off("removed",this.onCellRemoved,this),t.on("removed",this.onCellRemoved,this)}onCollectionUpdated({added:t,removed:e,options:n}){t.forEach((t=>{this.trigger("cell:selected",{cell:t,options:n}),t.isNode()?this.trigger("node:selected",{cell:t,options:n,node:t}):t.isEdge()&&this.trigger("edge:selected",{cell:t,options:n,edge:t})})),e.forEach((t=>{this.trigger("cell:unselected",{cell:t,options:n}),t.isNode()?this.trigger("node:unselected",{cell:t,options:n,node:t}):t.isEdge()&&this.trigger("edge:unselected",{cell:t,options:n,edge:t})})),t={added:t,removed:e,options:n,selected:this.cells.filter((t=>!!this.graph.getCellById(t.id)))},this.trigger("selection:changed",t)}dispose(){this.clean(),this.remove(),this.off()}}e([i.G7.dispose()],s.prototype,"dispose",null),n=r=r||{},e="widget-selection",n.classNames={root:e,inner:e+"-inner",box:e+"-box",content:e+"-content",rubberband:e+"-rubberband",selected:e+"-selected"},n.documentEvents={mousemove:"adjustSelection",touchmove:"adjustSelection",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},n.depthComparator=function(t){return t.getAncestors().length},i.kJ.prototype.isSelectionEnabled=function(){var t=this.getPlugin("selection");return!!t&&t.isEnabled()},i.kJ.prototype.enableSelection=function(){var t=this.getPlugin("selection");return t&&t.enable(),this},i.kJ.prototype.disableSelection=function(){var t=this.getPlugin("selection");return t&&t.disable(),this},i.kJ.prototype.toggleSelection=function(t){var e=this.getPlugin("selection");return e&&e.toggleEnabled(t),this},i.kJ.prototype.isMultipleSelection=function(){var t=this.getPlugin("selection");return!!t&&t.isMultipleSelection()},i.kJ.prototype.enableMultipleSelection=function(){var t=this.getPlugin("selection");return t&&t.enableMultipleSelection(),this},i.kJ.prototype.disableMultipleSelection=function(){var t=this.getPlugin("selection");return t&&t.disableMultipleSelection(),this},i.kJ.prototype.toggleMultipleSelection=function(t){var e=this.getPlugin("selection");return e&&e.toggleMultipleSelection(t),this},i.kJ.prototype.isSelectionMovable=function(){var t=this.getPlugin("selection");return!!t&&t.isSelectionMovable()},i.kJ.prototype.enableSelectionMovable=function(){var t=this.getPlugin("selection");return t&&t.enableSelectionMovable(),this},i.kJ.prototype.disableSelectionMovable=function(){var t=this.getPlugin("selection");return t&&t.disableSelectionMovable(),this},i.kJ.prototype.toggleSelectionMovable=function(t){var e=this.getPlugin("selection");return e&&e.toggleSelectionMovable(t),this},i.kJ.prototype.isRubberbandEnabled=function(){var t=this.getPlugin("selection");return!!t&&t.isRubberbandEnabled()},i.kJ.prototype.enableRubberband=function(){var t=this.getPlugin("selection");return t&&t.enableRubberband(),this},i.kJ.prototype.disableRubberband=function(){var t=this.getPlugin("selection");return t&&t.disableRubberband(),this},i.kJ.prototype.toggleRubberband=function(t){var e=this.getPlugin("selection");return e&&e.toggleRubberband(t),this},i.kJ.prototype.isStrictRubberband=function(){var t=this.getPlugin("selection");return!!t&&t.isStrictRubberband()},i.kJ.prototype.enableStrictRubberband=function(){var t=this.getPlugin("selection");return t&&t.enableStrictRubberband(),this},i.kJ.prototype.disableStrictRubberband=function(){var t=this.getPlugin("selection");return t&&t.disableStrictRubberband(),this},i.kJ.prototype.toggleStrictRubberband=function(t){var e=this.getPlugin("selection");return e&&e.toggleStrictRubberband(t),this},i.kJ.prototype.setRubberbandModifiers=function(t){var e=this.getPlugin("selection");return e&&e.setRubberbandModifiers(t),this},i.kJ.prototype.setSelectionFilter=function(t){var e=this.getPlugin("selection");return e&&e.setSelectionFilter(t),this},i.kJ.prototype.setSelectionDisplayContent=function(t){var e=this.getPlugin("selection");return e&&e.setSelectionDisplayContent(t),this},i.kJ.prototype.isSelectionEmpty=function(){var t=this.getPlugin("selection");return!t||t.isEmpty()},i.kJ.prototype.cleanSelection=function(t){var e=this.getPlugin("selection");return e&&e.clean(t),this},i.kJ.prototype.resetSelection=function(t,e){var n=this.getPlugin("selection");return n&&n.reset(t,e),this},i.kJ.prototype.getSelectedCells=function(){var t=this.getPlugin("selection");return t?t.getSelectedCells():[]},i.kJ.prototype.getSelectedCellCount=function(){var t=this.getPlugin("selection");return t?t.getSelectedCellCount():0},i.kJ.prototype.isSelected=function(t){var e=this.getPlugin("selection");return!!e&&e.isSelected(t)},i.kJ.prototype.select=function(t,e){var n=this.getPlugin("selection");return n&&n.select(t,e),this},i.kJ.prototype.unselect=function(t,e){var n=this.getPlugin("selection");return n&&n.unselect(t,e),this},e=function(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(o=(s<3?i(o):3<s?i(e,n,o):i(e,n))||o);return 3<s&&o&&Object.defineProperty(e,n,o),o};class o extends i.ew{get rubberbandDisabled(){return!0!==this.options.enabled||!0!==this.options.rubberband}get disabled(){return!0!==this.options.enabled}get length(){return this.selectionImpl.length}get cells(){return this.selectionImpl.cells}constructor(t={}){super(),this.name="selection",this.movedMap=new WeakMap,this.unselectMap=new WeakMap,this.options=Object.assign(Object.assign({enabled:!0},o.defaultOptions),t),i.mf.ensure(this.name,".x6-widget-selection {\n  position: absolute;\n  top: 0;\n  left: 0;\n  display: none;\n  width: 0;\n  height: 0;\n  touch-action: none;\n}\n.x6-widget-selection-rubberband {\n  display: block;\n  overflow: visible;\n  opacity: 0.3;\n}\n.x6-widget-selection-selected {\n  display: block;\n}\n.x6-widget-selection-box {\n  cursor: move;\n}\n.x6-widget-selection-inner[data-selection-length='0'],\n.x6-widget-selection-inner[data-selection-length='1'] {\n  display: none;\n}\n.x6-widget-selection-content {\n  position: absolute;\n  top: 100%;\n  right: -20px;\n  left: -20px;\n  margin-top: 30px;\n  padding: 6px;\n  line-height: 14px;\n  text-align: center;\n  border-radius: 6px;\n}\n.x6-widget-selection-content:empty {\n  display: none;\n}\n.x6-widget-selection-rubberband {\n  background-color: #3498db;\n  border: 2px solid #2980b9;\n}\n.x6-widget-selection-box {\n  box-sizing: content-box !important;\n  margin-top: -4px;\n  margin-left: -4px;\n  padding-right: 4px;\n  padding-bottom: 4px;\n  border: 2px dashed #feb663;\n  box-shadow: 2px 2px 5px #d3d3d3;\n}\n.x6-widget-selection-inner {\n  box-sizing: content-box !important;\n  margin-top: -8px;\n  margin-left: -8px;\n  padding-right: 12px;\n  padding-bottom: 12px;\n  border: 2px solid #feb663;\n  box-shadow: 2px 2px 5px #d3d3d3;\n}\n.x6-widget-selection-content {\n  color: #fff;\n  font-size: 10px;\n  background-color: #6a6b8a;\n}\n")}init(t){this.graph=t,this.selectionImpl=new s(Object.assign(Object.assign({},this.options),{graph:t})),this.setup(),this.startListening()}isEnabled(){return!this.disabled}enable(){this.disabled&&(this.options.enabled=!0)}disable(){this.disabled||(this.options.enabled=!1)}toggleEnabled(t){return null!=t?t!==this.isEnabled()&&(t?this.enable():this.disable()):this.isEnabled()?this.disable():this.enable(),this}isMultipleSelection(){return this.isMultiple()}enableMultipleSelection(){return this.enableMultiple(),this}disableMultipleSelection(){return this.disableMultiple(),this}toggleMultipleSelection(t){return null!=t?t!==this.isMultipleSelection()&&(t?this.enableMultipleSelection():this.disableMultipleSelection()):this.isMultipleSelection()?this.disableMultipleSelection():this.enableMultipleSelection(),this}isSelectionMovable(){return!1!==this.options.movable}enableSelectionMovable(){return this.selectionImpl.options.movable=!0,this}disableSelectionMovable(){return this.selectionImpl.options.movable=!1,this}toggleSelectionMovable(t){return null!=t?t!==this.isSelectionMovable()&&(t?this.enableSelectionMovable():this.disableSelectionMovable()):this.isSelectionMovable()?this.disableSelectionMovable():this.enableSelectionMovable(),this}isRubberbandEnabled(){return!this.rubberbandDisabled}enableRubberband(){return this.rubberbandDisabled&&(this.options.rubberband=!0),this}disableRubberband(){return this.rubberbandDisabled||(this.options.rubberband=!1),this}toggleRubberband(t){return null!=t?t!==this.isRubberbandEnabled()&&(t?this.enableRubberband():this.disableRubberband()):this.isRubberbandEnabled()?this.disableRubberband():this.enableRubberband(),this}isStrictRubberband(){return!0===this.selectionImpl.options.strict}enableStrictRubberband(){return this.selectionImpl.options.strict=!0,this}disableStrictRubberband(){return this.selectionImpl.options.strict=!1,this}toggleStrictRubberband(t){return null!=t?t!==this.isStrictRubberband()&&(t?this.enableStrictRubberband():this.disableStrictRubberband()):this.isStrictRubberband()?this.disableStrictRubberband():this.enableStrictRubberband(),this}setRubberbandModifiers(t){this.setModifiers(t)}setSelectionFilter(t){return this.setFilter(t),this}setSelectionDisplayContent(t){return this.setContent(t),this}isEmpty(){return this.length<=0}clean(t={}){return this.selectionImpl.clean(t),this}reset(t,e={}){return this.selectionImpl.reset(t?this.getCells(t):[],e),this}getSelectedCells(){return this.cells}getSelectedCellCount(){return this.length}isSelected(t){return this.selectionImpl.isSelected(t)}select(t,e={}){return t=this.getCells(t),t.length&&(this.isMultiple()?this.selectionImpl.select(t,e):this.reset(t.slice(0,1),e)),this}unselect(t,e={}){return this.selectionImpl.unselect(this.getCells(t),e),this}setup(){this.selectionImpl.on("*",((t,e)=>{this.trigger(t,e),this.graph.trigger(t,e)}))}startListening(){this.graph.on("blank:mousedown",this.onBlankMouseDown,this),this.graph.on("blank:click",this.onBlankClick,this),this.graph.on("cell:mousemove",this.onCellMouseMove,this),this.graph.on("cell:mouseup",this.onCellMouseUp,this),this.selectionImpl.on("box:mousedown",this.onBoxMouseDown,this)}stopListening(){this.graph.off("blank:mousedown",this.onBlankMouseDown,this),this.graph.off("blank:click",this.onBlankClick,this),this.graph.off("cell:mousemove",this.onCellMouseMove,this),this.graph.off("cell:mouseup",this.onCellMouseUp,this),this.selectionImpl.off("box:mousedown",this.onBoxMouseDown,this)}onBlankMouseDown({e:t}){var e,n;this.allowBlankMouseDown(t)&&(e=this.graph.panning.allowPanning(t,!0),n=(n=this.graph.getPlugin("scroller"))&&n.allowPanning(t,!0),this.allowRubberband(t,!0)||this.allowRubberband(t)&&!n&&!e)&&this.startRubberband(t)}allowBlankMouseDown(t){var e=this.options.eventTypes;return(null==e?void 0:e.includes("leftMouseDown"))&&0===t.button||(null==e?void 0:e.includes("mouseWheelDown"))&&1===t.button}onBlankClick(){this.clean()}allowRubberband(t,e){return!this.rubberbandDisabled&&i.tx.isMatch(t,this.options.modifiers,e)}allowMultipleSelection(t){return this.isMultiple()&&i.tx.isMatch(t,this.options.multipleSelectionModifiers)}onCellMouseMove({cell:t}){this.movedMap.set(t,!0)}onCellMouseUp({e:t,cell:e}){var n=this.options;let r=this.disabled;(r=!r&&this.movedMap.has(e)?(r=(r=!1===n.selectCellOnMoved)||!1===n.selectNodeOnMoved&&e.isNode())||!1===n.selectEdgeOnMoved&&e.isEdge():r)||(this.allowMultipleSelection(t)?this.unselectMap.has(e)?this.unselectMap.delete(e):this.isSelected(e)?this.unselect(e):this.select(e):this.reset(e)),this.movedMap.delete(e)}onBoxMouseDown({e:t,cell:e}){this.disabled||this.allowMultipleSelection(t)&&(this.unselect(e),this.unselectMap.set(e,!0))}getCells(t){return(Array.isArray(t)?t:[t]).map((t=>"string"==typeof t?this.graph.getCellById(t):t)).filter((t=>null!=t))}startRubberband(t){return this.rubberbandDisabled||this.selectionImpl.startSelecting(t),this}isMultiple(){return!1!==this.options.multiple}enableMultiple(){return this.options.multiple=!0,this}disableMultiple(){return this.options.multiple=!1,this}setModifiers(t){return this.options.modifiers=t,this}setContent(t){return this.selectionImpl.setContent(t),this}setFilter(t){return this.selectionImpl.setFilter(t),this}dispose(){this.stopListening(),this.off(),this.selectionImpl.dispose(),i.mf.clean(this.name)}}e([i.ew.dispose()],o.prototype,"dispose",null),(o=o||{}).defaultOptions={rubberband:!1,rubberNode:!0,rubberEdge:!1,pointerEvents:"auto",multiple:!0,multipleSelectionModifiers:["ctrl","meta"],movable:!0,strict:!1,selectCellOnMoved:!1,selectNodeOnMoved:!1,selectEdgeOnMoved:!1,following:!0,content:null,eventTypes:["leftMouseDown","mouseWheelDown"]}},3431:function(t,e,n){"use strict";n.d(e,{ew:function(){return yt},bL:function(){return Dc},FE:function(){return Xc},mf:function(){return o},is:function(){return s},Iw:function(){return i},kJ:function(){return Vg},tx:function(){return Xi},Ae:function(){return _s},bn:function(){return x},G7:function(){return xh}});var r,i={},s=(n.r(i),n.d(i,{apply:function(){return E},call:function(){return M},debounce:function(){return P.Z},isAsync:function(){return O},isAsyncLike:function(){return S},throttle:function(){return A.Z},toAsyncBoolean:function(){return T},toDeferredBoolean:function(){return N}}),{}),o=(n.r(s),n.d(s,{CASE_SENSITIVE_ATTR:function(){return sr},Event:function(){return qi},EventHook:function(){return mr},EventObject:function(){return Fi},KAPPA:function(){return ii},MouseWheelHandle:function(){return ws},addClass:function(){return Tn},after:function(){return tr},append:function(){return _n},appendTo:function(){return er},attr:function(){return ur},before:function(){return Qn},breakText:function(){return ri},children:function(){return ir},circleToPathData:function(){return gi},clearSelection:function(){return Dr},computeStyle:function(){return zr},computeStyleInt:function(){return Fr},contains:function(){return Wn},createElement:function(){return Vn},createElementNS:function(){return zn},createSVGMatrix:function(){return Pi},createSVGPoint:function(){return Ci},createSVGTransform:function(){return Ai},createSlicePathData:function(){return yi},createSvgDocument:function(){return $n},createSvgElement:function(){return Fn},css:function(){return $r},data:function(){return Zr},decomposeMatrix:function(){return Ti},ellipseToPathData:function(){return di},empty:function(){return Yn},ensureId:function(){return Bn},find:function(){return Zn},findOne:function(){return Un},findParentByClass:function(){return Jn},getAttribute:function(){return or},getClass:function(){return Sn},getComputedStyle:function(){return Br},getData:function(){return qr},getPointsFromSvgElement:function(){return ci},getTransformToElement:function(){return Ii},getTransformToParentElement:function(){return Vi},getVendorPrefixedName:function(){return jr},hasClass:function(){return On},hasScrollbars:function(){return Rr},height:function(){return As},index:function(){return Hn},isCSSVariable:function(){return Vr},isElement:function(){return nr},isHTMLElement:function(){return rr},isSVGGraphicsElement:function(){return Rn},kebablizeAttrs:function(){return gr},lineToPathData:function(){return ai},matrixToRotation:function(){return ki},matrixToScale:function(){return Ni},matrixToTransformString:function(){return Mi},matrixToTranslation:function(){return ji},measureText:function(){return ei},mergeAttrs:function(){return pr},ns:function(){return Dn},offset:function(){return Cs},parseTransformString:function(){return Si},parseXML:function(){return Gn},polygonToPathData:function(){return li},polylineToPathData:function(){return hi},position:function(){return Es},prepend:function(){return Kn},prop:function(){return Jr},qualifyAttr:function(){return cr},rectToPathData:function(){return fi},rectangleToPathData:function(){return pi},remove:function(){return Xn},removeAttribute:function(){return ar},removeClass:function(){return Nn},rotate:function(){return Ri},sample:function(){return oi},scale:function(){return Di},setAttribute:function(){return lr},setAttributes:function(){return hr},setData:function(){return Hr},setPrefixedStyle:function(){return Lr},splitTextByLength:function(){return ni},styleToObject:function(){return dr},svgVersion:function(){return In},tagName:function(){return qn},text:function(){return ti},toLocalPoint:function(){return zi},toPath:function(){return mi},toPathData:function(){return vi},toggleClass:function(){return kn},transform:function(){return Li},transformStringToMatrix:function(){return Ei},translate:function(){return Bi},uniqueId:function(){return Ln},width:function(){return Ps}}),{}),a=(e=(n.r(o),n.d(o,{clean:function(){return Zs},ensure:function(){return Hs}}),{}),n.r(e),n.d(e,{dot:function(){return Mo},doubleMesh:function(){return To},fixedDot:function(){return So},mesh:function(){return Oo}}),{}),l=(n.r(a),n.d(a,{flipX:function(){return ko},flipXY:function(){return Lo},flipY:function(){return jo},watermark:function(){return Bo}}),{}),h=(n.r(l),n.d(l,{blur:function(){return zo},brightness:function(){return Uo},contrast:function(){return Jo},dropShadow:function(){return Fo},grayScale:function(){return $o},highlight:function(){return Vo},hueRotate:function(){return Ho},invert:function(){return Zo},outline:function(){return Io},saturate:function(){return qo},sepia:function(){return Go}}),{}),u=(n.r(h),n.d(h,{async:function(){return el},block:function(){return Za},circle:function(){return rl},circlePlus:function(){return il},classic:function(){return Ua},cross:function(){return Qa},diamond:function(){return Xa},ellipse:function(){return al},path:function(){return _a}}),{}),c=(n.r(u),n.d(u,{annotations:function(){return ka},atConnectionLength:function(){return Pl},atConnectionLengthIgnoreGradient:function(){return xl},atConnectionLengthKeepGradient:function(){return bl},atConnectionRatio:function(){return Al},atConnectionRatioIgnoreGradient:function(){return Cl},atConnectionRatioKeepGradient:function(){return wl},connection:function(){return yl},displayEmpty:function(){return La},eol:function(){return ja},fill:function(){return Aa},filter:function(){return $a},html:function(){return Fa},lineHeight:function(){return Oa},port:function(){return Ga},ref:function(){return Xo},refCx:function(){return oa},refCy:function(){return aa},refD:function(){return da},refDKeepOffset:function(){return ha},refDResetOffset:function(){return la},refDx:function(){return Ko},refDy:function(){return Qo},refHeight:function(){return ea},refHeight2:function(){return ya},refPoints:function(){return pa},refPointsKeepOffset:function(){return ca},refPointsResetOffset:function(){return ua},refR:function(){return ga},refRCircumscribed:function(){return sa},refRInscribed:function(){return ia},refRx:function(){return na},refRy:function(){return ra},refWidth:function(){return ta},refWidth2:function(){return va},refX:function(){return Yo},refX2:function(){return fa},refY:function(){return _o},refY2:function(){return ma},resetOffset:function(){return Ia},sourceMarker:function(){return ul},stroke:function(){return Ea},style:function(){return za},targetMarker:function(){return cl},text:function(){return Ma},textPath:function(){return Na},textVerticalAnchor:function(){return Ta},textWrap:function(){return Sa},title:function(){return Ba},vertexMarker:function(){return gl},xAlign:function(){return Ra},yAlign:function(){return Da}}),{}),g=(n.r(c),n.d(c,{className:function(){return Ol},opacity:function(){return Nl},stroke:function(){return Vl}}),{}),d=(n.r(g),n.d(g,{absolute:function(){return $l},bottom:function(){return eh},ellipse:function(){return Gl},ellipseSpread:function(){return ql},left:function(){return Kl},line:function(){return _l},right:function(){return Ql},top:function(){return th}}),{}),p=(n.r(d),n.d(d,{bottom:function(){return hh},inside:function(){return gh},insideOriented:function(){return dh},left:function(){return oh},manual:function(){return sh},outside:function(){return uh},outsideOriented:function(){return ch},radial:function(){return vh},radialOriented:function(){return yh},right:function(){return ah},top:function(){return lh}}),{}),f=(n.r(p),n.d(p,{noop:function(){return Bh},pinAbsolute:function(){return Vh},pinRelative:function(){return Ih}}),{}),m=(n.r(f),n.d(f,{bottom:function(){return hu},bottomLeft:function(){return pu},bottomRight:function(){return fu},center:function(){return au},left:function(){return uu},midSide:function(){return Pu},nodeCenter:function(){return xu},orth:function(){return bu},right:function(){return cu},top:function(){return lu},topLeft:function(){return gu},topRight:function(){return du}}),{}),v=(n.r(m),n.d(m,{closest:function(){return Mu},length:function(){return Eu},orth:function(){return ju},ratio:function(){return Au}}),{}),y=(n.r(v),n.d(v,{anchor:function(){return Vu},bbox:function(){return Ru},boundary:function(){return Iu},rect:function(){return Du}}),{}),b=(n.r(y),n.d(y,{er:function(){return dc},loop:function(){return fc},manhattan:function(){return uc},metro:function(){return gc},normal:function(){return zu},oneSide:function(){return Fu},orth:function(){return Zu}}),{}),x=(n.r(b),n.d(b,{jumpover:function(){return Oc},loop:function(){return vc},normal:function(){return mc},rounded:function(){return yc},smooth:function(){return bc}}),{});n.r(x),n.d(x,{kS:function(){return ng}}),n(65006);class w{get disposed(){return!0===this._disposed}dispose(){this._disposed=!0}}(w||(w={})).dispose=function(){return(t,e,n)=>{const r=n.value,i=t.__proto__;n.value=function(...t){this.disposed||(r.call(this,...t),i.dispose.call(this))}}};class C{constructor(){this.isDisposed=!1,this.items=new Set}get disposed(){return this.isDisposed}dispose(){this.isDisposed||(this.isDisposed=!0,this.items.forEach((t=>{t.dispose()})),this.items.clear())}contains(t){return this.items.has(t)}add(t){this.items.add(t)}remove(t){this.items.delete(t)}clear(){this.items.clear()}}(r=C=C||{}).from=function(t){const e=new r;return t.forEach((t=>{e.add(t)})),e},n(57658);var P=n(37807),A=n(31976);function E(t,e,n){if(n)switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2]);case 4:return t.call(e,n[0],n[1],n[2],n[3]);case 5:return t.call(e,n[0],n[1],n[2],n[3],n[4]);case 6:return t.call(e,n[0],n[1],n[2],n[3],n[4],n[5]);default:return t.apply(e,n)}return t.call(e)}function M(t,e,...n){return E(t,e,n)}function S(t){return"object"==typeof t&&t.then&&"function"==typeof t.then}function O(t){return null!=t&&(t instanceof Promise||S(t))}function T(...t){const e=[];return t.forEach((t=>{Array.isArray(t)?e.push(...t):e.push(t)})),e.some((t=>O(t)))?(t=e.map((t=>O(t)?t:Promise.resolve(!1!==t))),Promise.all(t).then((t=>t.reduce(((t,e)=>!1!==e&&t),!0)))):e.every((t=>!1!==t))}function N(...t){return t=T(t),"boolean"==typeof t?Promise.resolve(t):t}function k(t,e){var n=[];for(let i=0;i<t.length;i+=2){var r=E(t[i],t[i+1],Array.isArray(e)?e:[e]);n.push(r)}return T(n)}var j=Object.prototype.hasOwnProperty;function L(t,e){return null!=t&&j.call(t,e)}var B=n(4717),R=function(t,e){return null!=t&&(0,B.Z)(t,e,L)},D=(n(81061),n(50242)),I=n(64205),V=n(705),z=n(71880),F=n(80493),$=n(57933),G=n(6791),q=n(76963),H=n(5497),Z=n(60976),U=Object.prototype.hasOwnProperty,J=function(t){if(null!=t){if((0,G.Z)(t)&&((0,$.Z)(t)||"string"==typeof t||"function"==typeof t.splice||(0,q.Z)(t)||(0,Z.Z)(t)||(0,F.Z)(t)))return!t.length;var e,n=(0,z.Z)(t);if("[object Map]"==n||"[object Set]"==n)return!t.size;if((0,H.Z)(t))return!(0,V.Z)(t).length;for(e in t)if(U.call(t,e))return!1}return!0},W=n(6049),X=n(60710),Y=n(21780),_=n(26468),K=n(7071),Q=n(30202),tt=n(74923),et=n(9760),nt=Object.prototype,rt=nt.hasOwnProperty,it=(0,K.Z)((function(t,e){t=Object(t);var n=-1,r=e.length,i=2<r?e[2]:void 0;for(i&&(0,tt.Z)(e[0],e[1],i)&&(r=1);++n<r;)for(var s=e[n],o=(0,et.Z)(s),a=-1,l=o.length;++a<l;){var h=o[a],u=t[h];(void 0===u||(0,Q.Z)(u,nt[h])&&!rt.call(t,h))&&(t[h]=s[h])}return t})),st=n(56095),ot=n(6331);function at(t,e,n,r,i,s){return(0,W.Z)(t)&&(0,W.Z)(e)&&(s.set(e,t),(0,ot.Z)(t,e,void 0,at,s),s.delete(e)),t}var lt,ht=(0,n(15529).Z)((function(t,e,n,r){(0,ot.Z)(t,e,n,r)})),ut=(0,K.Z)((function(t){return t.push(void 0,at),(0,st.Z)(ht,void 0,t)}));const ct=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}),gt=/^\s*class\s+/.test(""+class{})||/^\s*class\s*\{/.test(""+class{});function dt(t,e){let n;function r(){this.constructor=i}var i,s;return gt?n=class extends e{}:(n=function(){return e.apply(this,arguments)},i=n,s=e,ct(i,s),i.prototype=null===s?Object.create(s):(r.prototype=s.prototype,new r)),Object.defineProperty(n,"name",{value:t}),n}function pt(t){return"__proto__"===t}function ft(t,e,n="/"){let r;var i=Array.isArray(e)?e:e.split(n);if(i.length)for(r=t;i.length;){var s=i.shift();if(Object(r)!==r||!s||!(s in r))return;r=r[s]}return r}function mt(t,e,n,r="/"){if(e=Array.isArray(e)?e:e.split(r),r=e.pop(),r&&!pt(r)){let i=t;e.forEach((t=>{pt(t)||(null==i[t]&&(i[t]={}),i=i[t])})),i[r]=n}}function vt(t,e,n="/"){e=Array.isArray(e)?e.slice():e.split(n),n=e.pop();n&&(0<e.length?(e=ft(t,e))&&delete e[n]:delete t[n])}class yt extends class{constructor(){this.listeners={}}on(t,e,n){return null!=e&&(this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e,n)),this}once(t,e,n){const r=(...i)=>(this.off(t,r),k([e,n],i));return this.on(t,r,this)}off(t,e,n){if(t||e||n){const r=this.listeners;(t?[t]:Object.keys(r)).forEach((t=>{var i=r[t];if(i)if(e||n)for(let r=i.length-2;0<=r;r-=2)e&&i[r]!==e||n&&i[r+1]!==n||i.splice(r,2);else delete r[t]}))}else this.listeners={};return this}trigger(t,...e){let n=!0;if("*"!==t){const r=this.listeners[t];null!=r&&(n=k([...r],e))}const r=this.listeners["*"];return null!=r?T([n,k([...r],[t,...e])]):n}emit(t,...e){return this.trigger(t,...e)}}{dispose(){this.off()}}(function(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(o=(s<3?i(o):3<s?i(e,n,o):i(e,n))||o);3<s&&o&&Object.defineProperty(e,n,o)})([w.dispose()],yt.prototype,"dispose",null),(yt=yt||{}).dispose=w.dispose,lt=yt,[w].forEach((t=>{Object.getOwnPropertyNames(t.prototype).forEach((e=>{"constructor"!==e&&Object.defineProperty(lt.prototype,e,Object.getOwnPropertyDescriptor(t.prototype,e))}))}));var bt=n(94646),xt=function(t){return t&&t.length?(0,bt.Z)(t):[]},wt=n(38122),Ct=n(38590),Pt=Math.floor,At=Math.min,Et=function(t,e,n,r){var i=0,s=null==t?0:t.length;if(0===s)return 0;for(var o=(e=n(e))!=e,a=null===e,l=(0,Ct.Z)(e),h=void 0===e;i<s;){var u=Pt((i+s)/2),c=n(t[u]),g=void 0!==c,d=null===c,p=c==c,f=(0,Ct.Z)(c);p=o?r||p:h?p&&(r||g):a?p&&g&&(r||!d):l?p&&g&&!d&&(r||!f):!d&&!f&&(r?c<=e:c<e);p?i=u+1:s=u}return At(s,4294967294)},Mt=n(28345),St=function(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e==e&&i<=2147483647){for(;r<i;){var s=r+i>>>1,o=t[s];null!==o&&!(0,Ct.Z)(o)&&(n?o<=e:o<e)?r=1+s:i=s}return i}return Et(t,e,Mt.Z,n)},Ot=function(t,e){return St(t,e)},Tt=n(94774),Nt=function(t,e,n){return Et(t,e,(0,Tt.Z)(n,2))},kt=n(84920),jt=n(19345),Lt=n(34507),Bt=n(50137),Rt=function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t},Dt=n(22583),It=function(t,e){if(t!==e){var n=void 0!==t,r=null===t,i=t==t,s=(0,Ct.Z)(t),o=void 0!==e,a=null===e,l=e==e,h=(0,Ct.Z)(e);if(!a&&!h&&!s&&e<t||s&&o&&l&&!a&&!h||r&&o&&l||!n&&l||!i)return 1;if(!r&&!s&&!h&&t<e||h&&n&&i&&!r&&!s||a&&n&&i||!o&&i||!l)return-1}return 0},Vt=function(t,e,n){for(var r=-1,i=t.criteria,s=e.criteria,o=i.length,a=n.length;++r<o;){var l=It(i[r],s[r]);if(l)return a<=r?l:l*("desc"==n[r]?-1:1)}return t.index-e.index},zt=function(t,e,n){e=e.length?(0,jt.Z)(e,(function(t){return(0,$.Z)(t)?function(e){return(0,Lt.Z)(e,1===t.length?t[0]:t)}:t})):[Mt.Z];var r=-1;e=(0,jt.Z)(e,(0,Dt.Z)(Tt.Z)),t=(0,Bt.Z)(t,(function(t,n,i){return{criteria:(0,jt.Z)(e,(function(e){return e(t)})),index:++r,value:t}}));return Rt(t,(function(t,e){return Vt(t,e,n)}))},Ft=(0,K.Z)((function(t,e){var n;return null==t?[]:(1<(n=e.length)&&(0,tt.Z)(t,e[0],e[1])?e=[]:2<n&&(0,tt.Z)(e[0],e[1],e[2])&&(e=[e[0]]),zt(t,(0,kt.Z)(e,1),[]))})),$t=n(44441);function Gt(t,e,n,r){for(var i=-1,s=null==t?0:t.length;++i<s;){var o=t[i];e(r,o,n(o),t)}return r}var qt=n(4084);function Ht(t,e,n,r){return(0,qt.Z)(t,(function(t,i,s){e(r,t,n(t),s)})),r}var Zt=function(t,e){return function(n,r){var i=(0,$.Z)(n)?Gt:Ht,s=e?e():{};return i(n,t,(0,Tt.Z)(r,2),s)}},Ut=Object.prototype.hasOwnProperty,Jt=Zt((function(t,e,n){Ut.call(t,n)?t[n].push(e):(0,$t.Z)(t,n,[e])})),Wt=n(65896),Xt=n(26117),Yt=n(41746),_t=n(27121),Kt=function(t,e,n,r){var i=-1,s=Xt.Z,o=!0,a=t.length,l=[],h=e.length;if(a){n&&(e=(0,jt.Z)(e,(0,Dt.Z)(n))),r?(s=Yt.Z,o=!1):200<=e.length&&(s=_t.Z,o=!1,e=new Wt.Z(e));t:for(;++i<a;){var u=t[i],c=null==n?u:n(u);u=r||0!==u?u:0;if(o&&c==c){for(var g=h;g--;)if(e[g]===c)continue t;l.push(u)}else s(e,c,r)||l.push(u)}}return l},Qt=n(68583),te=(0,K.Z)((function(t,e){return(0,Qt.Z)(t)?Kt(t,(0,kt.Z)(e,1,Qt.Z,!0)):[]})),ee=function(t,e,n){for(var r=-1,i=t.length;++r<i;){var s,o,a=t[r],l=e(a);null!=l&&(void 0===s?l==l&&!(0,Ct.Z)(l):n(l,s))&&(s=l,o=a)}return o};function ne(t,e){return e<t}var re=function(t){return t&&t.length?ee(t,Mt.Z,ne):void 0},ie=n(15554),se=function(t,e,n,r){var i=-1,s=null==t?0:t.length;for(r&&s&&(n=t[++i]);++i<s;)n=e(n,t[i],i,t);return n},oe=function(t){return function(e){return null==t?void 0:t[e]}}({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),ae=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,le=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g"),he=function(t){return(t=(0,ie.Z)(t))&&t.replace(ae,oe).replace(le,"")},ue=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ce=function(t){return t.match(ue)||[]},ge=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,de=function(t){return ge.test(t)},pe=(Zt="\\ud800-\\udfff",K="\\u2700-\\u27bf","a-z\\xdf-\\xf6\\xf8-\\xff"),fe="A-Z\\xc0-\\xd6\\xd8-\\xde",me="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ve="["+me+"]",ye="["+K+"]",be="["+pe+"]",xe=(me="[^"+Zt+me+"\\d+"+K+pe+fe+"]",K="(?:\\ud83c[\\udde6-\\uddff]){2}",pe="[\\ud800-\\udbff][\\udc00-\\udfff]",fe="["+fe+"]","(?:"+be+"|"+me+")"),we=(me="(?:"+fe+"|"+me+")","(?:['’](?:d|ll|m|re|s|t|ve))?"),Ce="(?:['’](?:D|LL|M|RE|S|T|VE))?",Pe="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",Ae="[\\ufe0e\\ufe0f]?",Ee=(Zt=Ae+Pe+"(?:\\u200d(?:"+["[^"+Zt+"]",K,pe].join("|")+")"+Ae+Pe+")*",Ae="(?:"+[ye,K,pe].join("|")+")"+Zt,RegExp([fe+"?"+be+"+"+we+"(?="+[ve,fe,"$"].join("|")+")",me+"+"+Ce+"(?="+[ve,fe+xe,"$"].join("|")+")",fe+"?"+xe+"+"+we,fe+"+"+Ce,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])","\\d+",Ae].join("|"),"g")),Me=function(t){return t.match(Ee)||[]},Se=function(t,e,n){return t=(0,ie.Z)(t),void 0===(e=n?void 0:e)?(de(t)?Me:ce)(t):t.match(e)||[]},Oe=RegExp("['’]","g"),Te=(Pe=function(t){return function(e){return se(Se(he(e).replace(Oe,"")),t,"")}},n(67874)),Ne=function(t,e,n){var r=t.length;return n=void 0===n?r:n,!e&&r<=n?t:(0,Te.Z)(t,e,n)},ke=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),je=function(t){return ke.test(t)},Le=function(t){return t.split("")},Be=(ye="\\ud800-\\udfff",K="["+ye+"]",pe="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Zt="\\ud83c[\\udffb-\\udfff]",be="[^"+ye+"]",me="(?:\\ud83c[\\udde6-\\uddff]){2}",ve="[\\ud800-\\udbff][\\udc00-\\udfff]",xe="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",we="[\\ufe0e\\ufe0f]?",fe=we+xe+"(?:\\u200d(?:"+[be,me,ve].join("|")+")"+we+xe+")*",Ce="(?:"+[be+pe+"?",pe,me,ve,K].join("|")+")",RegExp(Zt+"(?="+Zt+")|"+Ce+fe,"g")),Re=function(t){return t.match(Be)||[]},De=function(t){return(je(t)?Re:Le)(t)},Ie=(Ae=function(t){return function(e){e=(0,ie.Z)(e);var n=je(e)?De(e):void 0,r=n?n[0]:e.charAt(0);n=n?Ne(n,1).join(""):e.slice(1);return r[t]()+n}},Ae("toUpperCase")),Ve=Pe((function(t,e,n){return t+(n?" ":"")+Ie(e)})),ze=function(t){return Ie((0,ie.Z)(t).toLowerCase())},Fe=Pe((function(t,e,n){return e=e.toLowerCase(),t+(n?ze(e):e)})),$e=Pe((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()})),Ge=Pe((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),qe=Ae("toLowerCase");ye=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))};const He=ye((t=>t.replace(/\B([A-Z])/g,"-$1").toLowerCase())),Ze=ye((t=>Ve(Fe(t)).replace(/ /g,"")));function Ue(t){let e=2166136261,n=!1,r=t;for(let i=0,s=r.length;i<s;i+=1){let t=r.charCodeAt(i);127<t&&!n&&(r=unescape(encodeURIComponent(r)),t=r.charCodeAt(i),n=!0),e=(e^=t)+((e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24))}return e>>>0}function Je(){let t="";var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";for(let i=0,s=e.length;i<s;i+=1){var n=e[i],r=16*Math.random()|0;t+=("x"===n?r:"y"===n?3&r|8:n).toString(16)}return t}function We(t,e,n){var r=Math.min(2,Math.floor(.34*t.length));let i,s=Math.floor(.4*t.length)+1,o=!1;var a=t.toLowerCase();for(const u of e){var l=n(u);if(void 0!==l&&Math.abs(l.length-a.length)<=r){var h=l.toLowerCase();if(h===a){if(l===t)continue;return u}o||l.length<3||void 0!==(l=function(t,e,n){let r=new Array(e.length+1),i=new Array(e.length+1);var s=n+1;for(let g=0;g<=e.length;g+=1)r[g]=g;for(let g=1;g<=t.length;g+=1){var o=t.charCodeAt(g-1),a=g>n?g-n:1,l=e.length>n+g?n+g:e.length;let c=i[0]=g;for(let t=1;t<a;t+=1)i[t]=s;for(let t=a;t<=l;t+=1){var h=o===e.charCodeAt(t-1)?r[t-1]:Math.min(r[t]+1,i[t-1]+1,r[t-1]+2);i[t]=h,c=Math.min(c,h)}for(let t=l+1;t<=e.length;t+=1)i[t]=s;if(c>n)return;var u=r;r=i,i=u}var c=r[e.length];return n<c?void 0:c}(a,h,s-1))&&(l<3?o=!0:s=l,i=u)}}return i}ye((t=>$e(t).replace(/ /g,"_"))),ye((t=>Ge(t).replace(/ /g,"."))),ye((t=>Ge(t).replace(/ /g,"/"))),ye((t=>Ie(Ge(t)))),ye((t=>Ve(Fe(t))));var Xe,Ye=n(60681),_e=n(13835),Ke=function(t){return"number"==typeof t||(0,_e.Z)(t)&&"[object Number]"==(0,Ye.Z)(t)},Qe=function(t,e,n){return t==t&&(void 0!==n&&(t=t<=n?t:n),void 0!==e)?e<=t?t:e:t},tn=n(48776),en=function(t,e,n){return void 0===n&&(n=e,e=void 0),void 0!==n&&(n=(n=(0,tn.Z)(n))==n?n:0),void 0!==e&&(e=(e=(0,tn.Z)(e))==e?e:0),Qe((0,tn.Z)(t),e,n)};function nn(t){return"string"==typeof t&&"%"===t.slice(-1)}function rn(t,e){if(null==t)return 0;let n;if("string"==typeof t){if(n=parseFloat(t),nn(t)&&(n/=100,Number.isFinite(n)))return n*e}else n=t;return Number.isFinite(n)?0<n&&n<1?n*e:n:0}function sn(t){if("object"==typeof t){let e=0,n=0,r=0,i=0;return null!=t.vertical&&Number.isFinite(t.vertical)&&(n=i=t.vertical),null!=t.horizontal&&Number.isFinite(t.horizontal)&&(r=e=t.horizontal),null!=t.left&&Number.isFinite(t.left)&&(e=t.left),null!=t.top&&Number.isFinite(t.top)&&(n=t.top),null!=t.right&&Number.isFinite(t.right)&&(r=t.right),null!=t.bottom&&Number.isFinite(t.bottom)&&(i=t.bottom),{top:n,right:r,bottom:i,left:e}}let e=0;return{top:e=null!=t&&Number.isFinite(t)?t:e,right:e,bottom:e,left:e}}let on=!1,an=!1,ln=!1,hn=!1,un=!1,cn=!1,gn=!1,dn=!1,pn=!1,fn=!1,mn=!1,vn=!1,yn=!1,bn=!1,xn=!1,wn=!1;if("object"==typeof navigator&&(we=navigator.userAgent,on=0<=we.indexOf("Macintosh"),an=!!we.match(/(iPad|iPhone|iPod)/g),ln=0<=we.indexOf("Windows"),hn=0<=we.indexOf("MSIE"),un=!!we.match(/Trident\/7\./),cn=!!we.match(/Edge\//),gn=0<=we.indexOf("Mozilla/")&&we.indexOf("MSIE")<0&&we.indexOf("Edge/")<0,pn=0<=we.indexOf("Chrome/")&&we.indexOf("Edge/")<0,fn=0<=we.indexOf("Opera/")||0<=we.indexOf("OPR/"),mn=0<=we.indexOf("Firefox/"),vn=0<=we.indexOf("AppleWebKit/")&&we.indexOf("Chrome/")<0&&we.indexOf("Edge/")<0,"object"==typeof document)&&(wn=!document.createElementNS||""+document.createElementNS("http://www.w3.org/2000/svg","foreignObject")!="[object SVGForeignObjectElement]"||0<=we.indexOf("Opera/")),"object"==typeof window&&(dn=null!=window.chrome&&null!=window.chrome.app&&null!=window.chrome.app.runtime,bn=null!=window.PointerEvent&&!on),"object"==typeof document){yn="ontouchstart"in document.documentElement;try{var Cn=Object.defineProperty({},"passive",{get(){xn=!0}}),Pn=document.createElement("div");Pn.addEventListener&&Pn.addEventListener("click",(()=>{}),Cn)}catch(n){}}(xe=Xe=Xe||{}).IS_MAC=on,xe.IS_IOS=an,xe.IS_WINDOWS=ln,xe.IS_IE=hn,xe.IS_IE11=un,xe.IS_EDGE=cn,xe.IS_NETSCAPE=gn,xe.IS_CHROME_APP=dn,xe.IS_CHROME=pn,xe.IS_OPERA=fn,xe.IS_FIREFOX=mn,xe.IS_SAFARI=vn,xe.SUPPORT_TOUCH=yn,xe.SUPPORT_POINTER=bn,xe.SUPPORT_PASSIVE=xn,xe.NO_FOREIGNOBJECT=wn,xe.SUPPORT_FOREIGNOBJECT=!xe.NO_FOREIGNOBJECT;{function qg(){var t=window.module;return null!=t&&null!=t.hot&&null!=t.hot.status?t.hot.status():"unkonwn"}(be=Xe=Xe||{}).getHMRStatus=qg,be.isApplyingHMR=function(){return"apply"===qg()};const Hg={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};be.isEventSupported=function(t){var e=document.createElement(Hg[t]||"div");let n=(t="on"+t)in e;return n||(e.setAttribute(t,"return;"),n="function"==typeof e[t]),n}}n(21703);const An=/[\t\r\n\f]/g,En=/\S+/g,Mn=t=>` ${t} `;function Sn(t){return t&&t.getAttribute&&t.getAttribute("class")||""}function On(t,e){var n;return null!=t&&null!=e&&(n=Mn(Sn(t)),e=Mn(e),1===t.nodeType)&&n.replace(An," ").includes(e)}function Tn(t,e){if(null!=t&&null!=e){if("function"==typeof e)return Tn(t,e(Sn(t)));if("string"==typeof e&&1===t.nodeType){e=e.match(En)||[];var n=Mn(Sn(t)).replace(An," ");let r=e.reduce(((t,e)=>t.indexOf(Mn(e))<0?""+t+e+" ":t),n);n!==(r=r.trim())&&t.setAttribute("class",r)}}}function Nn(t,e){if(null!=t){if("function"==typeof e)return Nn(t,e(Sn(t)));if((!e||"string"==typeof e)&&1===t.nodeType){var n=(e||"").match(En)||[],r=Mn(Sn(t)).replace(An," ");let i=n.reduce(((t,e)=>(e=Mn(e),-1<t.indexOf(e)?t.replace(e," "):t)),r);r!==(i=e?i.trim():"")&&t.setAttribute("class",i)}}}function kn(t,e,n){if(null!=t&&null!=e){if(null==n||"string"!=typeof e)return"function"==typeof e?kn(t,e(Sn(t),n),n):void("string"==typeof e&&(e.match(En)||[]).forEach((e=>{(On(t,e)?Nn:Tn)(t,e)})));(n?Tn:Nn)(t,e)}}let jn=0;function Ln(){return"v"+(jn+=1)}function Bn(t){return null!=t.id&&""!==t.id||(t.id=Ln()),t.id}function Rn(t){return null!=t&&"function"==typeof t.getScreenCTM&&t instanceof SVGElement}const Dn={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xml:"http://www.w3.org/XML/1998/namespace",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"},In="1.1";function Vn(t,e=document){return e.createElement(t)}function zn(t,e=Dn.xhtml,n=document){return n.createElementNS(e,t)}function Fn(t,e=document){return zn(t,Dn.svg,e)}function $n(t){return t?t=Gn(`<svg xmlns="${Dn.svg}" xmlns:xlink="${Dn.xlink}" version="${In}">${t}</svg>`,{async:!1}).documentElement:((t=document.createElementNS(Dn.svg,"svg")).setAttributeNS(Dn.xmlns,"xmlns:xlink",Dn.xlink),t.setAttribute("version",In)),t}function Gn(t,e={}){let n;try{var r=new DOMParser;null!=e.async&&(r.async=e.async),n=r.parseFromString(t,e.mimeType||"text/xml")}catch(t){n=void 0}if(!n||n.getElementsByTagName("parsererror").length)throw new Error("Invalid XML: "+t);return n}function qn(t,e=!0){return t=t.nodeName,e?t.toLowerCase():t.toUpperCase()}function Hn(t){let e=0,n=t.previousSibling;for(;n;)1===n.nodeType&&(e+=1),n=n.previousSibling;return e}function Zn(t,e){return t.querySelectorAll(e)}function Un(t,e){return t.querySelector(e)}function Jn(t,e,n){var r=t.ownerSVGElement;let i=t.parentNode;for(;i&&i!==n&&i!==r;){if(On(i,e))return i;i=i.parentNode}return null}function Wn(t,e){return e=e&&e.parentNode,t===e||!!(e&&1===e.nodeType&&16&t.compareDocumentPosition(e))}function Xn(t){t&&(Array.isArray(t)?t:[t]).forEach((t=>{t.parentNode&&t.parentNode.removeChild(t)}))}function Yn(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function _n(t,e){(Array.isArray(e)?e:[e]).forEach((e=>{null!=e&&t.appendChild(e)}))}function Kn(t,e){var n=t.firstChild;return n?Qn(n,e):_n(t,e)}function Qn(t,e){const n=t.parentNode;n&&(Array.isArray(e)?e:[e]).forEach((e=>{null!=e&&n.insertBefore(e,t)}))}function tr(t,e){const n=t.parentNode;n&&(Array.isArray(e)?e:[e]).forEach((e=>{null!=e&&n.insertBefore(e,t.nextSibling)}))}function er(t,e){null!=e&&e.appendChild(t)}function nr(t){return!!t&&1===t.nodeType}function rr(t){try{return t instanceof HTMLElement}catch(n){return"object"==typeof t&&1===t.nodeType&&"object"==typeof t.style&&"object"==typeof t.ownerDocument}}function ir(t,e){var n=[];let r=t.firstChild;for(;r;r=r.nextSibling)1!==r.nodeType||e&&!On(r,e)||n.push(r);return n}const sr=["viewBox","attributeName","attributeType","repeatCount","textLength","lengthAdjust","gradientUnits"];function or(t,e){return t.getAttribute(e)}function ar(t,e){var n=cr(e);n.ns?t.hasAttributeNS(n.ns,n.local)&&t.removeAttributeNS(n.ns,n.local):t.hasAttribute(e)&&t.removeAttribute(e)}function lr(t,e,n){if(null==n)return ar(t,e);var r=cr(e);r.ns&&"string"==typeof n?t.setAttributeNS(r.ns,e,n):"id"===e?t.id=""+n:t.setAttribute(e,""+n)}function hr(t,e){Object.keys(e).forEach((n=>{lr(t,n,e[n])}))}function ur(t,e,n){if(null==e){var r=t.attributes,i={};for(let t=0;t<r.length;t+=1)i[r[t].name]=r[t].value;return i}if("string"==typeof e&&void 0===n)return t.getAttribute(e);"object"==typeof e?hr(t,e):lr(t,e,n)}function cr(t){var e;return-1!==t.indexOf(":")?(e=t.split(":"),{ns:Dn[e[0]],local:e[1]}):{ns:null,local:t}}function gr(t){const e={};return Object.keys(t).forEach((n=>{var r=sr.includes(n)?n:He(n);e[r]=t[n]})),e}function dr(t){const e={};return t.split(";").forEach((t=>{t=t.trim();t&&(t=t.split("=")).length&&(e[t[0].trim()]=t[1]?t[1].trim():"")})),e}function pr(t,e){return Object.keys(e).forEach((n=>{if("class"===n)t[n]=t[n]?t[n]+" "+e[n]:e[n];else if("style"===n){var r="object"==typeof t[n],i="object"==typeof e[n];let s,o;o=r&&i?(s=t[n],e[n]):r?(s=t[n],dr(e[n])):i?(s=dr(t[n]),e[n]):(s=dr(t[n]),dr(e[n])),t[n]=pr(s,o)}else t[n]=e[n]})),t}var fr,mr,vr,yr,br,xr;function wr(t){return"data:"===t.substr(0,5)}function Cr(t){t=t.replace(/\s/g,"");var e=(t=decodeURIComponent(t)).indexOf(","),n=t.slice(0,e),r=n.split(":")[1].split(";")[0];t=t.slice(e+1);let i;i=0<=n.indexOf("base64")?atob(t):unescape(encodeURIComponent(t));var s=new Uint8Array(i.length);for(let o=0;o<i.length;o+=1)s[o]=i.charCodeAt(o);return new Blob([s],{type:r})}function Pr(t,e){var n=window.navigator.msSaveBlob;n?n(t,e):(n=window.URL.createObjectURL(t),(t=document.createElement("a")).href=n,t.download=e,document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(n))}function Ar(t){return t=parseFloat(t),Number.isNaN(t)?null:t}let Er;n(48675),n(63408),n(14590),n(3462),n(1439),n(87585),n(55315),n(82801),n(62062),(pe={}).isDataUrl=wr,pe.imageToDataUri=function(t,e){if(!t||wr(t))setTimeout((()=>e(null,t)));else{const n=()=>{e(new Error("Failed to load image: "+t))},r=window.FileReader?t=>{var r;200===t.status?((r=new FileReader).onload=t=>{t=t.target.result,e(null,t)},r.onerror=n,r.readAsDataURL(t.response)):n()}:r=>{if(200===r.status){let n=t.split(".").pop()||"png";var i=`data:image/${n="svg"===n?"svg+xml":n};base64,`;r=new Uint8Array(r.response),i=i+btoa((t=>{var e=[];for(let n=0;n<t.length;n+=32768)e.push(String.fromCharCode.apply(null,t.subarray(n,n+32768)));return e.join("")})(r));e(null,i)}else n()},i=new XMLHttpRequest;i.responseType=window.FileReader?"blob":"arraybuffer",i.open("GET",t,!0),i.addEventListener("error",n),i.addEventListener("load",(()=>r(i))),i.send()}},pe.dataUriToBlob=Cr,pe.downloadBlob=Pr,pe.downloadDataUri=function(t,e){Pr(Cr(t),e)},pe.svgToDataUrl=function(t,e={}){let n=null;var r=e=>{var r;return null!=(n=null==n?(r=(r=t).match(/<svg[^>]*viewBox\s*=\s*(["']?)(.+?)\1[^>]*>/i))&&r[2]?r[2].replace(/\s+/," ").split(" "):null:n)?Ar(n[e]):null},i=e=>(e=t.match(e),e&&e[2]?Ar(e[2]):null);let s=e.width;if(null==(s=null==(s=null==s?i(/<svg[^>]*width\s*=\s*(["']?)(.+?)\1[^>]*>/i):s)?r(2):s))throw new Error("Can not parse width from svg string");let o=e.height;if(null==(o=null==(o=null==o?i(/<svg[^>]*height\s*=\s*(["']?)(.+?)\1[^>]*>/i):o)?r(3):o))throw new Error("Can not parse height from svg string");return"data:image/svg+xml,"+encodeURIComponent(t).replace(/'/g,"%27").replace(/"/g,"%22")};const Mr={px(t){return t},mm(t){return Er*t},cm(t){return Er*t*10},in(t){return Er*t*25.4},pt(t){return Er*(25.4*t/72)},pc(t){return Er*(25.4*t/6)}};function Sr(t,e,n){var r=document.createElement("div"),i=r.style;i.display="inline-block",i.position="absolute",i.left="-15000px",i.top="-15000px",i.width=t+(n||"px"),i.height=e+(n||"px"),document.body.appendChild(r),t=r.getBoundingClientRect(),i={width:t.width||0,height:t.height||0};return document.body.removeChild(r),i}(me={}).measure=Sr,me.toPx=function(t,e){return null==Er&&(Er=Sr("1","1","mm").width),(e=e?Mr[e]:null)?e(t):t};const Or=/-(.)/g,Tr={},Nr=["webkit","ms","moz","o"],kr="undefined"!=typeof document?document.createElement("div").style:{};function jr(t){var e;t=t.replace(Or,((t,e)=>e.toUpperCase()));return null==Tr[t]&&(e=t.charAt(0).toUpperCase()+t.slice(1),Tr[t]=t in kr?t:function(t){for(let n=0;n<Nr.length;n+=1){var e=Nr[n]+t;if(e in kr)return e}return null}(e)),Tr[t]}function Lr(t,e,n){var r=jr(e);null!=r&&(t[r]=n),t[e]=n}function Br(t,e){return t=(t.ownerDocument&&t.ownerDocument.defaultView&&t.ownerDocument.defaultView.opener?t.ownerDocument.defaultView:window).getComputedStyle(t,null),t&&e?t.getPropertyValue(e)||t[e]:t}function Rr(t){return t=Br(t),null!=t&&("scroll"===t.overflow||"auto"===t.overflow)}const Dr=function(){if("undefined"==typeof document)return function(){};const t=document;return t.selection?function(){t.selection.empty()}:window.getSelection?function(){var t=window.getSelection();t&&(t.empty?t.empty():t.removeAllRanges&&t.removeAllRanges())}:function(){}}(),Ir={animationIterationCount:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0};function Vr(t){return/^--/.test(t)}function zr(t,e,n){var r=window.getComputedStyle(t,null);return n?r.getPropertyValue(e)||void 0:r[e]||t.style[e]}function Fr(t,e){return parseInt(zr(t,e),10)||0}function $r(t,e,n){if("string"==typeof e){var r=Vr(e);if(r||(e=jr(e)),void 0===n)return zr(t,e,r);r||(i=e,s=n,n=Ir[i]||"number"!=typeof s?s:s+"px"),i=t.style,r?i.setProperty(e,n):i[e]=n}else{var i,s;for(const n in e)$r(t,n,e[n])}}const Gr=new WeakMap;function qr(t,e){if(e=Fe(e),t=Gr.get(t),t)return t[e]}function Hr(t,e,n){e=Fe(e);var r=Gr.get(t);r?r[e]=n:Gr.set(t,{[e]:n})}function Zr(t,e,n){if(!e){const e={};return Object.keys(Gr).forEach((n=>{e[n]=qr(t,n)})),e}if("string"==typeof e)return void 0===n?qr(t,e):void Hr(t,e,n);for(const r in e)Zr(t,r,e[r])}const Ur={class:"className",contenteditable:"contentEditable",for:"htmlFor",readonly:"readOnly",maxlength:"maxLength",tabindex:"tabIndex",colspan:"colSpan",rowspan:"rowSpan",usemap:"useMap"};function Jr(t,e,n){if(e){if("string"==typeof e)return e=Ur[e]||e,arguments.length<3?t[e]:void(t[e]=n);for(const n in e)Jr(t,n,e[n])}}class Wr{get[Symbol.toStringTag](){return Wr.toStringTag}get type(){return this.node.nodeName}get id(){return this.node.id}set id(t){this.node.id=t}constructor(t,e,n){if(!t)throw new TypeError("Invalid element to create vector");let r;var i;r=Wr.isVector(t)?t.node:"string"==typeof t?"svg"===t.toLowerCase()?$n():"<"===t[0]?(i=$n(t),document.importNode(i.firstChild,!0)):document.createElementNS(Dn.svg,t):t,this.node=r,e&&this.setAttributes(e),n&&this.append(n)}transform(t,e){return null==t?Li(this.node):(Li(this.node,t,e),this)}translate(t,e=0,n={}){return null==t?Bi(this.node):(Bi(this.node,t,e,n),this)}rotate(t,e,n,r={}){return null==t?Ri(this.node):(Ri(this.node,t,e,n,r),this)}scale(t,e){return null==t?Di(this.node):(Di(this.node,t,e),this)}getTransformToElement(t){return t=Wr.toNode(t),Ii(this.node,t)}removeAttribute(t){return ar(this.node,t),this}getAttribute(t){return or(this.node,t)}setAttribute(t,e){return lr(this.node,t,e),this}setAttributes(t){return hr(this.node,t),this}attr(t,e){return null==t?ur(this.node):"string"==typeof t&&void 0===e?ur(this.node,t):("object"==typeof t?ur(this.node,t):ur(this.node,t,e),this)}svg(){return this.node instanceof SVGSVGElement?this:Wr.create(this.node.ownerSVGElement)}defs(){var t=this.svg()||this,e=t.node.getElementsByTagName("defs")[0];return e?Wr.create(e):Wr.create("defs").appendTo(t)}text(t,e={}){return ti(this.node,t,e),this}tagName(){return qn(this.node)}clone(){return Wr.create(this.node.cloneNode(!0))}remove(){return Xn(this.node),this}empty(){return Yn(this.node),this}append(t){return _n(this.node,Wr.toNodes(t)),this}appendTo(t){return er(this.node,Wr.isVector(t)?t.node:t),this}prepend(t){return Kn(this.node,Wr.toNodes(t)),this}before(t){return Qn(this.node,Wr.toNodes(t)),this}replace(t){return this.node.parentNode&&this.node.parentNode.replaceChild(Wr.toNode(t),this.node),Wr.create(t)}first(){return this.node.firstChild?Wr.create(this.node.firstChild):null}last(){return this.node.lastChild?Wr.create(this.node.lastChild):null}get(t){return t=this.node.childNodes[t],t?Wr.create(t):null}indexOf(t){return Array.prototype.slice.call(this.node.childNodes).indexOf(Wr.toNode(t))}find(t){var e=[],n=Zn(this.node,t);if(n)for(let r=0,i=n.length;r<i;r+=1)e.push(Wr.create(n[r]));return e}findOne(t){return t=Un(this.node,t),t?Wr.create(t):null}findParentByClass(t,e){return t=Jn(this.node,t,e),t?Wr.create(t):null}matches(t){var e=this.node,n=(this.node.matches,e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector||null);return n&&n.call(e,t)}contains(t){return Wn(this.node,Wr.isVector(t)?t.node:t)}wrap(t){t=Wr.create(t);var e=this.node.parentNode;return null!=e&&e.insertBefore(t.node,this.node),t.append(this)}parent(t){let e=this;if(null==e.node.parentNode)return null;if(e=Wr.create(e.node.parentNode),null!=t)do{if("string"==typeof t?e.matches(t):e instanceof t)return e}while(e=Wr.create(e.node.parentNode));return e}children(){var t=this.node.childNodes,e=[];for(let n=0;n<t.length;n+=1)1===t[n].nodeType&&e.push(Wr.create(t[n]));return e}eachChild(t,e){var n=this.children();for(let r=0,i=n.length;r<i;r+=1)t.call(n[r],n[r],r,n),e&&n[r].eachChild(t,e);return this}index(){return Hn(this.node)}hasClass(t){return On(this.node,t)}addClass(t){return Tn(this.node,t),this}removeClass(t){return Nn(this.node,t),this}toggleClass(t,e){return kn(this.node,t,e),this}toLocalPoint(t,e){return zi(this.node,t,e)}sample(t=1){return this.node instanceof SVGPathElement?oi(this.node,t):[]}toPath(){return Wr.create(mi(this.node))}toPathData(){return vi(this.node)}}function Xr(t){var e;return null!=t&&(t instanceof fr||(null==(e=t[Symbol.toStringTag])||e===fr.toStringTag)&&t.node instanceof SVGElement&&"function"==typeof t.sample&&"function"==typeof t.toPath)}function Yr(t,e,n){return new fr(t,e,n)}function _r(t){return Xr(t)?t.node:t}(fr=Wr=Wr||{}).toStringTag="X6."+fr.name,fr.isVector=Xr,fr.create=Yr,fr.createVectors=function(t){if("<"!==t[0])return[Yr(t)];var e=$n(t),n=[];for(let i=0,s=e.childNodes.length;i<s;i+=1){var r=e.childNodes[i];n.push(Yr(document.importNode(r,!0)))}return n},fr.toNode=_r,fr.toNodes=function(t){return Array.isArray(t)?t.map((t=>_r(t))):[_r(t)]};const Kr=/em$/;function Qr(t,e){var n=parseFloat(t);return Kr.test(t)?n*e:n}function ti(t,e,n={}){e=e.replace(/ /g," ");var r=n.eol;let i=n.textPath;var s=n.textVerticalAnchor,o="middle"===s||"bottom"===s||"top"===s;let a=n.x;void 0===a&&(a=t.getAttribute("x")||0);var l=n.includeAnnotationIndices;let h=n.annotations;h&&!Array.isArray(h)&&(h=[h]);var u=n.lineHeight,c="auto"===u,g=c?"1.5em":u||"1em";let d=!0;var p,f;u=t.childNodes,(d=(1!==u.length||!(u=u[0])||"TITLE"!==u.tagName.toUpperCase())&&d)&&Yn(t),ur(t,{"xml:space":"preserve",display:e||n.displayEmpty?null:"none"}),u=ur(t,"font-size");let m,v=parseFloat(u);!v&&(v=16,o||h)&&!u&&ur(t,"font-size",""+v),m=i?("string"==typeof i&&(i={d:i}),n=i,u=t,u=Wr.create(u),p=Wr.create("textPath"),(f=n.d)&&void 0===n["xlink:href"]&&(f=Wr.create("path").attr("d",f).appendTo(u.defs()),p.attr("xlink:href","#"+f.id)),"object"==typeof n&&p.attr(n),p.node):document.createDocumentFragment();let y,b,x=0;var w=e.split("\n"),C=[],P=w.length-1;for(let M=0;M<=P;M+=1){y=g;let t="v-line";var A,E=Fn("tspan");let e,n=w[M];n?h?(A=function(t,e,n){var r,i=n.offset||0,s=[],o=[];let a,l=null;for(let g=0;g<t.length;g+=1){a=o[g]=t[g];for(let r=0,s=e.length;r<s;r+=1){var h=e[r],u=h.start+i,c=h.end+i;g>=u&&g<c&&("string"==typeof a?a=o[g]={t:t[g],attrs:h.attrs}:a.attrs=pr(pr({},a.attrs),h.attrs),n.includeAnnotationIndices)&&(null==a.annotations&&(a.annotations=[]),a.annotations.push(r))}(r=o[g-1])?W.Z(a)&&W.Z(r)?JSON.stringify(a.attrs)===JSON.stringify(r.attrs)?l.t+=a.t:(s.push(l),l=a):l=W.Z(a)||W.Z(r)?(s.push(l),a):(l||"")+a:l=a}return null!=l&&s.push(l),s}(n,h,{offset:-x,includeAnnotationIndices:l}),(A=(e=function(t,e,n){var r=n.eol,i=n.baseSize,s=n.lineHeight;let o,a=0;var l={},h=e.length-1;for(let d=0;d<=h;d+=1){let s=e[d],l=null;if("object"==typeof s){var u=s.attrs,c=Wr.create("tspan",u);o=c.node;let t=s.t;r&&d===h&&(t+=r),o.textContent=t;var g=u.class;g&&c.addClass(g),n.includeAnnotationIndices&&c.attr("annotations",s.annotations.join(",")),(l=void 0===(l=parseFloat(u["font-size"]))?i:l)&&l>a&&(a=l)}else r&&d===h&&(s+=r),o=document.createTextNode(s||" "),i&&i>a&&(a=i);t.appendChild(o)}return a&&(l.maxFontSize=a),s?l.lineHeight=s:a&&(l.lineHeight=1.2*a),l}(E,A,{eol:M!==P&&r,baseSize:v,lineHeight:c?null:g,includeAnnotationIndices:l})).lineHeight)&&c&&0!==M&&(y=A),0===M&&(b=.8*e.maxFontSize)):(r&&M!==P&&(n+=r),E.textContent=n):(E.textContent="-",t+=" v-empty-line",(A=E.style).fillOpacity=0,A.strokeOpacity=0,h&&(e={})),e&&C.push(e),0<M&&E.setAttribute("dy",y),(0<M||i)&&E.setAttribute("x",a),E.className.baseVal=t,m.appendChild(E),x+=n.length+1}if(o)if(h)y=function(t,e,n,r){if(!Array.isArray(e))return 0;var i=e.length;if(!i)return 0;let s=e[0];var o=Qr(s.maxFontSize,n)||n;let a=0;var l=Qr(r,n);for(let g=1;g<i;g+=1){var h=Qr((s=e[g]).lineHeight,n)||l;a+=h}var u=Qr(s.maxFontSize,n)||n;let c;switch(t){case"middle":c=o/2-.15*u-a/2;break;case"bottom":c=-.25*u-a;break;default:c=.8*o}return c}(s,C,v,g);else if("top"===s)y="0.8em";else{let t;switch(0<P?(t=parseFloat(g)||1,t*=P,Kr.test(g)||(t/=v)):t=0,s){case"middle":y=.3-t/2+"em";break;case"bottom":y=-t-.3+"em"}}else 0===s?y="0em":s?y=s:(y=0,null==t.getAttribute("y")&&t.setAttribute("y",""+(b||"0.8em")));m.firstChild.setAttribute("dy",y),t.appendChild(m)}function ei(t,e={}){var n,r,i=document.createElement("canvas").getContext("2d");return t?(n=[],r=e["font-size"]?parseFloat(e["font-size"])+"px":"14px",n.push(e["font-style"]||"normal"),n.push(e["font-variant"]||"normal"),n.push(e["font-weight"]||400),n.push(r),n.push(e["font-family"]||"sans-serif"),i.font=n.join(" "),i.measureText(t)):{width:0}}function ni(t,e,n,r={}){if(n<=e)return[t,""];var i=t.length,s={};let o=Math.round(e/n*i-1);for(o<0&&(o=0);0<=o&&o<i;){var a=t.slice(0,o),l=s[a]||ei(a,r).width,h=t.slice(0,o+1),u=s[h]||ei(h,r).width;if(s[a]=l,s[h]=u,e<l)--o;else{if(!(u<=e))break;o+=1}}return[t.slice(0,o),t.slice(o)]}function ri(t,e,n={},r={}){var i=e.width,s=e.height,o=r.eol||"\n",a=n.fontSize||14,l=(a=n.lineHeight?parseFloat(n.lineHeight):Math.ceil(1.4*a),Math.floor(s/a));if(-1<t.indexOf(o)){const i=Je(),s=[];return t.split(o).map((t=>{t=ri(t,Object.assign(Object.assign({},e),{height:Number.MAX_SAFE_INTEGER}),n,Object.assign(Object.assign({},r),{eol:i})),t&&s.push(...t.split(i))})),s.slice(0,l).join(o)}if(s=ei(t,n).width,s<i)return t;var h,u,c=[];let g=t,d=s,p=r.ellipsis,f=0;p&&("string"!=typeof p&&(p="…"),f=ei(p,n).width);for(let m=0;m<l;m+=1){if(!(d>i)){c.push(g);break}m===l-1?([h]=ni(g,i-f,d,n),c.push(p?""+h+p:h)):([h,u]=ni(g,i,d,n),c.push(h),g=u,d=ei(g,n).width)}return c.join(o)}const ii=.551784;function si(t,e,n=NaN){return t=t.getAttribute(e),null==t||(e=parseFloat(t),Number.isNaN(e))?n:e}function oi(t,e=1){var n,r=t.getTotalLength(),i=[];let s=0;for(;s<r;)n=t.getPointAtLength(s),i.push({distance:s,x:n.x,y:n.y}),s+=e;return i}function ai(t){return["M",si(t,"x1"),si(t,"y1"),"L",si(t,"x2"),si(t,"y2")].join(" ")}function li(t){return t=ci(t),0===t.length?null:ui(t)+" Z"}function hi(t){return t=ci(t),0===t.length?null:ui(t)}function ui(t){return"M "+t.map((t=>t.x+" "+t.y)).join(" L")}function ci(t){var e=[],n=t.points;if(n)for(let r=0,i=n.numberOfItems;r<i;r+=1)e.push(n.getItem(r));return e}function gi(t){var e=si(t,"cx",0),n=si(t,"cy",0),r=(t=si(t,"r"),t*ii);return["M",e,n-t,"C",e+r,n-t,e+t,n-r,e+t,n,"C",e+t,n+r,e+r,n+t,e,n+t,"C",e-r,n+t,e-t,n+r,e-t,n,"C",e-t,n-r,e-r,n-t,e,n-t,"Z"].join(" ")}function di(t){var e=si(t,"cx",0),n=si(t,"cy",0),r=si(t,"rx"),i=(t=si(t,"ry")||r,r*ii),s=t*ii;return["M",e,n-t,"C",e+i,n-t,e+r,n-s,e+r,n,"C",e+r,n+s,e+i,n+t,e,n+t,"C",e-i,n+t,e-r,n+s,e-r,n,"C",e-r,n-s,e-i,n-t,e,n-t,"Z"].join(" ")}function pi(t){return fi({x:si(t,"x",0),y:si(t,"y",0),width:si(t,"width",0),height:si(t,"height",0),rx:si(t,"rx",0),ry:si(t,"ry",0)})}function fi(t){let e;var n=t.x,r=t.y,i=t.width,s=t.height,o=Math.min(t.rx||t["top-rx"]||0,i/2),a=Math.min(t.rx||t["bottom-rx"]||0,i/2),l=Math.min(t.ry||t["top-ry"]||0,s/2);t=Math.min(t.ry||t["bottom-ry"]||0,s/2);return(e=o||a||l||t?["M",n,r+l,"v",s-l-t,"a",a,t,0,0,0,a,t,"h",i-2*a,"a",a,t,0,0,0,a,-t,"v",-(s-t-l),"a",o,l,0,0,0,-o,-l,"h",-(i-2*o),"a",o,l,0,0,0,-o,l,"Z"]:["M",n,r,"H",n+i,"V",r+s,"H",n,"V",r,"Z"]).join(" ")}function mi(t){var e=Fn("path");ur(e,ur(t)),t=vi(t);return t&&e.setAttribute("d",t),e}function vi(t){var e=t.tagName.toLowerCase();switch(e){case"path":return t.getAttribute("d");case"line":return ai(t);case"polygon":return li(t);case"polyline":return hi(t);case"ellipse":return di(t);case"circle":return gi(t);case"rect":return pi(t)}throw new Error(`"${e}" cannot be converted to svg path element.`)}function yi(t,e,n,r){var i=2*Math.PI-1e-6;let s=n,o=r;o<s&&(n=s,s=o,o=n);r=o-s,n=r<Math.PI?"0":"1";var a=Math.cos(s),l=Math.sin(s),h=Math.cos(o),u=Math.sin(o);return i<=r?t?`M0,${e}A${e},${e} 0 1,1 0,${-e}A${e},${e} 0 1,1 0,${e}M0,${t}A${t},${t} 0 1,0 0,${-t}A${t},${t} 0 1,0 0,${t}Z`:`M0,${e}A${e},${e} 0 1,1 0,${-e}A${e},${e} 0 1,1 0,${e}Z`:t?`M${e*a},${e*l}A${e},${e} 0 ${n},1 ${e*h},${e*u}L${t*h},${t*u}A${t},${t} 0 ${n},0 ${t*a},${t*l}Z`:`M${e*a},${e*l}A${e},${e} 0 ${n},1 ${e*h},${e*u}L0,0Z`}const bi=/(\w+)\(([^,)]+),?([^)]+)?\)/gi,xi=/[ ,]+/,wi=/^(\w+)\((.*)\)/;function Ci(t,e){var n=Fn("svg").createSVGPoint();return n.x=t,n.y=e,n}function Pi(t){var e=Fn("svg").createSVGMatrix();if(null!=t){var n=t,r=e;for(const t in n)r[t]=n[t]}return e}function Ai(t){var e=Fn("svg");return null!=t?(t instanceof DOMMatrix||(t=Pi(t)),e.createSVGTransformFromMatrix(t)):e.createSVGTransform()}function Ei(t){let e=Pi();var n=null!=t&&t.match(bi);if(n)for(let a=0,l=n.length;a<l;a+=1){var r,i,s=n[a].match(wi);if(s){let t,n,a,l=Pi();var o=s[2].split(xi);switch(s[1].toLowerCase()){case"scale":r=parseFloat(o[0]),i=void 0===o[1]?r:parseFloat(o[1]),l=l.scaleNonUniform(r,i);break;case"translate":t=parseFloat(o[0]),n=parseFloat(o[1]),l=l.translate(t,n);break;case"rotate":a=parseFloat(o[0]),t=parseFloat(o[1])||0,n=parseFloat(o[2])||0,l=0!==t||0!==n?l.translate(t,n).rotate(a).translate(-t,-n):l.rotate(a);break;case"skewx":a=parseFloat(o[0]),l=l.skewX(a);break;case"skewy":a=parseFloat(o[0]),l=l.skewY(a);break;case"matrix":l.a=parseFloat(o[0]),l.b=parseFloat(o[1]),l.c=parseFloat(o[2]),l.d=parseFloat(o[3]),l.e=parseFloat(o[4]),l.f=parseFloat(o[5]);break;default:continue}e=e.multiply(l)}}return e}function Mi(t){return t=t||{},`matrix(${null!=t.a?t.a:1},${null!=t.b?t.b:0},${null!=t.c?t.c:0},${null!=t.d?t.d:1},${null!=t.e?t.e:0},${null!=t.f?t.f:0})`}function Si(t){let e,n,r;t&&(i=xi,0<=t.trim().indexOf("matrix")?(s=Ti(Ei(t)),e=[s.translateX,s.translateY],n=[s.rotation],r=[s.scaleX,s.scaleY],s=[],0===e[0]&&0===e[1]||s.push(`translate(${e.join(",")})`),1===r[0]&&1===r[1]||s.push(`scale(${r.join(",")})`),0!==n[0]&&s.push(`rotate(${n[0]})`),t=s.join(" ")):((s=t.match(/translate\((.*?)\)/))&&(e=s[1].split(i)),(s=t.match(/rotate\((.*?)\)/))&&(n=s[1].split(i)),(s=t.match(/scale\((.*?)\)/))&&(r=s[1].split(i))));var i,s=r&&r[0]?parseFloat(r[0]):1;return{raw:t||"",translation:{tx:e&&e[0]?parseInt(e[0],10):0,ty:e&&e[1]?parseInt(e[1],10):0},rotation:{angle:n&&n[0]?parseInt(n[0],10):0,cx:n&&n[1]?parseInt(n[1],10):void 0,cy:n&&n[2]?parseInt(n[2],10):void 0},scale:{sx:s,sy:r&&r[1]?parseFloat(r[1]):s}}}function Oi(t,e){return{x:e.x*t.a+e.y*t.c,y:e.x*t.b+e.y*t.d}}function Ti(t){var e=Oi(t,{x:0,y:1}),n=Oi(t,{x:1,y:0});e=180/Math.PI*Math.atan2(e.y,e.x)-90;return{skewX:e,skewY:180/Math.PI*Math.atan2(n.y,n.x),translateX:t.e,translateY:t.f,scaleX:Math.sqrt(t.a*t.a+t.b*t.b),scaleY:Math.sqrt(t.c*t.c+t.d*t.d),rotation:e}}function Ni(t){let e,n,r,i;return t?(e=null==t.a?1:t.a,i=null==t.d?1:t.d,n=t.b,r=t.c):e=i=1,{sx:n?Math.sqrt(e*e+n*n):e,sy:r?Math.sqrt(r*r+i*i):i}}function ki(t){let e={x:0,y:1};return t&&(e=Oi(t,e)),t=180*Math.atan2(e.y,e.x)/Math.PI%360-90,{angle:t%360+(t<0?360:0)}}function ji(t){return{tx:t&&t.e||0,ty:t&&t.f||0}}function Li(t,e,n={}){if(null==e)return Ei(ur(t,"transform"));n.absolute?t.setAttribute("transform",Mi(e)):(n=t.transform,t=Ai(e),n.baseVal.appendItem(t))}function Bi(t,e,n=0,r={}){let i=ur(t,"transform");var s=Si(i);if(null==e)return s.translation;i=(i=s.raw).replace(/translate\([^)]*\)/g,"").trim(),e=r.absolute?e:s.translation.tx+e,r=r.absolute?n:s.translation.ty+n,t.setAttribute("transform",(`translate(${e},${r}) `+i).trim())}function Ri(t,e,n,r,i={}){let s=ur(t,"transform");var o=Si(s);if(null==e)return o.rotation;s=(s=o.raw).replace(/rotate\([^)]*\)/g,"").trim(),e%=360,i=i.absolute?e:o.rotation.angle+e,t.setAttribute("transform",(s+" "+`rotate(${i}${null!=n&&null!=r?`,${n},`+r:""})`).trim())}function Di(t,e,n){let r=ur(t,"transform");var i=Si(r);if(null==e)return i.scale;n=null==n?e:n,r=(r=i.raw).replace(/scale\([^)]*\)/g,"").trim(),t.setAttribute("transform",(r+" "+`scale(${e},${n})`).trim())}function Ii(t,e){return Rn(e)&&Rn(t)&&(e=e.getScreenCTM(),t=t.getScreenCTM(),e&&t)?e.inverse().multiply(t):Pi()}function Vi(t,e){let n=Pi();if(Rn(e)&&Rn(t)){let s=t;for(var r=[];s&&s!==e;){var i=Ei(s.getAttribute("transform")||null);r.push(i),s=s.parentNode}r.reverse().forEach((t=>{n=n.multiply(t)}))}return n}function zi(t,e,n){var r=t instanceof SVGSVGElement?t:t.ownerSVGElement,i=r.createSVGPoint();i.x=e,i.y=n;try{var s=r.getScreenCTM(),o=i.matrixTransform(s.inverse()),a=Ii(t,r).inverse();return o.matrixTransform(a)}catch(t){return i}}{ve=mr=mr||{};const Zg={};ve.get=function(t){return Zg[t]||{}},ve.register=function(t,e){Zg[t]=e},ve.unregister=function(t){delete Zg[t]}}{K=vr=vr||{};const Ug=new WeakMap;K.ensure=function(t){return Ug.has(t)||Ug.set(t,{events:Object.create(null)}),Ug.get(t)},K.get=function(t){return Ug.get(t)},K.remove=function(t){return Ug.delete(t)}}(Zt=yr=yr||{}).returnTrue=()=>!0,Zt.returnFalse=()=>!1,Zt.stopPropagationCallback=function(t){t.stopPropagation()},Zt.addEventListener=function(t,e,n){null!=t.addEventListener&&t.addEventListener(e,n)},Zt.removeEventListener=function(t,e,n){null!=t.removeEventListener&&t.removeEventListener(e,n)};{Ce=yr=yr||{};const Jg=/[^\x20\t\r\n\f]+/g,Wg=/^([^.]*)(?:\.(.+)|)/;Ce.splitType=function(t){return(t||"").match(Jg)||[""]},Ce.normalizeType=function(t){return{originType:(t=Wg.exec(t)||[])[1]&&t[1].trim(),namespaces:t[2]?t[2].split(".").map((t=>t.trim())).sort():[]}},Ce.isValidTarget=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType},Ce.isValidSelector=function(t,e){return!e||null!=t.querySelector&&null!=t.querySelector(e)}}{fe=yr=yr||{};let Xg=0;const Yg=new WeakMap;fe.ensureHandlerId=function(t){return Yg.has(t)||(Yg.set(t,Xg),Xg+=1),Yg.get(t)},fe.getHandlerId=function(t){return Yg.get(t)},fe.removeHandlerId=function(t){return Yg.delete(t)},fe.setHandlerId=function(t,e){return Yg.set(t,e)}}(yr||(yr={})).getHandlerQueue=function(t,e){var n=[],r=vr.get(t),i=(r=r&&r.events&&r.events[e.type])&&r.handlers||[],s=r?r.delegateCount:0;if(0<s&&!("click"===e.type&&"number"==typeof e.button&&1<=e.button))for(let u=e.target;u!==t;u=u.parentNode||t)if(1===u.nodeType&&("click"!==e.type||!0!==u.disabled)){var o=[],a={};for(let e=0;e<s;e+=1){var l=i[e],h=l.selector;if(null!=h&&null==a[h]){const e=[];t.querySelectorAll(h).forEach((t=>{e.push(t)})),a[h]=e.includes(u)}a[h]&&o.push(l)}o.length&&n.push({elem:u,handlers:o})}return s<i.length&&n.push({elem:t,handlers:i.slice(s)}),n},(yr||(yr={})).isWindow=function(t){return null!=t&&t===t.window},(yr||(yr={})).contains=function(t,e){var n=9===t.nodeType?t.documentElement:t;e=e&&e.parentNode;return t===e||!(!e||1!==e.nodeType||!(n.contains?n.contains(e):t.compareDocumentPosition&&16&t.compareDocumentPosition(e)))};class Fi{constructor(t,e){this.isDefaultPrevented=yr.returnFalse,this.isPropagationStopped=yr.returnFalse,this.isImmediatePropagationStopped=yr.returnFalse,this.isSimulated=!1,this.preventDefault=()=>{var t=this.originalEvent;this.isDefaultPrevented=yr.returnTrue,t&&!this.isSimulated&&t.preventDefault()},this.stopPropagation=()=>{var t=this.originalEvent;this.isPropagationStopped=yr.returnTrue,t&&!this.isSimulated&&t.stopPropagation()},this.stopImmediatePropagation=()=>{var t=this.originalEvent;this.isImmediatePropagationStopped=yr.returnTrue,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()},"string"==typeof t?this.type=t:t.type&&(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented?yr.returnTrue:yr.returnFalse,this.target=t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget,this.timeStamp=t.timeStamp),e&&Object.assign(this,e),this.timeStamp||(this.timeStamp=Date.now())}}(br=Fi=Fi||{}).create=function(t){return t instanceof br?t:new br(t)},(xr=Fi=Fi||{}).addProperty=function(t,e){Object.defineProperty(xr.prototype,t,{enumerable:!0,configurable:!0,get:"function"==typeof e?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})};{var $i=Fi=Fi||{};const _g={bubbles:!0,cancelable:!0,eventPhase:!0,detail:!0,view:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pageX:!0,pageY:!0,screenX:!0,screenY:!0,toElement:!0,pointerId:!0,pointerType:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,touches:!0,changedTouches:!0,targetTouches:!0,which:!0,altKey:!0,ctrlKey:!0,metaKey:!0,shiftKey:!0};Object.keys(_g).forEach((t=>$i.addProperty(t,_g[t])))}mr.register("load",{noBubble:!0}),mr.register("beforeunload",{postDispatch(t,e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}),mr.register("mouseenter",{delegateType:"mouseover",bindType:"mouseover",handle(t,e){let n;var r=e.relatedTarget,i=e.handleObj;return r&&(r===t||yr.contains(t,r))||(e.type=i.originType,n=i.handler.call(t,e),e.type="mouseover"),n}}),mr.register("mouseleave",{delegateType:"mouseout",bindType:"mouseout",handle(t,e){let n;var r=e.relatedTarget,i=e.handleObj;return r&&(r===t||yr.contains(t,r))||(e.type=i.originType,n=i.handler.call(t,e),e.type="mouseout"),n}});var Gi,qi,Hi,Zi,Ui,Ji,Wi,Xi,Yi,_i,Ki,Qi,ts,es,ns,rs,is,ss,os,as,ls,hs,us,cs,gs,ds,ps,fs,ms,vs,ys,bs,xs=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};{let Kg;function Qg(t,e,...n){var r=Fi.create(e);r.delegateTarget=t,e=mr.get(r.type);if(!e.preDispatch||!1!==e.preDispatch(t,r)){var i=yr.getHandlerQueue(t,r);for(let t=0,e=i.length;t<e&&!r.isPropagationStopped();t+=1){var s=i[t];r.currentTarget=s.elem;for(let t=0,e=s.handlers.length;t<e&&!r.isImmediatePropagationStopped();t+=1){var o,a=s.handlers[t];(null==r.rnamespace||a.namespace&&r.rnamespace.test(a.namespace))&&(r.handleObj=a,r.data=a.data,void 0!==(o=(o=mr.get(a.originType).handle)?o(s.elem,r,...n):a.handler.call(s.elem,r,...n)))&&!1===(r.result=o)&&(r.preventDefault(),r.stopPropagation())}}return e.postDispatch&&e.postDispatch(t,r),r.result}}Pe=Gi=Gi||{},Pe.on=function(t,e,n,r,i){if(yr.isValidTarget(t)){let l;var s,o,a;"function"!=typeof n&&(({handler:s,selector:o}=n),a=xs(n,["handler","selector"]),n=s,i=o,l=a);const h=vr.ensure(t);let u=h.handler;null==u&&(u=h.handler=function(e,...n){return Kg!==e.type?Qg(t,e,...n):void 0});const c=yr.ensureHandlerId(n);yr.splitType(e).forEach((e=>{var{originType:e,namespaces:s}=yr.normalizeType(e);if(e){var o=mr.get(a=e),a=(i?o.delegateType:o.bindType)||a,g=(o=mr.get(a),e=Object.assign({type:a,originType:e,data:r,selector:i,guid:c,handler:n,namespace:s.join(".")},l),h.events);let d=g[a];d||(d=g[a]={handlers:[],delegateCount:0},o.setup&&!1!==o.setup(t,r,s,u))||yr.addEventListener(t,a,u),o.add&&(yr.removeHandlerId(e.handler),o.add(t,e),yr.setHandlerId(e.handler,c)),i?(d.handlers.splice(d.delegateCount,0,e),d.delegateCount+=1):d.handlers.push(e)}}))}},Pe.off=function t(e,n,r,i,s){const o=vr.get(e);if(o){const a=o.events;a&&(yr.splitType(n).forEach((n=>{var{originType:l,namespaces:h}=yr.normalizeType(n);if(l){var u=mr.get(c=l),c=(i?u.delegateType:u.bindType)||c,g=a[c];if(g){var d=0<h.length?new RegExp(`(^|\\.)${h.join("\\.(?:.*\\.|)")}(\\.|$)`):null,p=g.handlers.length;for(let t=g.handlers.length-1;0<=t;--t){var f=g.handlers[t];!s&&l!==f.originType||r&&yr.getHandlerId(r)!==f.guid||!(null==d||f.namespace&&d.test(f.namespace))||!(null==i||i===f.selector||"**"===i&&f.selector)||(g.handlers.splice(t,1),f.selector&&--g.delegateCount,u.remove&&u.remove(e,f))}p&&0===g.handlers.length&&(u.teardown&&!1!==u.teardown(e,h,o.handler)||yr.removeEventListener(e,c,o.handler),delete a[c])}}else Object.keys(a).forEach((s=>{t(e,s+n,r,i,!0)}))})),0===Object.keys(a).length)&&vr.remove(e)}},Pe.dispatch=Qg,Pe.trigger=function(t,e,n,r){let i=t,s="string"==typeof t?t:t.type,o="string"==typeof t||null==i.namespace?[]:i.namespace.split(".");if(3!==n.nodeType&&8!==n.nodeType){-1<s.indexOf(".")&&(o=s.split("."),s=o.shift(),o.sort());var a=s.indexOf(":")<0&&"on"+s,l=((i=t instanceof Fi?t:new Fi(s,"object"==typeof t?t:null)).namespace=o.join("."),i.rnamespace=i.namespace?new RegExp(`(^|\\.)${o.join("\\.(?:.*\\.|)")}(\\.|$)`):null,i.result=void 0,i.target||(i.target=n),[i]),h=(Array.isArray(e)?l.push(...e):l.push(e),mr.get(s));if(r||!h.trigger||!1!==h.trigger(n,i,e)){let o;var u=[n];if(!r&&!h.noBubble&&!yr.isWindow(n)){o=h.delegateType||s;let e=n,r=n.parentNode;for(;null!=r;)u.push(r),r=(e=r).parentNode;t=n.ownerDocument||document;e===t&&(t=e.defaultView||e.parentWindow||window,u.push(t))}let d=n;for(let t=0,e=u.length;t<e&&!i.isPropagationStopped();t+=1){var c=u[t],g=(d=c,i.type=1<t?o:h.bindType||s,vr.get(c));g=(g&&g.events[i.type]&&g.handler&&g.handler.call(c,...l),a&&c[a]||null);g&&yr.isValidTarget(c)&&(i.result=g.call(c,...l),!1===i.result)&&i.preventDefault()}return i.type=s,r||i.isDefaultPrevented()||null!=(t=h.preventDefault)&&!1!==t(u.pop(),i,e)||!yr.isValidTarget(n)||a&&"function"==typeof n[s]&&!yr.isWindow(n)&&((r=n[a])&&(n[a]=null),Kg=s,i.isPropagationStopped()&&d.addEventListener(s,yr.stopPropagationCallback),n[s](),i.isPropagationStopped()&&d.removeEventListener(s,yr.stopPropagationCallback),Kg=void 0,r)&&(n[a]=r),i.result}}}}(Ae=qi=qi||{}).on=function(t,e,n,r,i){return Hi.on(t,e,n,r,i),t},Ae.once=function(t,e,n,r,i){return Hi.on(t,e,n,r,i,!0),t},Ae.off=function(t,e,n,r){return Hi.off(t,e,n,r),t},Ae.trigger=function(t,e,n,r){return Gi.trigger(e,n,t,r),t},(Zi=Hi=Hi||{}).on=function t(e,n,r,i,s,o){if("object"==typeof n)"string"!=typeof r&&(i=i||r,r=void 0),Object.keys(n).forEach((s=>t(e,s,r,i,n[s],o)));else{if(null==i&&null==s?(s=r,i=r=void 0):null==s&&("string"==typeof r?(s=i,i=void 0):(s=i,i=r,r=void 0)),!1===s)s=yr.returnFalse;else if(!s)return;if(o){const t=s;yr.setHandlerId(s=function(n,...r){return Zi.off(e,n),t.call(this,n,...r)},yr.ensureHandlerId(t))}Gi.on(e,n,s,i,r)}},Zi.off=function t(e,n,r,i){var s;if(n&&null!=n.preventDefault&&null!=n.handleObj)s=n.handleObj,t(n.delegateTarget,s.namespace?s.originType+"."+s.namespace:s.originType,s.selector,s.handler);else if("object"==typeof n){const i=n;Object.keys(i).forEach((n=>t(e,n,r,i[n])))}else!1!==r&&"function"!=typeof r||(i=r,r=void 0),!1===i&&(i=yr.returnFalse),Gi.off(e,n,i,r)};class ws{constructor(t,e,n){this.animationFrameId=0,this.deltaX=0,this.deltaY=0,this.eventName=Xe.isEventSupported("wheel")?"wheel":"mousewheel",this.target=t,this.onWheelCallback=e,this.onWheelGuard=n,this.onWheel=this.onWheel.bind(this),this.didWheel=this.didWheel.bind(this)}enable(){this.target.addEventListener(this.eventName,this.onWheel,{passive:!1})}disable(){this.target.removeEventListener(this.eventName,this.onWheel)}onWheel(t){if(null==this.onWheelGuard||this.onWheelGuard(t)){let e;this.deltaX+=t.deltaX,this.deltaY+=t.deltaY,t.preventDefault(),0===this.deltaX&&0===this.deltaY||(t.stopPropagation(),e=!0),!0===e&&0===this.animationFrameId&&(this.animationFrameId=requestAnimationFrame((()=>{this.didWheel(t)})))}}didWheel(t){this.animationFrameId=0,this.onWheelCallback(t,this.deltaX,this.deltaY),this.deltaX=0,this.deltaY=0}}function Cs(t){var e=t.getBoundingClientRect();t=t.ownerDocument.defaultView;return{top:e.top+t.pageYOffset,left:e.left+t.pageXOffset}}function Ps(t){return t.getBoundingClientRect().width}function As(t){return t.getBoundingClientRect().height}function Es(t){var e="fixed"===zr(t,"position");let n;if(n=e?{left:(r=t.getBoundingClientRect()).left,top:r.top}:Cs(t),!e){var r,i=t.ownerDocument;let e=t.offsetParent||i.documentElement;for(;(e===i.body||e===i.documentElement)&&"static"===zr(e,"position");)e=e.parentNode;e!==t&&nr(e)&&(r=Cs(e),n.top-=r.top+Fr(e,"borderTopWidth"),n.left-=r.left+Fr(e,"borderLeftWidth"))}return{top:n.top-Fr(t,"marginTop"),left:n.left-Fr(t,"marginLeft")}}function Ms(t,e=60){let n=null;return(...r)=>{n&&clearTimeout(n),n=window.setTimeout((()=>{t.apply(this,r)}),e)}}const Ss="undefined"!=typeof ResizeObserver?function(t){let e=null,n=[];const r=Ms((()=>{n.forEach((e=>{e(t)}))})),i=()=>{e&&(e.disconnect(),n=[],e=null)};return{element:t,bind:i=>{var s;e=e||((s=new ResizeObserver(r)).observe(t),r(),s),-1===n.indexOf(i)&&n.push(i)},destroy:i,unbind:t=>{t=n.indexOf(t),-1!==t&&n.splice(t,1),0===n.length&&e&&i()}}}:function(t){let e=null,n=[];const r=Ms((()=>{n.forEach((e=>e(t)))})),i=()=>{e&&e.parentNode&&(e.contentDocument&&e.contentDocument.defaultView.removeEventListener("resize",r),e.parentNode.removeChild(e),e=null,n=[])};return{element:t,bind:i=>{e=e||(()=>{"static"===getComputedStyle(t).position&&(t.style.position="relative");const e=document.createElement("object");return e.onload=()=>{e.contentDocument.defaultView.addEventListener("resize",r),r()},e.style.display="block",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.height="100%",e.style.width="100%",e.style.overflow="hidden",e.style.pointerEvents="none",e.style.zIndex="-1",e.style.opacity="0",e.setAttribute("tabindex","-1"),e.type="text/html",t.appendChild(e),e.data="about:blank",e})(),-1===n.indexOf(i)&&n.push(i)},destroy:i,unbind:t=>{t=n.indexOf(t),-1!==t&&n.splice(t,1),0===n.length&&e&&i()}}};{ye=Ui=Ui||{};const td=new WeakMap;function ed(t){var e=td.get(t);return e||(e=Ss(t),td.set(t,e)),e}ye.bind=(t,e)=>{const n=ed(t);return n.bind(e),()=>n.unbind(e)},ye.clear=t=>{t=ed(t);t.destroy(),td.delete(t.element)}}class Os{constructor(t={}){this.comparator=t.comparator||Os.defaultComparator,this.index={},this.data=t.data||[],this.heapify()}isEmpty(){return 0===this.data.length}insert(t,e,n){return t={priority:t,value:e},e=this.data.length,n&&(this.index[t.id=n]=e),this.data.push(t),this.bubbleUp(e),this}peek(){return this.data[0]?this.data[0].value:null}peekPriority(){return this.data[0]?this.data[0].priority:null}updatePriority(t,e){var n=this.index[t];if(void 0===n)throw new Error(`Node with id '${t}' was not found in the heap.`);t=this.data;var r=t[n].priority;r=this.comparator(e,r);r<0?(t[n].priority=e,this.bubbleUp(n)):0<r&&(t[n].priority=e,this.bubbleDown(n))}remove(){var t=this.data,e=t[0],n=t.pop();return e.id&&delete this.index[e.id],0<t.length&&((t[0]=n).id&&(this.index[n.id]=0),this.bubbleDown(0)),e?e.value:null}heapify(){for(let t=0;t<this.data.length;t+=1)this.bubbleUp(t)}bubbleUp(t){var e,n,r=this.data;let i=t;for(;0<i&&(n=i-1>>>1,this.comparator(r[i].priority,r[n].priority)<0);){e=r[n],r[n]=r[i];var s=r[i].id;null!=s&&(this.index[s]=n),r[i]=e,null!=(s=r[i].id)&&(this.index[s]=i),i=n}}bubbleDown(t){var e=this.data,n=e.length-1;let r=t;for(;;){var i=1+(r<<1),s=1+i;let t=r;if(i<=n&&this.comparator(e[i].priority,e[t].priority)<0&&(t=i),(t=s<=n&&this.comparator(e[s].priority,e[t].priority)<0?s:t)===r)break;i=e[t],e[t]=e[r],s=e[r].id,null!=s&&(this.index[s]=t),e[r]=i,null!=(s=e[r].id)&&(this.index[s]=r),r=t}}}(Os||(Os={})).defaultComparator=(t,e)=>t-e,(Ji||(Ji={})).run=function(t,e,n=((t,e)=>1)){const r={};var i={},s={};const o=new Os;for(r[e]=0,Object.keys(t).forEach((t=>{t!==e&&(r[t]=1/0),o.insert(r[t],t,t)}));!o.isEmpty();){var a=o.remove(),l=(s[a]=!0,t[a]||[]);for(let t=0;t<l.length;t+=1){var h,u=l[t];s[u]||(h=r[a]+n(a,u))<r[u]&&(r[u]=h,i[u]=a,o.updatePriority(u,h))}}return i};class Ts{constructor(t,e,n,r){return null==t?this.set(255,255,255,1):"number"==typeof t?this.set(t,e,n,r):"string"==typeof t?Ts.fromString(t)||this:Array.isArray(t)?this.set(t):void this.set(t.r,t.g,t.b,null==t.a?1:t.a)}blend(t,e,n){this.set(t.r+(e.r-t.r)*n,t.g+(e.g-t.g)*n,t.b+(e.b-t.b)*n,t.a+(e.a-t.a)*n)}lighten(t){t=Ts.lighten(this.toArray(),t),this.r=t[0],this.g=t[1],this.b=t[2],this.a=t[3]}darken(t){this.lighten(-t)}set(t,e,n,r){var i=Array.isArray(t)?t[0]:t;e=Array.isArray(t)?t[1]:e,n=Array.isArray(t)?t[2]:n,t=Array.isArray(t)?t[3]:r;return this.r=Math.round(en(i,0,255)),this.g=Math.round(en(e,0,255)),this.b=Math.round(en(n,0,255)),this.a=null==t?1:en(t,0,1),this}toHex(){return"#"+["r","g","b"].map((t=>(t=this[t].toString(16),t.length<2?"0"+t:t))).join("")}toRGBA(){return this.toArray()}toHSLA(){return Ts.rgba2hsla(this.r,this.g,this.b,this.a)}toCSS(t){var e=`${this.r},${this.g},${this.b},`;return t?`rgb(${e})`:`rgba(${e},${this.a})`}toGrey(){return Ts.makeGrey(Math.round((this.r+this.g+this.b)/3),this.a)}toArray(){return[this.r,this.g,this.b,this.a]}toString(){return this.toCSS()}}function Ns(t){return new Wi([...Ds(t),1])}function ks(t){t=t.toLowerCase().match(/^rgba?\(([\s.,0-9]+)\)/);return t?(t=t[1].split(/\s*,\s*/).map((t=>parseInt(t,10))),new Wi(t)):null}function js(t,e,n){n<0&&++n,1<n&&--n;var r=6*n;return r<1?t+(e-t)*r:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}function Ls(t){var e,n,r;t=t.toLowerCase().match(/^hsla?\(([\s.,0-9]+)\)/);return t?(t=t[2].split(/\s*,\s*/),e=(parseFloat(t[0])%360+360)%360/360,n=parseFloat(t[1])/100,r=parseFloat(t[2])/100,t=null==t[3]?1:parseInt(t[3],10),new Wi(Bs(e,n,r,t))):null}function Bs(t,e,n,r){var i=Array.isArray(t)?t[0]:t;e=Array.isArray(t)?t[1]:e,n=Array.isArray(t)?t[2]:n,t=Array.isArray(t)?t[3]:r,r=n<=.5?n*(e+1):n+e-n*e,e=2*n-r;return[256*js(e,r,i+1/3),256*js(e,r,i),256*js(e,r,i-1/3),null==t?1:t]}function Rs(t){return new Wi(Math.round(256*Math.random()),Math.round(256*Math.random()),Math.round(256*Math.random()),t?void 0:parseFloat(Math.random().toFixed(2)))}function Ds(t){t=0===t.indexOf("#")?t:"#"+t;let e=Number("0x"+t.substr(1));if(4!==t.length&&7!==t.length||Number.isNaN(e))throw new Error("Invalid hex color.");const n=4===t.length?4:8,r=(1<<n)-1;return t=["b","g","r"].map((()=>{var t=e&r;return e>>=n,4==n?17*t:t})),[t[2],t[1],t[0]]}function Is(t,e,n){var r=t=>t.length<2?"0"+t:t;return""+r(t.toString(16))+r(e.toString(16))+r(n.toString(16))}function Vs(t,e){var n,r,i,s;return"string"==typeof t?(s="#"===t[0],n=parseInt(s?t.substr(1):t,16),r=en((n>>16)+e,0,255),i=en((n>>8&255)+e,0,255),(s?"#":"")+(en((255&n)+e,0,255)|i<<8|r<<16).toString(16)):[(s=Ds(Vs(Is(t[0],t[1],t[2]),e)))[0],s[1],s[2],t[3]]}(Wi=Ts=Ts||{}).fromArray=function(t){return new Wi(t)},Wi.fromHex=Ns,Wi.fromRGBA=ks,Wi.fromHSLA=Ls,Wi.fromString=function(t){var e;return t.startsWith("#")?Ns(t):t.startsWith("rgb")?ks(t):(e=Wi.named[t])?Ns(e):Ls(t)},Wi.makeGrey=function(t,e){return Wi.fromArray([t,t,t,e])},Wi.rgba2hsla=function(t,e,n,r){var i=Array.isArray(t)?t[0]:t,s=Array.isArray(t)?t[1]:e,o=Array.isArray(t)?t[2]:n;e=Array.isArray(t)?t[3]:r,n=Math.max(i,s,o),t=Math.min(i,s,o),r=(n+t)/2;let a=0,l=0;if(t!==n){var h=n-t;switch(l=.5<r?h/(2-n-t):h/(n+t),n){case i:a=(s-o)/h+(s<o?6:0);break;case s:a=(o-i)/h+2;break;case o:a=(i-s)/h+4}a/=6}return[a,l,r,null==e?1:e]},Wi.hsla2rgba=Bs,Wi.random=Rs,Wi.randomHex=function(){let t="#";for(let e=0;e<6;e+=1)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t},Wi.randomRGBA=function(t){return Rs(t).toString()},Wi.invert=function(t,e){if("string"==typeof t){var n="#"===t[0];const[r,i,s]=Ds(t);return e?186<.299*r+.587*i+.114*s?"#000000":"#ffffff":(n?"#":"")+Is(255-r,255-i,255-s)}const r=t[0],i=t[1],s=t[2];return n=t[3],e?186<.299*r+.587*i+.114*s?[0,0,0,n]:[255,255,255,n]:[255-r,255-i,255-s,n]},Wi.lighten=Vs,Wi.darken=function(t,e){return Vs(t,-e)},(Ts=Ts||{}).named={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",burntsienna:"#ea7e5d",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};class zs{constructor(){this.clear()}clear(){this.map=new WeakMap,this.arr=[]}has(t){return this.map.has(t)}get(t){return this.map.get(t)}set(t,e){this.map.set(t,e),this.arr.push(t)}delete(t){var e=this.arr.indexOf(t);0<=e&&this.arr.splice(e,1),e=this.map.get(t);return this.map.delete(t),e}each(t){this.arr.forEach((e=>{var n=this.map.get(e);t(n,e)}))}dispose(){this.clear()}}function Fs(t){const e=[],n=[];return Array.isArray(t)?e.push(...t):t.split("|").forEach((t=>{-1===t.indexOf("&")?e.push(t):n.push(...t.split("&"))})),{or:e,and:n}}function $s(t){var e;t=+t;return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(e=t-1.5/2.75)*e+.75:t<2.5/2.75?7.5625*(e=t-2.25/2.75)*e+.9375:7.5625*(e=t-2.625/2.75)*e+.984375}function Gs(t){return 1-$s(1-t)}(we=Xi=Xi||{}).parse=Fs,we.equals=function(t,e){var n,r,i,s,o;return null!=t&&null!=e?(i=Fs(t),s=Fs(e),n=i.or.sort(),r=s.or.sort(),i=i.and.sort(),s=s.and.sort(),(o=(t,e)=>t.length===e.length&&(0===t.length||t.every(((t,n)=>t===e[n]))))(n,r)&&o(i,s)):null==t&&null==e},we.isMatch=function(t,e,n){if(null==e||Array.isArray(e)&&0===e.length)return!n||!0!==t.altKey&&!0!==t.ctrlKey&&!0!==t.metaKey&&!0!==t.shiftKey;var{or:n,and:e}=Fs(e);const r=e=>(e=e.toLowerCase()+"Key",!0===t[e]);return n.some((t=>r(t)))&&e.every((t=>r(t)))},(Pn=Yi=Yi||{}).linear=t=>t,Pn.quad=t=>t*t,Pn.cubic=t=>t*t*t,Pn.inout=t=>{var e,n;return t<=0?0:1<=t?1:(n=(e=t*t)*t,4*(t<.5?n:3*(t-e)+n-.75))},Pn.exponential=t=>Math.pow(2,10*(t-1)),Pn.bounce=t=>{for(let n=0,r=1;;n+=r,r/=2){var e;if(t>=(7-4*n)/11)return-(e=(11-6*n-11*t)/4)*e+r*r}},(Yi||(Yi={})).decorators={reverse(t){return e=>1-t(1-e)},reflect(t){return e=>.5*(e<.5?t(2*e):2-t(2-2*e))},clamp(t,e=0,n=1){return r=>(r=t(r),r<e?e:n<r?n:r)},back(t=1.70158){return e=>e*e*((t+1)*e-t)},elastic(t=1.5){return e=>Math.pow(2,10*(e-1))*Math.cos(20*Math.PI*t/3*e)}},(Cn=Yi=Yi||{}).easeInSine=function(t){return-1*Math.cos(t*(Math.PI/2))+1},Cn.easeOutSine=function(t){return Math.sin(t*(Math.PI/2))},Cn.easeInOutSine=function(t){return-.5*(Math.cos(Math.PI*t)-1)},Cn.easeInQuad=function(t){return t*t},Cn.easeOutQuad=function(t){return t*(2-t)},Cn.easeInOutQuad=function(t){return t<.5?2*t*t:(4-2*t)*t-1},Cn.easeInCubic=function(t){return t*t*t},Cn.easeOutCubic=function(t){return(t-=1)*t*t+1},Cn.easeInOutCubic=function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},Cn.easeInQuart=function(t){return t*t*t*t},Cn.easeOutQuart=function(t){return 1-(t-=1)*t*t*t},Cn.easeInOutQuart=function(t){var e=t-1;return t<.5?8*t*t*t*t:1-8*e*e*e*e},Cn.easeInQuint=function(t){return t*t*t*t*t},Cn.easeOutQuint=function(t){return 1+(t-=1)*t*t*t*t},Cn.easeInOutQuint=function(t){var e=t-1;return t<.5?16*t*t*t*t*t:1+16*e*e*e*e*e},Cn.easeInExpo=function(t){return 0===t?0:Math.pow(2,10*(t-1))},Cn.easeOutExpo=function(t){return 1===t?1:1-Math.pow(2,-10*t)},Cn.easeInOutExpo=function(t){var e;return 0===t||1===t?t:(e=(t*=2)-1,t<1?.5*Math.pow(2,10*e):.5*(2-Math.pow(2,-10*e)))},Cn.easeInCirc=function(t){return-1*(Math.sqrt(1-+t*t)-1)},Cn.easeOutCirc=function(t){return t-=1,Math.sqrt(1-t*t)},Cn.easeInOutCirc=function(t){var e=(t*=2)-2;return t<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-e*e)+1)},Cn.easeInBack=function(t,e=1.70158){return t*t*((e+1)*t-e)},Cn.easeOutBack=function(t,e=1.70158){return(t=+t-1)*t*((e+1)*t+e)+1},Cn.easeInOutBack=function(t,e=1.70158){var n=(t*=2)-2;e*=1.525;return t<1?.5*t*t*((1+e)*t-e):.5*(n*n*((1+e)*n+e)+2)},Cn.easeInElastic=function(t,e=.7){var n;return 0===t||1===t?t:(t=+t-1,n=(e=1-e)/(2*Math.PI)*Math.asin(1),-Math.pow(2,10*t)*Math.sin((t-n)*(2*Math.PI)/e))},Cn.easeOutElastic=function(t,e=.7){e=1-e;var n=2*t;return 0===t||1===t?t:(t=e/(2*Math.PI)*Math.asin(1),Math.pow(2,-10*n)*Math.sin((n-t)*(2*Math.PI)/e)+1)},Cn.easeInOutElastic=function(t,e=.65){var n,r;e=1-e;return 0===t||1===t?t:(n=(t*=2)-1,r=e/(2*Math.PI)*Math.asin(1),t<1?Math.pow(2,10*n)*Math.sin((n-r)*(2*Math.PI)/e)*-.5:Math.pow(2,-10*n)*Math.sin((n-r)*(2*Math.PI)/e)*.5+1)},Cn.easeOutBounce=$s,Cn.easeInBounce=Gs,Cn.easeInOutBounce=function(t){return t<.5?.5*Gs(2*t):.5*$s(2*t-1)+.5},(xe=_i=_i||{}).number=(t,e)=>{const n=e-t;return e=>t+n*e},xe.object=(t,e)=>{const n=Object.keys(t);return r=>{var i={};for(let o=n.length-1;-1!==o;--o){var s=n[o];i[s]=t[s]+(e[s]-t[s])*r}return i}},xe.unit=(t,e)=>{var n=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/;t=n.exec(t),n=n.exec(e),e=n?n[1]:"";const r=t?+t[1]:0;n=n?+n[1]:0;var i=e.indexOf(".");const s=0<i?e[1].length-i-1:0,o=n-r,a=t?t[2]:"";return t=>(r+o*t).toFixed(s)+a},xe.color=(t,e)=>{t=parseInt(t.slice(1),16),e=parseInt(e.slice(1),16);const n=255&t,r=(255&e)-n,i=65280&t,s=(65280&e)-i,o=16711680&t,a=(16711680&e)-o;return t=>"#"+(1<<24|n+r*t&255|i+s*t&65280|o+a*t&16711680).toString(16).slice(1)};const qs=[];function Hs(t,e){var n=qs.find((e=>e.name===t));n&&(n.loadTimes+=1,1<n.loadTimes)||Xe.isApplyingHMR()||((n=document.createElement("style")).setAttribute("type","text/css"),n.textContent=e,(e=document.querySelector("head"))&&e.insertBefore(n,e.firstChild),qs.push({name:t,loadTimes:1,styleElement:n}))}function Zs(t){var e=qs.findIndex((e=>e.name===t));if(-1<e){var n=qs[e];if(--n.loadTimes,!(0<n.loadTimes)){let t=n.styleElement;t&&t.parentNode&&t.parentNode.removeChild(t),t=null,qs.splice(e,1)}}}(be=Ki=Ki||{}).toDeg=function(t){return 180*t/Math.PI%360},be.toRad=function(t,e=!1){return(e?t:t%360)*Math.PI/180},be.normalize=function(t){return t%360+(t<0?360:0)},(pe=Qi=Qi||{}).round=function(t,e=0){return Number.isInteger(t)?t:+t.toFixed(e)},pe.random=function(t,e){let n,r;return n=null==e?(r=null==t?1:t,0):(r=e,null==t?0:t),r<n&&(e=n,n=r,r=e),Math.floor(Math.random()*(r-n+1)+n)},pe.clamp=function(t,e,n){return Number.isNaN(t)?NaN:Number.isNaN(e)||Number.isNaN(n)?0:e<n?t<e?e:n<t?n:t:t<n?n:e<t?e:t},pe.snapToGrid=function(t,e){return e*Math.round(t/e)},pe.containsPoint=function(t,e){return null!=e&&null!=t&&e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height},pe.squaredLength=function(t,e){var n=t.x-e.x;t=t.y-e.y;return n*n+t*t};class Us{valueOf(){return this.toJSON()}toString(){return JSON.stringify(this.toJSON())}}class Js extends Us{constructor(t,e){super(),this.x=null==t?0:t,this.y=null==e?0:e}round(t=0){return this.x=Qi.round(this.x,t),this.y=Qi.round(this.y,t),this}add(t,e){return t=Js.create(t,e),this.x+=t.x,this.y+=t.y,this}update(t,e){return t=Js.create(t,e),this.x=t.x,this.y=t.y,this}translate(t,e){return t=Js.create(t,e),this.x+=t.x,this.y+=t.y,this}rotate(t,e){return t=Js.rotate(this,t,e),this.x=t.x,this.y=t.y,this}scale(t,e,n=new Js){return n=Js.create(n),this.x=n.x+t*(this.x-n.x),this.y=n.y+e*(this.y-n.y),this}closest(t){if(1===t.length)return Js.create(t[0]);let e=null,n=1/0;return t.forEach((t=>{var r=this.squaredDistance(t);r<n&&(e=t,n=r)})),e?Js.create(e):null}distance(t){return Math.sqrt(this.squaredDistance(t))}squaredDistance(t){t=Js.create(t);var e=this.x-t.x;t=this.y-t.y;return e*e+t*t}manhattanDistance(t){return t=Js.create(t),Math.abs(t.x-this.x)+Math.abs(t.y-this.y)}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)||.01}theta(t=new Js){t=Js.create(t);var e=-(t.y-this.y);t=t.x-this.x;let n=Math.atan2(e,t);return 180*(n=n<0?2*Math.PI+n:n)/Math.PI}angleBetween(t,e){if(this.equals(t)||this.equals(e))return NaN;let n=this.theta(e)-this.theta(t);return n<0&&(n+=360),n}vectorAngle(t){return new Js(0,0).angleBetween(this,t)}toPolar(t){return this.update(Js.toPolar(this,t)),this}changeInAngle(t,e,n=new Js){return this.clone().translate(-t,-e).theta(n)-this.theta(n)}adhereToRect(t){return Qi.containsPoint(t,this)||(this.x=Math.min(Math.max(this.x,t.x),t.x+t.width),this.y=Math.min(Math.max(this.y,t.y),t.y+t.height)),this}bearing(t){t=Js.create(t);var e=Ki.toRad(this.y),n=Ki.toRad(t.y),r=this.x;t=t.x,t=Ki.toRad(t-r),r=Math.sin(t)*Math.cos(n),e=Math.cos(e)*Math.sin(n)-Math.sin(e)*Math.cos(n)*Math.cos(t);let i=Ki.toDeg(Math.atan2(r,e))-22.5;return i<0&&(i+=360),["NE","E","SE","S","SW","W","NW","N"][i=parseInt(i/45,10)]}cross(t,e){return null!=t&&null!=e?(t=Js.create(t),((e=Js.create(e)).x-this.x)*(t.y-this.y)-(e.y-this.y)*(t.x-this.x)):NaN}dot(t){return t=Js.create(t),this.x*t.x+this.y*t.y}diff(t,e){return"number"==typeof t?new Js(this.x-t,this.y-e):(e=Js.create(t),new Js(this.x-e.x,this.y-e.y))}lerp(t,e){return t=Js.create(t),new Js((1-e)*this.x+e*t.x,(1-e)*this.y+e*t.y)}normalize(t=1){return t/=this.magnitude(),this.scale(t,t)}move(t,e){return t=Js.create(t),t=Ki.toRad(t.theta(this)),this.translate(Math.cos(t)*e,-Math.sin(t)*e)}reflection(t){return Js.create(t).move(this,this.distance(t))}snapToGrid(t,e){return this.x=Qi.snapToGrid(this.x,t),this.y=Qi.snapToGrid(this.y,null==e?t:e),this}equals(t){return t=Js.create(t),null!=t&&t.x===this.x&&t.y===this.y}clone(){return Js.clone(this)}toJSON(){return Js.toJSON(this)}serialize(){return this.x+" "+this.y}}function Ws(t){return!es.isPoint(t)&&Array.isArray(t)?new es(t[0],t[1]):new es(t.x,t.y)}function Xs(t,e){return t===e||null!=t&&null!=e&&t.x===e.x&&t.y===e.y}function Ys(t,e,n,r=new es){t=Ws(t),r=Ws(r);var i=t.x-r.x;t=t.y-r.y;return new es(i*e-t*n+r.x,t*e+i*n+r.y)}(ts=Js=Js||{}).isPoint=function(t){return null!=t&&t instanceof ts},(me=Js=Js||{}).isPointLike=function(t){return null!=t&&"object"==typeof t&&"number"==typeof t.x&&"number"==typeof t.y},me.isPointData=function(t){return null!=t&&Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]},(es=Js=Js||{}).create=function(t,e){return null==t||"number"==typeof t?new es(t,e):Ws(t)},es.clone=Ws,es.toJSON=function(t){return!es.isPoint(t)&&Array.isArray(t)?{x:t[0],y:t[1]}:{x:t.x,y:t.y}},es.fromPolar=function(t,e,n=new es){let r=Math.abs(t*Math.cos(e)),i=Math.abs(t*Math.sin(e));return t=Ws(n),(n=Ki.normalize(Ki.toDeg(e)))<90?i=-i:n<180?(r=-r,i=-i):n<270&&(r=-r),new es(t.x+r,t.y+i)},es.toPolar=function(t,e=new es){t=Ws(t),e=Ws(e);var n=t.x-e.x,r=t.y-e.y;return new es(Math.sqrt(n*n+r*r),Ki.toRad(e.theta(t)))},es.equals=Xs,es.equalPoints=function(t,e){if(null==t&&null!=e||null!=t&&null==e||null!=t&&null!=e&&t.length!==e.length)return!1;if(null!=t&&null!=e)for(let n=0,r=t.length;n<r;n+=1)if(!Xs(t[n],e[n]))return!1;return!0},es.random=function(t,e,n,r){return new es(Qi.random(t,e),Qi.random(n,r))},es.rotate=function(t,e,n){e=Ki.toRad(Ki.normalize(-e));var r=Math.sin(e);return Ys(t,Math.cos(e),r,n)},es.rotateEx=Ys;class _s extends Us{get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get origin(){return new Js(this.x,this.y)}get topLeft(){return new Js(this.x,this.y)}get topCenter(){return new Js(this.x+this.width/2,this.y)}get topRight(){return new Js(this.x+this.width,this.y)}get center(){return new Js(this.x+this.width/2,this.y+this.height/2)}get bottomLeft(){return new Js(this.x,this.y+this.height)}get bottomCenter(){return new Js(this.x+this.width/2,this.y+this.height)}get bottomRight(){return new Js(this.x+this.width,this.y+this.height)}get corner(){return new Js(this.x+this.width,this.y+this.height)}get rightMiddle(){return new Js(this.x+this.width,this.y+this.height/2)}get leftMiddle(){return new Js(this.x,this.y+this.height/2)}get topLine(){return new Qs(this.topLeft,this.topRight)}get rightLine(){return new Qs(this.topRight,this.bottomRight)}get bottomLine(){return new Qs(this.bottomLeft,this.bottomRight)}get leftLine(){return new Qs(this.topLeft,this.bottomLeft)}constructor(t,e,n,r){super(),this.x=null==t?0:t,this.y=null==e?0:e,this.width=null==n?0:n,this.height=null==r?0:r}getOrigin(){return this.origin}getTopLeft(){return this.topLeft}getTopCenter(){return this.topCenter}getTopRight(){return this.topRight}getCenter(){return this.center}getCenterX(){return this.x+this.width/2}getCenterY(){return this.y+this.height/2}getBottomLeft(){return this.bottomLeft}getBottomCenter(){return this.bottomCenter}getBottomRight(){return this.bottomRight}getCorner(){return this.corner}getRightMiddle(){return this.rightMiddle}getLeftMiddle(){return this.leftMiddle}getTopLine(){return this.topLine}getRightLine(){return this.rightLine}getBottomLine(){return this.bottomLine}getLeftLine(){return this.leftLine}bbox(t){var e,n;return t?(t=Ki.toRad(t),n=Math.abs(Math.sin(t)),t=Math.abs(Math.cos(t)),e=this.width*t+this.height*n,n=this.width*n+this.height*t,new _s(this.x+(this.width-e)/2,this.y+(this.height-n)/2,e,n)):this.clone()}round(t=0){return this.x=Qi.round(this.x,t),this.y=Qi.round(this.y,t),this.width=Qi.round(this.width,t),this.height=Qi.round(this.height,t),this}add(t,e,n,r){return t=_s.create(t,e,n,r),e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),r=Math.max(this.x+this.width,t.x+t.width),t=Math.max(this.y+this.height,t.y+t.height),this.x=e,this.y=n,this.width=r-e,this.height=t-n,this}update(t,e,n,r){return t=_s.create(t,e,n,r),this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}inflate(t,e){var n=t;e=null!=e?e:t;return this.x-=n,this.y-=e,this.width+=2*n,this.height+=2*e,this}snapToGrid(t,e){var n=this.origin.snapToGrid(t,e);t=this.corner.snapToGrid(t,e);return this.x=n.x,this.y=n.y,this.width=t.x-n.x,this.height=t.y-n.y,this}translate(t,e){return t=Js.create(t,e),this.x+=t.x,this.y+=t.y,this}scale(t,e,n=new Js){return n=this.origin.scale(t,e,n),this.x=n.x,this.y=n.y,this.width*=t,this.height*=e,this}rotate(t,e=this.getCenter()){var n,r,i,s,o;return 0!==t&&(t=Ki.toRad(t),o=Math.cos(t),t=Math.sin(t),n=this.getOrigin(),r=this.getTopRight(),i=this.getBottomRight(),s=this.getBottomLeft(),n=Js.rotateEx(n,o,t,e),r=Js.rotateEx(r,o,t,e),i=Js.rotateEx(i,o,t,e),s=Js.rotateEx(s,o,t,e),(o=new _s(n.x,n.y,0,0)).add(r.x,r.y,0,0),o.add(i.x,i.y,0,0),o.add(s.x,s.y,0,0),this.update(o)),this}rotate90(){var t=(this.width-this.height)/2;this.x+=t,this.y-=t,t=this.width;return this.width=this.height,this.height=t,this}moveAndExpand(t){return t=_s.clone(t),this.x+=t.x||0,this.y+=t.y||0,this.width+=t.width||0,this.height+=t.height||0,this}getMaxScaleToFit(t,e=this.center){t=_s.clone(t);var n=e.x;e=e.y;let r=1/0,i=1/0,s=1/0,o=1/0,a=1/0,l=1/0,h=1/0,u=1/0;var c=t.topLeft;c.x<n&&(r=(this.x-n)/(c.x-n)),c.y<e&&(a=(this.y-e)/(c.y-e)),c=t.bottomRight,c.x>n&&(i=(this.x+this.width-n)/(c.x-n)),c.y>e&&(l=(this.y+this.height-e)/(c.y-e)),c=t.topRight,c.x>n&&(s=(this.x+this.width-n)/(c.x-n)),c.y<e&&(h=(this.y-e)/(c.y-e)),c=t.bottomLeft;return c.x<n&&(o=(this.x-n)/(c.x-n)),c.y>e&&(u=(this.y+this.height-e)/(c.y-e)),{sx:Math.min(r,i,s,o),sy:Math.min(a,l,h,u)}}getMaxUniformScaleToFit(t,e=this.center){return t=this.getMaxScaleToFit(t,e),Math.min(t.sx,t.sy)}containsPoint(t,e){return Qi.containsPoint(this,Js.create(t,e))}containsRect(t,e,n,r){t=_s.create(t,e,n,r),e=this.x,n=this.y,r=this.width;var i=this.height,s=t.x,o=t.y,a=t.width;t=t.height;return 0!==r&&0!==i&&0!==a&&0!==t&&e<=s&&n<=o&&s+a<=e+r&&o+t<=n+i}intersectsWithLine(t){var e=[this.topLine,this.rightLine,this.bottomLine,this.leftLine];const n=[],r=[];return e.forEach((e=>{e=t.intersectsWithLine(e),null!==e&&r.indexOf(e.toString())<0&&(n.push(e),r.push(e.toString()))})),0<n.length?n:null}intersectsWithLineFromCenterToPoint(t,e){t=Js.clone(t);var n=this.center;let r=null;null!=e&&0!==e&&t.rotate(e,n);var i=[this.topLine,this.rightLine,this.bottomLine,this.leftLine],s=new Qs(n,t);for(let a=i.length-1;0<=a;--a){var o=i[a].intersectsWithLine(s);if(null!==o){r=o;break}}return r&&null!=e&&0!==e&&r.rotate(-e,n),r}intersectsWithRect(t,e,n,r){var i;t=_s.create(t,e,n,r);return this.isIntersectWithRect(t)?(e=this.origin,n=this.corner,r=t.origin,t=t.corner,i=Math.max(e.x,r.x),e=Math.max(e.y,r.y),new _s(i,e,Math.min(n.x,t.x)-i,Math.min(n.y,t.y)-e)):null}isIntersectWithRect(t,e,n,r){return t=_s.create(t,e,n,r),e=this.origin,n=this.corner,r=t.origin,t=t.corner,!(t.x<=e.x||t.y<=e.y||r.x>=n.x||r.y>=n.y)}normalize(){let t=this.x,e=this.y,n=this.width,r=this.height;return this.width<0&&(t=this.x+this.width,n=-this.width),this.height<0&&(e=this.y+this.height,r=-this.height),this.x=t,this.y=e,this.width=n,this.height=r,this}union(t){t=_s.clone(t);var e=this.origin,n=this.corner,r=t.origin,i=(t=t.corner,Math.min(e.x,r.x));e=Math.min(e.y,r.y),r=Math.max(n.x,t.x),n=Math.max(n.y,t.y);return new _s(i,e,r-i,n-e)}getNearestSideToPoint(t){t=Js.clone(t);var e=t.x-this.x,n=this.x+this.width-t.x,r=t.y-this.y;t=this.y+this.height-t.y;let i=e,s="left";return n<i&&(i=n,s="right"),r<i&&(i=r,s="top"),t<i?"bottom":s}getNearestPointToPoint(t){if(t=Js.clone(t),this.containsPoint(t)){var e=this.getNearestSideToPoint(t);if("left"===e)return new Js(this.x,t.y);if("top"===e)return new Js(t.x,this.y);if("right"===e)return new Js(this.x+this.width,t.y);if("bottom"===e)return new Js(t.x,this.y+this.height)}return t.adhereToRect(this)}equals(t){return null!=t&&t.x===this.x&&t.y===this.y&&t.width===this.width&&t.height===this.height}clone(){return new _s(this.x,this.y,this.width,this.height)}toJSON(){return{x:this.x,y:this.y,width:this.width,height:this.height}}serialize(){return`${this.x} ${this.y} ${this.width} `+this.height}}function Ks(t){return rs.isRectangle(t)?t.clone():Array.isArray(t)?new rs(t[0],t[1],t[2],t[3]):new rs(t.x,t.y,t.width,t.height)}(ns=_s=_s||{}).isRectangle=function(t){return null!=t&&t instanceof ns},(_s||(_s={})).isRectangleLike=function(t){return null!=t&&"object"==typeof t&&"number"==typeof t.x&&"number"==typeof t.y&&"number"==typeof t.width&&"number"==typeof t.height},(rs=_s=_s||{}).create=function(t,e,n,r){return null==t||"number"==typeof t?new rs(t,e,n,r):Ks(t)},rs.clone=Ks,rs.fromEllipse=function(t){return new rs(t.x-t.a,t.y-t.b,2*t.a,2*t.b)},rs.fromSize=function(t){return new rs(0,0,t.width,t.height)},rs.fromPositionAndSize=function(t,e){return new rs(t.x,t.y,e.width,e.height)};class Qs extends Us{get center(){return new Js((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)}constructor(t,e,n,r){super(),"number"==typeof t&&"number"==typeof e?(this.start=new Js(t,e),this.end=new Js(n,r)):(this.start=Js.create(t),this.end=Js.create(e))}getCenter(){return this.center}round(t=0){return this.start.round(t),this.end.round(t),this}translate(t,e){return"number"==typeof t?(this.start.translate(t,e),this.end.translate(t,e)):(this.start.translate(t),this.end.translate(t)),this}rotate(t,e){return this.start.rotate(t,e),this.end.rotate(t,e),this}scale(t,e,n){return this.start.scale(t,e,n),this.end.scale(t,e,n),this}length(){return Math.sqrt(this.squaredLength())}squaredLength(){var t=this.start.x-this.end.x,e=this.start.y-this.end.y;return t*t+e*e}setLength(t){var e=this.length();return e?this.scale(t/=e,t,this.start):this}parallel(t){var e,n,r,i,s=this.clone();return s.isDifferentiable()&&(({start:e,end:n}=s),r=e.clone().rotate(270,n),i=n.clone().rotate(90,e),e.move(i,t),n.move(r,t)),s}vector(){return new Js(this.end.x-this.start.x,this.end.y-this.start.y)}angle(){var t=new Js(this.start.x+1,this.start.y);return this.start.angleBetween(this.end,t)}bbox(){var t=Math.min(this.start.x,this.end.x),e=Math.min(this.start.y,this.end.y),n=Math.max(this.start.x,this.end.x),r=Math.max(this.start.y,this.end.y);return new _s(t,e,n-t,r-e)}bearing(){return this.start.bearing(this.end)}closestPoint(t){return this.pointAt(this.closestPointNormalizedLength(t))}closestPointLength(t){return this.closestPointNormalizedLength(t)*this.length()}closestPointTangent(t){return this.tangentAt(this.closestPointNormalizedLength(t))}closestPointNormalizedLength(t){return t=this.vector().dot(new Qs(this.start,t).vector()),t=Math.min(1,Math.max(0,t/this.squaredLength())),Number.isNaN(t)?0:t}pointAt(t){var e=this.start,n=this.end;return t<=0?e.clone():1<=t?n.clone():e.lerp(n,t)}pointAtLength(t){var e=this.start,n=this.end;let r=!0;t<0&&(r=!1,t=-t);var i=this.length();return i<=t?(r?n:e).clone():(n=(r?t:i-t)/i,this.pointAt(n))}divideAt(t){return t=this.pointAt(t),[new Qs(this.start,t),new Qs(t,this.end)]}divideAtLength(t){return t=this.pointAtLength(t),[new Qs(this.start,t),new Qs(t,this.end)]}containsPoint(t){var e,n=this.start,r=this.end;return 0===n.cross(t,r)&&(e=this.length(),!(new Qs(n,t).length()>e||new Qs(t,r).length()>e))}intersect(t,e){return t=t.intersectsWithLine(this,e),t?Array.isArray(t)?t:[t]:null}intersectsWithLine(t){var e=new Js(this.end.x-this.start.x,this.end.y-this.start.y),n=new Js(t.end.x-t.start.x,t.end.y-t.start.y),r=e.x*n.y-e.y*n.x;t=new Js(t.start.x-this.start.x,t.start.y-this.start.y),n=t.x*n.y-t.y*n.x,t=t.x*e.y-t.y*e.x;if(0==r||n*r<0||t*r<0)return null;if(0<r){if(r<n||r<t)return null}else if(n<r||t<r)return null;return new Js(this.start.x+n*e.x/r,this.start.y+n*e.y/r)}isDifferentiable(){return!this.start.equals(this.end)}pointOffset(t){t=Js.clone(t);var e=this.start,n=this.end;return((n.x-e.x)*(t.y-e.y)-(n.y-e.y)*(t.x-e.x))/this.length()}pointSquaredDistance(t,e){return t=Js.create(t,e),this.closestPoint(t).squaredDistance(t)}pointDistance(t,e){return t=Js.create(t,e),this.closestPoint(t).distance(t)}tangentAt(t){var e,n;return this.isDifferentiable()?(e=this.start,n=this.end,t=this.pointAt(t),(n=new Qs(e,n)).translate(t.x-e.x,t.y-e.y),n):null}tangentAtLength(t){var e,n;return this.isDifferentiable()?(e=this.start,n=this.end,t=this.pointAtLength(t),(n=new Qs(e,n)).translate(t.x-e.x,t.y-e.y),n):null}relativeCcw(t,e){t=Js.create(t,e),e=t.x-this.start.x,t=t.y-this.start.y;var n=this.end.x-this.start.x,r=this.end.y-this.start.y;let i=e*r-t*n;return(i=0===i&&0<(i=e*n+t*r)&&(e-=n,t-=r,(i=e*n+t*r)<0)?0:i)<0?-1:0<i?1:0}equals(t){return null!=t&&this.start.x===t.start.x&&this.start.y===t.start.y&&this.end.x===t.end.x&&this.end.y===t.end.y}clone(){return new Qs(this.start,this.end)}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){return[this.start.serialize(),this.end.serialize()].join(" ")}}(is=Qs=Qs||{}).isLine=function(t){return null!=t&&t instanceof is};class to extends Us{get center(){return new Js(this.x,this.y)}constructor(t,e,n,r){super(),this.x=null==t?0:t,this.y=null==e?0:e,this.a=null==n?0:n,this.b=null==r?0:r}bbox(){return _s.fromEllipse(this)}getCenter(){return this.center}inflate(t,e){return e=null!=e?e:t,this.a+=2*t,this.b+=2*e,this}normalizedDistance(t,e){t=Js.create(t,e),e=t.x-this.x,t=t.y-this.y;var n=this.a,r=this.b;return e*e/(n*n)+t*t/(r*r)}containsPoint(t,e){return this.normalizedDistance(t,e)<=1}intersectsWithLine(t){var e=[],n=this.a,r=this.b,i=t.start,s=t.end,o=(t=t.vector(),i.diff(new Js(this.x,this.y))),a=new Js(t.x/(n*n),t.y/(r*r));n=new Js(o.x/(n*n),o.y/(r*r)),r=t.dot(a),a=t.dot(n),t=a*a-r*(o.dot(n)-1);if(t<0)return null;if(0<t){if(o=Math.sqrt(t),n=(-a-o)/r,t=(-a+o)/r,(n<0||1<n)&&(t<0||1<t))return null;0<=n&&n<=1&&e.push(i.lerp(s,n)),0<=t&&t<=1&&e.push(i.lerp(s,t))}else{if(o=-a/r,!(0<=o&&o<=1))return null;e.push(i.lerp(s,o))}return e}intersectsWithLineFromCenterToPoint(t,e=0){t=Js.clone(t);var n,r=(e&&t.rotate(e,this.getCenter()),t.x-this.x),i=t.y-this.y;let s;return s=0==r?this.bbox().getNearestPointToPoint(t):(t=i/r,i=this.a*this.a,n=this.b*this.b,i=Math.sqrt(1/(1/i+t*t/n)),n=t*(i=r<0?-i:i),new Js(this.x+i,this.y+n)),e?s.rotate(-e,this.getCenter()):s}tangentTheta(t){t=Js.clone(t);var e=t.x,n=t.y,r=this.a,i=this.b,s=this.bbox().center,o=s.x,a=s.y,l=e>s.x+r/2,h=e<s.x-r/2;let u,c;return l||h?(c=e>s.x?n-30:n+30,u=r*r/(e-o)-r*r*(n-a)*(c-a)/(i*i*(e-o))+o):(u=n>s.y?e+30:e-30,c=i*i/(n-a)-i*i*(e-o)*(u-o)/(r*r*(n-a))+a),new Js(u,c).theta(t)}scale(t,e){return this.a*=t,this.b*=e,this}rotate(t,e){var n=_s.fromEllipse(this);n.rotate(t,e),t=to.fromRect(n);return this.a=t.a,this.b=t.b,this.x=t.x,this.y=t.y,this}translate(t,e){return t=Js.create(t,e),this.x+=t.x,this.y+=t.y,this}equals(t){return null!=t&&t.x===this.x&&t.y===this.y&&t.a===this.a&&t.b===this.b}clone(){return new to(this.x,this.y,this.a,this.b)}toJSON(){return{x:this.x,y:this.y,a:this.a,b:this.b}}serialize(){return`${this.x} ${this.y} ${this.a} `+this.b}}function eo(t){return os.isEllipse(t)?t.clone():Array.isArray(t)?new os(t[0],t[1],t[2],t[3]):new os(t.x,t.y,t.a,t.b)}(ss=to=to||{}).isEllipse=function(t){return null!=t&&t instanceof ss},(os=to=to||{}).create=function(t,e,n,r){return null==t||"number"==typeof t?new os(t,e,n,r):eo(t)},os.parse=eo,os.fromRect=function(t){var e=t.center;return new os(e.x,e.y,t.width/2,t.height/2)};const no=new RegExp("^[\\s\\dLMCZz,.]*$");function ro(t){return"string"==typeof t&&no.test(t)}function io(t,e){return(t%e+e)%e}function so(t,e={}){const n=[];t&&t.length&&t.forEach((t=>{Array.isArray(t)?n.push({x:t[0],y:t[1]}):n.push({x:t.x,y:t.y})}));{var r=n,i=(t=e.round,null==e.initialMove||e.initialMove),s=e.close,o=e.exclude,a=[],l=(e=r[r.length-1],null!=t&&0<t),h=t||0;s&&l&&(t=(r=r.slice())[0],t=new Js(e.x+(t.x-e.x)/2,e.y+(t.y-e.y)/2),r.splice(0,0,t));let f=r[0],m=1;for(a.push(i?"M":"L",f.x,f.y);m<(s?r.length:r.length-1);){let t=r[io(m,r.length)];var u=f.x-t.x,c=f.y-t.y;if(l&&(0!=u||0!=c)&&(null==o||o.indexOf(m-1)<0)){var g=Math.sqrt(u*u+c*c),d=u*Math.min(h,g/2)/g,p=c*Math.min(h,g/2)/g;d=t.x+d,p=t.y+p;a.push("L",d,p);let e=r[io(m+1,r.length)];for(;m<r.length-2&&0===Math.round(e.x-t.x)&&0===Math.round(e.y-t.y);)e=r[io(m+2,r.length)],m+=1;u=e.x-t.x,c=e.y-t.y,g=Math.max(1,Math.sqrt(u*u+c*c)),d=u*Math.min(h,g/2)/g,p=c*Math.min(h,g/2)/g,u=t.x+d,c=t.y+p,a.push("Q",t.x,t.y,u,c),t=new Js(u,c)}else a.push("L",t.x,t.y);f=t,m+=1}return s?a.push("Z"):a.push("L",e.x,e.y),a.map((t=>"string"==typeof t?t:+t.toFixed(3))).join(" ")}}function oo(t,e,n,r,i=0,s=0,o=0,a,l){if(0===n||0===r)return[];a-=t,l-=e,n=Math.abs(n),r=Math.abs(r);var h=-a/2,u=-l/2,c=Math.cos(i*Math.PI/180),g=(i=Math.sin(i*Math.PI/180),c*h+i*u),d=(h=-1*i*h+c*u,u=g*g,h*h),p=n*n,f=r*r,m=u/p+d/f;let v;if(1<m)n=Math.sqrt(m)*n,r=Math.sqrt(m)*r,v=0;else{let t=s===o?-1:1;v=t*Math.sqrt((p*f-p*d-f*u)/(p*d+f*u))}m=v*n*h/r,s=-1*v*r*g/n;var y=c*m-i*s+a/2,b=i*m+c*s+l/2;p=Math.atan2((h-s)/r,(g-m)/n)-Math.atan2(0,1);let x=0<=p?p:2*Math.PI+p,w=0<=(p=Math.atan2((-h-s)/r,(-g-m)/n)-Math.atan2((h-s)/r,(g-m)/n))?p:2*Math.PI+p;0===o&&0<w?w-=2*Math.PI:0!==o&&w<0&&(w+=2*Math.PI);d=2*w/Math.PI;var C=Math.ceil(d<0?-1*d:d),P=w/C,A=8/3*Math.sin(P/4)*Math.sin(P/4)/Math.sin(P/2),E=c*n,M=c*r,S=i*n,O=i*r,T=Math.cos(x);let N=-A*(E*(L=Math.sin(x))+O*T),k=-A*(S*L-M*T);var j=[];for(let z=0;z<C;z+=1){x+=P;var L,B=E*(T=Math.cos(x))-O*(L=Math.sin(x))+y,R=S*T+M*L+b,D=-A*(E*L+O*T),I=-A*(S*L-M*T),V=6*z;j[V]=Number(N+t),j[1+V]=Number(k+e),j[2+V]=Number(B-D+t),j[3+V]=Number(R-I+e),j[4+V]=Number(B+t),j[5+V]=Number(R+e),N=B+D,k=R+I}return j.map((t=>+t.toFixed(2)))}function ao(t,e,n,r,i=0,s=0,o=0,a,l){var h=[],u=oo(t,e,n,r,i,s,o,a,l);if(null!=u)for(let c=0,g=u.length;c<g;c+=6)h.push("C",u[c],u[c+1],u[c+2],u[c+3],u[c+4],u[c+5]);return h.join(" ")}class lo extends Us{get start(){return this.points[0]||null}get end(){return this.points[this.points.length-1]||null}constructor(t){if(super(),null!=t){if("string"==typeof t)return lo.parse(t);this.points=t.map((t=>Js.create(t)))}else this.points=[]}scale(t,e,n=new Js){return this.points.forEach((r=>r.scale(t,e,n))),this}rotate(t,e){return this.points.forEach((n=>n.rotate(t,e))),this}translate(t,e){const n=Js.create(t,e);return this.points.forEach((t=>t.translate(n.x,n.y))),this}round(t=0){return this.points.forEach((e=>e.round(t))),this}bbox(){if(0===this.points.length)return new _s;let t=1/0,e=-1/0,n=1/0,r=-1/0;var i=this.points;for(let a=0,l=i.length;a<l;a+=1){var s=i[a],o=s.x;s=s.y;o<t&&(t=o),o>e&&(e=o),s<n&&(n=s),s>r&&(r=s)}return new _s(t,n,e-t,r-n)}closestPoint(t){return t=this.closestPointLength(t),this.pointAtLength(t)}closestPointLength(t){var e=this.points,n=e.length;if(0===n||1===n)return 0;let r=0,i=0,s=1/0;for(let h=0,u=n-1;h<u;h+=1){var o=new Qs(e[h],e[h+1]),a=o.length(),l=o.closestPointNormalizedLength(t);o=o.pointAt(l).squaredDistance(t);o<s&&(s=o,i=r+l*a),r+=a}return i}closestPointNormalizedLength(t){var e=this.length();return 0===e?0:this.closestPointLength(t)/e}closestPointTangent(t){return t=this.closestPointLength(t),this.tangentAtLength(t)}containsPoint(t){if(0===this.points.length)return!1;var e=Js.clone(t),n=e.x,r=e.y,i=this.points,s=i.length;let o=s-1,a=0;for(let c=0;c<s;c+=1){var l=i[o],h=i[c];if(e.equals(l))return!0;var u=new Qs(l,h);if(u.containsPoint(t))return!0;(r<=l.y&&r>h.y||r>l.y&&r<=h.y)&&0<=(l=l.x-n>h.x-n?l.x-n:h.x-n)&&(h=new Js(n+l,r),l=new Qs(t,h),u.intersectsWithLine(l))&&(a+=1),o=c}return a%2==1}intersectsWithLine(t){var e=[];for(let i=0,s=this.points.length-1;i<s;i+=1){var n=this.points[i],r=this.points[i+1];n=t.intersectsWithLine(new Qs(n,r));n&&e.push(n)}return 0<e.length?e:null}isDifferentiable(){for(let n=0,r=this.points.length-1;n<r;n+=1){var t=this.points[n],e=this.points[n+1];if(new Qs(t,e).isDifferentiable())return!0}return!1}length(){let t=0;for(let r=0,i=this.points.length-1;r<i;r+=1){var e=this.points[r],n=this.points[r+1];t+=e.distance(n)}return t}pointAt(t){var e=this.points,n=e.length;return 0===n?null:1===n||t<=0?e[0].clone():1<=t?e[n-1].clone():(e=this.length(),this.pointAtLength(e*t))}pointAtLength(t){var e=this.points,n=e.length;if(0===n)return null;if(1===n)return e[0].clone();let r=!0,i=(t<0&&(r=!1,t=-t),0);for(let l=0,h=n-1;l<h;l+=1){var s=r?l:h-1-l,o=e[s],a=(s=e[s+1],new Qs(o,s));o=o.distance(s);if(t<=i+o)return a.pointAtLength((r?1:-1)*(t-i));i+=o}return(r?e[n-1]:e[0]).clone()}tangentAt(t){var e=this.points.length;return 0===e||1===e?null:(1<(t=t<0?0:t)&&(t=1),e=this.length(),this.tangentAtLength(e*t))}tangentAtLength(t){var e=this.points,n=e.length;if(0===n||1===n)return null;let r=!0;t<0&&(r=!1,t=-t);let i,s=0;for(let h=0,u=n-1;h<u;h+=1){var o=r?h:u-1-h,a=e[o],l=(o=e[o+1],new Qs(a,o));a=a.distance(o);if(l.isDifferentiable()){if(t<=s+a)return l.tangentAtLength((r?1:-1)*(t-s));i=l}s+=a}return i?(n=r?1:0,i.tangentAt(n)):null}simplify(t={}){var e=this.points;if(!(e.length<3)){var n=t.threshold||0;let a=0;for(;e[a+2];){var r=a,i=a+1,s=a+2,o=(r=e[r],e[i]);s=e[s];new Qs(r,s).closestPoint(o).distance(o)<=n?e.splice(i,1):a+=1}}return this}toHull(){var t=this.points,e=t.length;if(0===e)return new lo;let n=t[0];for(let w=1;w<e;w+=1)(t[w].y<n.y||t[w].y===n.y&&t[w].x>n.x)&&(n=t[w]);var r=[];for(let w=0;w<e;w+=1){let e=n.theta(t[w]);0===e&&(e=360),r.push([t[w],w,e])}if(r.sort(((t,e)=>{let n=t[2]-e[2];return 0===n?e[1]-t[1]:n})),2<r.length){const t=r[r.length-1];r.unshift(t)}for(var i,s,o={},a=[],l=t=>t[0].toString()+"@"+t[1];0!==r.length;){var h,u,c,g,d,p=r.pop(),f=p[0];if(!o[l(p)]){let t=!1;for(;!t;)a.length<2?(a.push(p),t=!0):(u=(h=a.pop())[0],(d=(g=(c=a.pop())[0]).cross(u,f))<0?(a.push(c),a.push(h),a.push(p),t=!0):0!==d||(d=u.angleBetween(g,f),Math.abs(d-180)<1e-10)||u.equals(f)||g.equals(u)?(o[l(h)]=u,a.push(c)):Math.abs((d+1)%360-1)<1e-10&&(a.push(c),r.push(h)))}}2<a.length&&a.pop();let m,v=-1;for(let w=0,C=a.length;w<C;w+=1){var y=a[w][1];(void 0===m||y<m)&&(m=y,v=w)}let b=[];var x=[];for(let w=0,C=(b=0<v?(i=a.slice(v),s=a.slice(0,v),i.concat(s)):a).length;w<C;w+=1)x.push(b[w][0]);return new lo(x)}equals(t){return null!=t&&t.points.length===this.points.length&&t.points.every(((t,e)=>t.equals(this.points[e])))}clone(){return new lo(this.points.map((t=>t.clone())))}toJSON(){return this.points.map((t=>t.toJSON()))}serialize(){return this.points.map((t=>""+t.serialize())).join(" ")}}(as=lo=lo||{}).isPolyline=function(t){return null!=t&&t instanceof as},(ls=lo=lo||{}).parse=function(t){if(""===(t=t.trim()))return new ls;var e=[],n=t.split(/\s*,\s*|\s+/);for(let r=0,i=n.length;r<i;r+=2)e.push({x:+n[r],y:+n[r+1]});return new ls(e)};class ho extends Us{constructor(t,e,n,r){super(),this.PRECISION=3,this.start=Js.create(t),this.controlPoint1=Js.create(e),this.controlPoint2=Js.create(n),this.end=Js.create(r)}bbox(){var t,e,n,r,i=this.start,s=this.controlPoint1,o=this.controlPoint2,a=this.end,l=i.x,h=i.y,u=s.x,c=s.y,g=o.x,d=o.y,p=a.x,f=a.y,m=[],v=[[],[]];let y,b,x,w;for(let P=0;P<2;P+=1)x=0===P?(b=6*l-12*u+6*g,y=-3*l+9*u-9*g+3*p,3*u-3*l):(b=6*h-12*c+6*d,y=-3*h+9*c-9*d+3*f,3*c-3*h),Math.abs(y)<1e-12?Math.abs(b)<1e-12||0<(w=-x/b)&&w<1&&m.push(w):(t=b*b-4*x*y,e=Math.sqrt(t),t<0||(0<(t=(-b+e)/(2*y))&&t<1&&m.push(t),0<(t=(-b-e)/(2*y))&&t<1&&m.push(t)));let C=m.length;for(i=C;C;)--C,n=(r=1-(w=m[C]))*r*r*l+3*r*r*w*u+3*r*w*w*g+w*w*w*p,v[0][C]=n,r=r*r*r*h+3*r*r*w*c+3*r*w*w*d+w*w*w*f,v[1][C]=r;return m[i]=0,m[i+1]=1,v[0][i]=l,v[1][i]=h,v[0][i+1]=p,v[1][i+1]=f,m.length=i+2,v[0].length=i+2,v[1].length=i+2,s=Math.min.apply(null,v[0]),o=Math.min.apply(null,v[1]),a=Math.max.apply(null,v[0]),i=Math.max.apply(null,v[1]),new _s(s,o,a-s,i-o)}closestPoint(t,e={}){return this.pointAtT(this.closestPointT(t,e))}closestPointLength(t,e={}){return e=this.getOptions(e),this.lengthAtT(this.closestPointT(t,e),e)}closestPointNormalizedLength(t,e={}){e=this.getOptions(e),t=this.closestPointLength(t,e);return t&&0!==(e=this.length(e))?t/e:0}closestPointT(t,e={}){var n=this.getPrecision(e),r=(e=this.getDivisions(e),Math.pow(10,-n));let i=null,s=0,o=0,a=0,l=0,h=0,u=null;n=e.length;let c=0<n?1/n:0;for(e.forEach(((e,n)=>{var r=e.start.distance(t),g=e.end.distance(t),d=r+g;(null==u||d<u)&&(i=e,s=n*c,o=(n+1)*c,a=r,l=g,u=d,h=e.endpointDistance())}));;){var g=a?Math.abs(a-l)/a:0,d=null!=l?Math.abs(a-l)/l:0,p=!a||a<h*r,f=!l||l<h*r;if(g<r||d<r||p||f)return a<=l?s:o;g=i.divide(.5),d=(c/=2,g[0].start.distance(t)),p=g[0].end.distance(t),f=d+p;var m=g[1].start.distance(t),v=g[1].end.distance(t);l=f<=m+v?(i=g[0],o-=c,a=d,p):(i=g[1],s+=c,a=m,v)}}closestPointTangent(t,e={}){return this.tangentAtT(this.closestPointT(t,e))}containsPoint(t,e={}){return this.toPolyline(e).containsPoint(t)}divideAt(t,e={}){return t<=0?this.divideAtT(0):1<=t?this.divideAtT(1):(t=this.tAt(t,e),this.divideAtT(t))}divideAtLength(t,e={}){return t=this.tAtLength(t,e),this.divideAtT(t)}divide(t){return this.divideAtT(t)}divideAtT(t){var e,n,r=this.start,i=this.controlPoint1,s=this.controlPoint2,o=this.end;return t<=0?[new ho(r,r,r,r),new ho(r,i,s,o)]:1<=t?[new ho(r,i,s,o),new ho(o,o,o,o)]:(s=(i=this.getSkeletonPoints(t)).startControlPoint1,t=i.startControlPoint2,e=i.divider,n=i.dividerControlPoint1,i=i.dividerControlPoint2,[new ho(r,s,t,e),new ho(e,n,i,o)])}endpointDistance(){return this.start.distance(this.end)}getSkeletonPoints(t){var e=this.start,n=this.controlPoint1,r=this.controlPoint2,i=this.end;return t<=0?{startControlPoint1:e.clone(),startControlPoint2:e.clone(),divider:e.clone(),dividerControlPoint1:n.clone(),dividerControlPoint2:r.clone()}:1<=t?{startControlPoint1:n.clone(),startControlPoint2:r.clone(),divider:i.clone(),dividerControlPoint1:i.clone(),dividerControlPoint2:i.clone()}:(e=new Qs(e,n).pointAt(t),n=new Qs(n,r).pointAt(t),r=new Qs(r,i).pointAt(t),i=new Qs(e,n).pointAt(t),n=new Qs(n,r).pointAt(t),{startControlPoint1:e,startControlPoint2:i,divider:new Qs(i,n).pointAt(t),dividerControlPoint1:n,dividerControlPoint2:r})}getSubdivisions(t={}){t=this.getPrecision(t);let e=[new ho(this.start,this.controlPoint1,this.controlPoint2,this.end)];if(0===t)return e;let n=this.endpointDistance();var r=Math.pow(10,-t);let i=0;for(;;){i+=1;const t=[];e.forEach((e=>{e=e.divide(.5),t.push(e[0],e[1])}));var s=t.reduce(((t,e)=>t+e.endpointDistance()),0),o=0!==s?(s-n)/s:0;if(1<i&&o<r)return t;e=t,n=s}}length(t={}){return this.getDivisions(t).reduce(((t,e)=>t+e.endpointDistance()),0)}lengthAtT(t,e={}){return t<=0?0:(e=void 0===e.precision?this.PRECISION:e.precision,this.divide(t)[0].length({precision:e}))}pointAt(t,e={}){return t<=0?this.start.clone():1<=t?this.end.clone():(t=this.tAt(t,e),this.pointAtT(t))}pointAtLength(t,e={}){return t=this.tAtLength(t,e),this.pointAtT(t)}pointAtT(t){return t<=0?this.start.clone():1<=t?this.end.clone():this.getSkeletonPoints(t).divider}isDifferentiable(){var t=this.start,e=this.controlPoint1,n=this.controlPoint2,r=this.end;return!(t.equals(e)&&e.equals(n)&&n.equals(r))}tangentAt(t,e={}){return this.isDifferentiable()?(t<0?t=0:1<t&&(t=1),t=this.tAt(t,e),this.tangentAtT(t)):null}tangentAtLength(t,e={}){return this.isDifferentiable()?(t=this.tAtLength(t,e),this.tangentAtT(t)):null}tangentAtT(t){var e,n;return this.isDifferentiable()?(e=(t=this.getSkeletonPoints(t=1<(t=t<0?0:t)?1:t)).startControlPoint2,n=t.dividerControlPoint1,t=t.divider,(n=new Qs(e,n)).translate(t.x-e.x,t.y-e.y),n):null}getPrecision(t={}){return null==t.precision?this.PRECISION:t.precision}getDivisions(t={}){return null!=t.subdivisions?t.subdivisions:(t=this.getPrecision(t),this.getSubdivisions({precision:t}))}getOptions(t={}){return{precision:this.getPrecision(t),subdivisions:this.getDivisions(t)}}tAt(t,e={}){var n;return t<=0?0:1<=t?1:(e=this.getOptions(e),n=this.length(e),this.tAtLength(n*t,e))}tAtLength(t,e={}){let n=!0;t<0&&(n=!1,t=-t);var r=this.getPrecision(e),i=this.getDivisions(e);e={precision:r,subdivisions:i};let s,o,a=null,l=0,h=0,u=0;var c=i.length;let g=0<c?1/c:0;for(let w=0;w<c;w+=1){var d=n?w:c-1-w,p=i[w],f=p.endpointDistance();if(t<=u+f){a=p,s=d*g,o=(d+1)*g,l=n?t-u:f+u-t,h=n?f+u-t:t-u;break}u+=f}if(null==a)return n?1:0;for(var m=this.length(e),v=Math.pow(10,-r);;){var y=0!==m?l/m:0;if(y<v)return s;if((0!==m?h/m:0)<v)return o;let t,e;y=a.divide(.5);var b=(g/=2,y[0].endpointDistance()),x=y[1].endpointDistance();e=l<=b?(a=y[0],o-=g,b-(t=l)):(a=y[1],s+=g,x-(t=l-b)),l=t,h=e}}toPoints(t={}){t=this.getDivisions(t);const e=[t[0].start.clone()];return t.forEach((t=>e.push(t.end.clone()))),e}toPolyline(t={}){return new lo(this.toPoints(t))}scale(t,e,n){return this.start.scale(t,e,n),this.controlPoint1.scale(t,e,n),this.controlPoint2.scale(t,e,n),this.end.scale(t,e,n),this}rotate(t,e){return this.start.rotate(t,e),this.controlPoint1.rotate(t,e),this.controlPoint2.rotate(t,e),this.end.rotate(t,e),this}translate(t,e){return"number"==typeof t?(this.start.translate(t,e),this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e)):(this.start.translate(t),this.controlPoint1.translate(t),this.controlPoint2.translate(t),this.end.translate(t)),this}equals(t){return null!=t&&this.start.equals(t.start)&&this.controlPoint1.equals(t.controlPoint1)&&this.controlPoint2.equals(t.controlPoint2)&&this.end.equals(t.end)}clone(){return new ho(this.start,this.controlPoint1,this.controlPoint2,this.end)}toJSON(){return{start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}serialize(){return[this.start.serialize(),this.controlPoint1.serialize(),this.controlPoint2.serialize(),this.end.serialize()].join(" ")}}function uo(t){var e=t.length,n=[],r=[];let i=2;n[0]=t[0]/i;for(let s=1;s<e;s+=1)r[s]=1/i,i=(s<e-1?4:3.5)-r[s],n[s]=(t[s]-n[s-1])/i;for(let s=1;s<e;s+=1)n[e-s-1]-=r[e-s]*n[e-s];return n}(hs=ho=ho||{}).isCurve=function(t){return null!=t&&t instanceof hs},(us=ho=ho||{}).throughPoints=function(t){if(null==t||Array.isArray(t)&&t.length<2)throw new Error("At least 2 points are required");var e=function(t){var e=t.map((t=>Js.clone(t))),n=[],r=[],i=e.length-1;if(1==i)n[0]=new Js((2*e[0].x+e[1].x)/3,(2*e[0].y+e[1].y)/3),r[0]=new Js(2*n[0].x-e[0].x,2*n[0].y-e[0].y);else{var s=[];for(let t=1;t<i-1;t+=1)s[t]=4*e[t].x+2*e[t+1].x;s[0]=e[0].x+2*e[1].x,s[i-1]=(8*e[i-1].x+e[i].x)/2;var o=uo(s);for(let t=1;t<i-1;t+=1)s[t]=4*e[t].y+2*e[t+1].y;s[0]=e[0].y+2*e[1].y,s[i-1]=(8*e[i-1].y+e[i].y)/2;var a=uo(s);for(let t=0;t<i;t+=1)n.push(new Js(o[t],a[t])),t<i-1?r.push(new Js(2*e[t+1].x-o[t+1],2*e[t+1].y-a[t+1])):r.push(new Js((e[i].x+o[i-1])/2,(e[i].y+a[i-1])/2))}return[n,r]}(t),n=[];for(let s=0,o=e[0].length;s<o;s+=1){var r=new Js(e[0][s].x,e[0][s].y),i=new Js(e[1][s].x,e[1][s].y);n.push(new us(t[s],r,i,t[s+1]))}return n};class co extends Us{constructor(){super(...arguments),this.isVisible=!0,this.isSegment=!0,this.isSubpathStart=!1}get end(){return this.endPoint}get start(){if(null==this.previousSegment)throw new Error("Missing previous segment. (This segment cannot be the first segment of a path, or segment has not yet been added to a path.)");return this.previousSegment.end}closestPointT(t,e){if(this.closestPointNormalizedLength)return this.closestPointNormalizedLength(t);throw new Error("Neither `closestPointT` nor `closestPointNormalizedLength` method is implemented.")}lengthAtT(t,e){var n;return t<=0?0:(n=this.length(),1<=t?n:n*t)}divideAtT(t){if(this.divideAt)return this.divideAt(t);throw new Error("Neither `divideAtT` nor `divideAt` method is implemented.")}pointAtT(t){if(this.pointAt)return this.pointAt(t);throw new Error("Neither `pointAtT` nor `pointAt` method is implemented.")}tangentAtT(t){if(this.tangentAt)return this.tangentAt(t);throw new Error("Neither `tangentAtT` nor `tangentAt` method is implemented.")}}class go extends co{constructor(t,e){super(),Qs.isLine(t)?this.endPoint=t.end.clone().round(2):this.endPoint=Js.create(t,e).round(2)}get type(){return"L"}get line(){return new Qs(this.start,this.end)}bbox(){return this.line.bbox()}closestPoint(t){return this.line.closestPoint(t)}closestPointLength(t){return this.line.closestPointLength(t)}closestPointNormalizedLength(t){return this.line.closestPointNormalizedLength(t)}closestPointTangent(t){return this.line.closestPointTangent(t)}length(){return this.line.length()}divideAt(t){return t=this.line.divideAt(t),[new go(t[0]),new go(t[1])]}divideAtLength(t){return t=this.line.divideAtLength(t),[new go(t[0]),new go(t[1])]}getSubdivisions(){return[]}pointAt(t){return this.line.pointAt(t)}pointAtLength(t){return this.line.pointAtLength(t)}tangentAt(t){return this.line.tangentAt(t)}tangentAtLength(t){return this.line.tangentAtLength(t)}isDifferentiable(){return null!=this.previousSegment&&!this.start.equals(this.end)}clone(){return new go(this.end)}scale(t,e,n){return this.end.scale(t,e,n),this}rotate(t,e){return this.end.rotate(t,e),this}translate(t,e){return"number"==typeof t?this.end.translate(t,e):this.end.translate(t),this}equals(t){return this.type===t.type&&this.start.equals(t.start)&&this.end.equals(t.end)}toJSON(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){var t=this.end;return`${this.type} ${t.x} `+t.y}}(cs=go=go||{}).create=function(...t){var e=t.length,n=t[0];if(Qs.isLine(n))return new cs(n);if(Js.isPointLike(n))return 1===e?new cs(n):t.map((t=>new cs(t)));if(2===e)return new cs(+t[0],+t[1]);var r=[];for(let o=0;o<e;o+=2){var i=+t[o],s=+t[o+1];r.push(new cs(i,s))}return r};class po extends co{get end(){if(this.subpathStartSegment)return this.subpathStartSegment.end;throw new Error("Missing subpath start segment. (This segment needs a subpath start segment (e.g. MoveTo), or segment has not yet been added to a path.)")}get type(){return"Z"}get line(){return new Qs(this.start,this.end)}bbox(){return this.line.bbox()}closestPoint(t){return this.line.closestPoint(t)}closestPointLength(t){return this.line.closestPointLength(t)}closestPointNormalizedLength(t){return this.line.closestPointNormalizedLength(t)}closestPointTangent(t){return this.line.closestPointTangent(t)}length(){return this.line.length()}divideAt(t){return t=this.line.divideAt(t),[t[1].isDifferentiable()?new go(t[0]):this.clone(),new go(t[1])]}divideAtLength(t){return t=this.line.divideAtLength(t),[t[1].isDifferentiable()?new go(t[0]):this.clone(),new go(t[1])]}getSubdivisions(){return[]}pointAt(t){return this.line.pointAt(t)}pointAtLength(t){return this.line.pointAtLength(t)}tangentAt(t){return this.line.tangentAt(t)}tangentAtLength(t){return this.line.tangentAtLength(t)}isDifferentiable(){return!(!this.previousSegment||!this.subpathStartSegment||this.start.equals(this.end))}scale(){return this}rotate(){return this}translate(){return this}equals(t){return this.type===t.type&&this.start.equals(t.start)&&this.end.equals(t.end)}clone(){return new po}toJSON(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){return this.type}}(gs=po=po||{}).create=function(){return new gs};class fo extends co{constructor(t,e){super(),this.isVisible=!1,this.isSubpathStart=!0,Qs.isLine(t)||ho.isCurve(t)?this.endPoint=t.end.clone().round(2):this.endPoint=Js.create(t,e).round(2)}get start(){throw new Error("Illegal access. Moveto segments should not need a start property.")}get type(){return"M"}bbox(){return null}closestPoint(){return this.end.clone()}closestPointLength(){return 0}closestPointNormalizedLength(){return 0}closestPointT(){return 1}closestPointTangent(){return null}length(){return 0}lengthAtT(){return 0}divideAt(){return[this.clone(),this.clone()]}divideAtLength(){return[this.clone(),this.clone()]}getSubdivisions(){return[]}pointAt(){return this.end.clone()}pointAtLength(){return this.end.clone()}pointAtT(){return this.end.clone()}tangentAt(){return null}tangentAtLength(){return null}tangentAtT(){return null}isDifferentiable(){return!1}scale(t,e,n){return this.end.scale(t,e,n),this}rotate(t,e){return this.end.rotate(t,e),this}translate(t,e){return"number"==typeof t?this.end.translate(t,e):this.end.translate(t),this}clone(){return new fo(this.end)}equals(t){return this.type===t.type&&this.end.equals(t.end)}toJSON(){return{type:this.type,end:this.end.toJSON()}}serialize(){var t=this.end;return`${this.type} ${t.x} `+t.y}}(ds=fo=fo||{}).create=function(...t){var e=t.length,n=t[0];if(Qs.isLine(n))return new ds(n);if(ho.isCurve(n))return new ds(n);if(Js.isPointLike(n)){if(1===e)return new ds(n);const r=[];for(let n=0;n<e;n+=1)0===n?r.push(new ds(t[n])):r.push(new go(t[n]));return r}if(2===e)return new ds(+t[0],+t[1]);const r=[];for(let o=0;o<e;o+=2){var i=+t[o],s=+t[o+1];0===o?r.push(new ds(i,s)):r.push(new go(i,s))}return r};class mo extends co{constructor(t,e,n,r,i,s){super(),ho.isCurve(t)?(this.controlPoint1=t.controlPoint1.clone().round(2),this.controlPoint2=t.controlPoint2.clone().round(2),this.endPoint=t.end.clone().round(2)):"number"==typeof t?(this.controlPoint1=new Js(t,e).round(2),this.controlPoint2=new Js(n,r).round(2),this.endPoint=new Js(i,s).round(2)):(this.controlPoint1=Js.create(t).round(2),this.controlPoint2=Js.create(e).round(2),this.endPoint=Js.create(n).round(2))}get type(){return"C"}get curve(){return new ho(this.start,this.controlPoint1,this.controlPoint2,this.end)}bbox(){return this.curve.bbox()}closestPoint(t){return this.curve.closestPoint(t)}closestPointLength(t){return this.curve.closestPointLength(t)}closestPointNormalizedLength(t){return this.curve.closestPointNormalizedLength(t)}closestPointTangent(t){return this.curve.closestPointTangent(t)}length(){return this.curve.length()}divideAt(t,e={}){return t=this.curve.divideAt(t,e),[new mo(t[0]),new mo(t[1])]}divideAtLength(t,e={}){return t=this.curve.divideAtLength(t,e),[new mo(t[0]),new mo(t[1])]}divideAtT(t){return t=this.curve.divideAtT(t),[new mo(t[0]),new mo(t[1])]}getSubdivisions(){return[]}pointAt(t){return this.curve.pointAt(t)}pointAtLength(t){return this.curve.pointAtLength(t)}tangentAt(t){return this.curve.tangentAt(t)}tangentAtLength(t){return this.curve.tangentAtLength(t)}isDifferentiable(){var t,e,n,r;return!(!this.previousSegment||(t=this.start,e=this.controlPoint1,n=this.controlPoint2,r=this.end,t.equals(e)&&e.equals(n)&&n.equals(r)))}scale(t,e,n){return this.controlPoint1.scale(t,e,n),this.controlPoint2.scale(t,e,n),this.end.scale(t,e,n),this}rotate(t,e){return this.controlPoint1.rotate(t,e),this.controlPoint2.rotate(t,e),this.end.rotate(t,e),this}translate(t,e){return"number"==typeof t?(this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e)):(this.controlPoint1.translate(t),this.controlPoint2.translate(t),this.end.translate(t)),this}equals(t){return this.start.equals(t.start)&&this.end.equals(t.end)&&this.controlPoint1.equals(t.controlPoint1)&&this.controlPoint2.equals(t.controlPoint2)}clone(){return new mo(this.controlPoint1,this.controlPoint2,this.end)}toJSON(){return{type:this.type,start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}serialize(){var t=this.controlPoint1,e=this.controlPoint2,n=this.end;return[this.type,t.x,t.y,e.x,e.y,n.x,n.y].join(" ")}}function vo(t,e,n){return{x:t*Math.cos(n)-e*Math.sin(n),y:t*Math.sin(n)+e*Math.cos(n)}}function yo(t,e,n,r,i,s){return[1/3*t+2/3*n,1/3*e+2/3*r,1/3*i+2/3*n,1/3*s+2/3*r,i,s]}function bo(t,e,n,r,i,s,o,a,l,h){var u=120*Math.PI/180,c=Math.PI/180*(+i||0);let g,d,p,f,m=[];h?(g=h[0],d=h[1],p=h[2],f=h[3]):(t=(b=vo(t,e,-c)).x,e=b.y,1<(v=(y=(t-(a=(b=vo(a,l,-c)).x))/2)*y/(n*n)+(b=(e-(l=b.y))/2)*b/(r*r))&&(n*=v=Math.sqrt(v),r*=v),v=n*n,x=r*r,s=(s===o?-1:1)*Math.sqrt(Math.abs((v*x-v*b*b-x*y*y)/(v*b*b+x*y*y))),p=s*n*b/r+(t+a)/2,f=s*-r*y/n+(e+l)/2,g=Math.asin((e-f)/r),d=Math.asin((l-f)/r),g=t<p?Math.PI-g:g,d=a<p?Math.PI-d:d,g<0&&(g=2*Math.PI+g),d<0&&(d=2*Math.PI+d),o&&g>d&&(g-=2*Math.PI),!o&&d>g&&(d-=2*Math.PI));var v=d-g,y=(Math.abs(v)>u&&(x=d,b=a,s=l,d=g+u*(o&&d>g?1:-1),a=p+n*Math.cos(d),l=f+r*Math.sin(d),m=bo(a,l,n,r,i,0,o,b,s,[d,x,p,f])),v=d-g,Math.cos(g)),b=(u=Math.sin(g),i=Math.cos(d),o=Math.sin(d),Math.tan(v/4)),x=(s=4/3*(n*b),4/3*(r*b));v=[t,e],n=[t+s*u,e-x*y],r=[a+s*o,l-x*i],b=[a,l];if(n[0]=2*v[0]-n[0],n[1]=2*v[1]-n[1],h)return[n,r,b].concat(m);var w=[],C=(m=[n,r,b].concat(m).join().split(",")).length;for(let P=0;P<C;P+=1)w[P]=P%2?vo(+m[P-1],+m[P],c).y:vo(+m[P],+m[P+1],c).x;return w}function xo(t){var e=function(t){if(!t)return null;var e="\t\n\v\f\r   ᠎             　\u2028\u2029",n=new RegExp(`([a-z])[${e},]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?[${e}]*,?[${e}]*)+)`,"ig");const r=new RegExp(`(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[${e}]*,?[${e}]*`,"ig"),i={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},s=[];return t.replace(n,((t,e,n)=>{const o=[];let a=e.toLowerCase();n.replace(r,((t,e)=>(e&&o.push(+e),t))),"m"===a&&2<o.length&&(s.push([e,...o.splice(0,2)]),a="l",e="m"===e?"l":"L");for(var l=i[a];o.length>=l&&(s.push([e,...o.splice(0,l)]),l););return t})),s}(t);if(!e||!e.length)return[["M",0,0]];let n=0,r=0,i=0,s=0;var o=[];for(let u=0,c=e.length;u<c;u+=1){var a=[],l=(o.push(a),e[u]),h=l[0];if(h!==h.toUpperCase())switch(a[0]=h.toUpperCase(),a[0]){case"A":a[1]=l[1],a[2]=l[2],a[3]=l[3],a[4]=l[4],a[5]=l[5],a[6]=+l[6]+n,a[7]=+l[7]+r;break;case"V":a[1]=+l[1]+r;break;case"H":a[1]=+l[1]+n;break;case"M":i=+l[1]+n,s=+l[2]+r;for(let t=1,e=l.length;t<e;t+=1)a[t]=+l[t]+(t%2?n:r);break;default:for(let t=1,e=l.length;t<e;t+=1)a[t]=+l[t]+(t%2?n:r)}else for(let t=0,e=l.length;t<e;t+=1)a[t]=l[t];switch(a[0]){case"Z":n=+i,r=+s;break;case"H":n=a[1];break;case"V":r=a[1];break;case"M":i=a[a.length-2],s=a[a.length-1],n=a[a.length-2],r=a[a.length-1];break;default:n=a[a.length-2],r=a[a.length-1]}}return o}function wo(t){const e=xo(t);var n={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};const r=[];let i="",s=e.length;for(let c=0;c<s;c+=1){let t="";"C"!==(t=e[c]?e[c][0]:t)&&(r[c]=t,0<c)&&(i=r[c-1]),e[c]=function(t,e,n){let r,i;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(t[0]in{T:1,Q:1}||(e.qx=null,e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":return 0===parseFloat(t[1])||0===parseFloat(t[2])?["L",t[6],t[7]]:["C"].concat(bo.apply(0,[e.x,e.y].concat(t.slice(1))));case"S":return i="C"===n||"S"===n?(r=2*e.x-e.bx,2*e.y-e.by):(r=e.x,e.y),["C",r,i].concat(t.slice(1));case"T":return"Q"===n||"T"===n?(e.qx=2*e.x-e.qx,e.qy=2*e.y-e.qy):(e.qx=e.x,e.qy=e.y),["C"].concat(yo(e.x,e.y,e.qx,e.qy,t[1],t[2]));case"Q":return e.qx=t[1],e.qy=t[2],["C"].concat(yo(e.x,e.y,t[1],t[2],t[3],t[4]));case"H":return["L"].concat(t[1],e.y);case"V":return["L"].concat(e.x,t[1])}return t}(e[c],n,i),"A"!==r[c]&&"C"===t&&(r[c]="C"),l=a=o=void 0;var o=e,a=c;if(7<o[a].length){o[a].shift();for(var l=o[a];l.length;)r[a]="A",o.splice(a+=1,0,["C"].concat(l.splice(0,6)));o.splice(a,1),s=e.length}var h=e[c],u=h.length;n.x=h[u-2],n.y=h[u-1],n.bx=parseFloat(h[u-4])||n.x,n.by=parseFloat(h[u-3])||n.y}return e[0][0]&&"M"===e[0][0]||e.unshift(["M",0,0]),e}function Co(t){return wo(t).map((t=>t.map((t=>"string"==typeof t?t:Qi.round(t,2))))).join(",").split(",").join(" ")}(ps=mo=mo||{}).create=function(...t){var e=t.length,n=t[0];if(ho.isCurve(n))return new ps(n);if(Js.isPointLike(n)){if(3===e)return new ps(t[0],t[1],t[2]);const n=[];for(let r=0;r<e;r+=3)n.push(new ps(t[r],t[r+1],t[r+2]));return n}if(6===e)return new ps(t[0],t[1],t[2],t[3],t[4],t[5]);const r=[];for(let i=0;i<e;i+=6)r.push(new ps(t[i],t[i+1],t[i+2],t[i+3],t[i+4],t[i+5]));return r};class Po extends Us{constructor(t){if(super(),this.PRECISION=3,this.segments=[],Array.isArray(t))if(Qs.isLine(t[0])||ho.isCurve(t[0])){let e=null;t.forEach(((t,n)=>{0===n&&this.appendSegment(Po.createSegment("M",t.start)),null==e||e.end.equals(t.start)||this.appendSegment(Po.createSegment("M",t.start)),Qs.isLine(t)?this.appendSegment(Po.createSegment("L",t.end)):ho.isCurve(t)&&this.appendSegment(Po.createSegment("C",t.controlPoint1,t.controlPoint2,t.end)),e=t}))}else t.forEach((t=>{t.isSegment&&this.appendSegment(t)}));else null!=t&&(Qs.isLine(t)?(this.appendSegment(Po.createSegment("M",t.start)),this.appendSegment(Po.createSegment("L",t.end))):ho.isCurve(t)?(this.appendSegment(Po.createSegment("M",t.start)),this.appendSegment(Po.createSegment("C",t.controlPoint1,t.controlPoint2,t.end))):lo.isPolyline(t)?t.points&&t.points.length&&t.points.forEach(((t,e)=>{e=0===e?Po.createSegment("M",t):Po.createSegment("L",t),this.appendSegment(e)})):t.isSegment&&this.appendSegment(t))}get start(){var t=this.segments,e=t.length;if(0===e)return null;for(let r=0;r<e;r+=1){var n=t[r];if(n.isVisible)return n.start}return t[e-1].end}get end(){var t=this.segments,e=t.length;if(0===e)return null;for(let r=e-1;0<=r;--r){var n=t[r];if(n.isVisible)return n.end}return t[e-1].end}moveTo(...t){return this.appendSegment(fo.create.call(null,...t))}lineTo(...t){return this.appendSegment(go.create.call(null,...t))}curveTo(...t){return this.appendSegment(mo.create.call(null,...t))}arcTo(t,e,n,r,i,s,o){var a=this.end||new Js,l="number"==typeof s?oo(a.x,a.y,t,e,n,r,i,s,o):oo(a.x,a.y,t,e,n,r,i,s.x,s.y);if(null!=l)for(let h=0,u=l.length;h<u;h+=6)this.curveTo(l[h],l[h+1],l[h+2],l[h+3],l[h+4],l[h+5]);return this}quadTo(t,e,n,r){var i=this.end||new Js;i=["M",i.x,i.y],"number"==typeof t?i.push("Q",t,e,n,r):i.push("Q",t.x,t.y,e.x,e.y),n=Po.parse(i.join(" "));return this.appendSegment(n.segments.slice(1)),this}close(){return this.appendSegment(po.create())}drawPoints(t,e={}){t=so(t,e),e=Po.parse(t),e&&e.segments&&this.appendSegment(e.segments)}bbox(){var t,e=this.segments,n=e.length;if(0===n)return null;let r;for(let s=0;s<n;s+=1){var i=e[s];i.isVisible&&null!=(i=i.bbox())&&(r=r?r.union(i):i)}return null!=r?r:(t=e[n-1],new _s(t.end.x,t.end.y,0,0))}appendSegment(t){var e=this.segments.length;let n,r=0!==e?this.segments[e-1]:null;if(Array.isArray(t))for(let s=0,o=t.length;s<o;s+=1){var i=t[s];n=this.prepareSegment(i,r,null),this.segments.push(n),r=n}else null!=t&&t.isSegment&&(n=this.prepareSegment(t,r,null),this.segments.push(n));return this}insertSegment(t,e){var n=this.segments.length;if(n<(t=t<0?n+t+1:t)||t<0)throw new Error("Index out of range.");let r,i=null,s=null;if(0!==n&&(s=1<=t?(i=this.segments[t-1]).nextSegment:(i=null,this.segments[0])),Array.isArray(e))for(let a=0,l=e.length;a<l;a+=1){var o=e[a];r=this.prepareSegment(o,i,s),this.segments.splice(t+a,0,r),i=r}else r=this.prepareSegment(e,i,s),this.segments.splice(t,0,r);return this}removeSegment(t){t=this.fixIndex(t),t=this.segments.splice(t,1)[0];var e=t.previousSegment,n=t.nextSegment;return e&&(e.nextSegment=n),n&&(n.previousSegment=e),t.isSubpathStart&&n&&this.updateSubpathStartSegment(n),t}replaceSegment(t,e){var n=this.fixIndex(t);let r;var i=this.segments[n];let s=i.previousSegment;var o=i.nextSegment;let a=i.isSubpathStart;if(Array.isArray(e)){this.segments.splice(t,1);for(let n=0,i=e.length;n<i;n+=1){var l=e[n];r=this.prepareSegment(l,s,o),this.segments.splice(t+n,0,r),s=r,a&&r.isSubpathStart&&(a=!1)}}else r=this.prepareSegment(e,s,o),this.segments.splice(n,1,r),a&&r.isSubpathStart&&(a=!1);a&&o&&this.updateSubpathStartSegment(o)}getSegment(t){return t=this.fixIndex(t),this.segments[t]}fixIndex(t){var e=this.segments.length;if(0===e)throw new Error("Path has no segments.");let n=t;for(;n<0;)n=e+n;if(n>=e||n<0)throw new Error("Index out of range.");return n}segmentAt(t,e={}){return t=this.segmentIndexAt(t,e),t?this.getSegment(t):null}segmentAtLength(t,e={}){return t=this.segmentIndexAtLength(t,e),t?this.getSegment(t):null}segmentIndexAt(t,e={}){var n;return 0===this.segments.length?null:(t=Qi.clamp(t,0,1),e=this.getOptions(e),n=this.length(e),this.segmentIndexAtLength(n*t,e))}segmentIndexAtLength(t,e={}){var n=this.segments.length;if(0===n)return null;let r=!0;t<0&&(r=!1,t=-t);var i=this.getPrecision(e),s=this.getSubdivisions(e);let o=0,a=null;for(let c=0;c<n;c+=1){var l=r?c:n-1-c,h=this.segments[l],u=s[l];u=h.length({precision:i,subdivisions:u});if(h.isVisible){if(t<=o+u)return l;a=l}o+=u}return a}getSegmentSubdivisions(t={}){var e=this.getPrecision(t),n=[];for(let i=0,s=this.segments.length;i<s;i+=1){var r=this.segments[i].getSubdivisions({precision:e});n.push(r)}return n}updateSubpathStartSegment(t){let e=t.previousSegment,n=t;for(;n&&!n.isSubpathStart;)n.subpathStartSegment=null!=e?e.subpathStartSegment:null,n=(e=n).nextSegment}prepareSegment(t,e,n){t.previousSegment=e,t.nextSegment=n,null!=e&&(e.nextSegment=t),null!=n&&(n.previousSegment=t);let r=t;return t.isSubpathStart&&(t.subpathStartSegment=t,r=n),null!=r&&this.updateSubpathStartSegment(r),t}closestPoint(t,e={}){return t=this.closestPointT(t,e),t?this.pointAtT(t):null}closestPointLength(t,e={}){return e=this.getOptions(e),t=this.closestPointT(t,e),t?this.lengthAtT(t,e):0}closestPointNormalizedLength(t,e={}){e=this.getOptions(e),t=this.closestPointLength(t,e);return 0===t||0===(e=this.length(e))?0:t/e}closestPointT(t,e={}){if(0===this.segments.length)return null;var n=this.getPrecision(e),r=this.getSubdivisions(e);let i,s=1/0;for(let l=0,h=this.segments.length;l<h;l+=1){var o=this.segments[l],a=r[l];o.isVisible&&(a=o.closestPointT(t,{precision:n,subdivisions:a}),o=o.pointAtT(a),(o=Qi.squaredLength(o,t))<s)&&(i={segmentIndex:l,value:a},s=o)}return i||{segmentIndex:this.segments.length-1,value:1}}closestPointTangent(t,e={}){if(0===this.segments.length)return null;var n=this.getPrecision(e),r=this.getSubdivisions(e);let i,s=1/0;for(let h=0,u=this.segments.length;h<u;h+=1){var o,a=this.segments[h],l=r[h];a.isDifferentiable()&&(l=a.closestPointT(t,{precision:n,subdivisions:l}),o=a.pointAtT(l),(o=Qi.squaredLength(o,t))<s)&&(i=a.tangentAtT(l),s=o)}return i||null}containsPoint(t,e={}){var n=this.toPolylines(e);if(!n)return!1;let r=0;for(let i=0,s=n.length;i<s;i+=1)n[i].containsPoint(t)&&(r+=1);return r%2==1}pointAt(t,e={}){var n;return 0===this.segments.length?null:t<=0?this.start.clone():1<=t?this.end.clone():(e=this.getOptions(e),n=this.length(e),this.pointAtLength(n*t,e))}pointAtLength(t,e={}){if(0===this.segments.length)return null;if(0===t)return this.start.clone();let n=!0;t<0&&(n=!1,t=-t);var r=this.getPrecision(e),i=this.getSubdivisions(e);let s,o=0;for(let u=0,c=this.segments.length;u<c;u+=1){var a=n?u:c-1-u,l=this.segments[a],h=(a=i[a],l.length({precision:r,subdivisions:a}));if(l.isVisible){if(t<=o+h)return l.pointAtLength((n?1:-1)*(t-o),{precision:r,subdivisions:a});s=l}o+=h}return s?n?s.end:s.start:this.segments[this.segments.length-1].end.clone()}pointAtT(t){var e,n=this.segments,r=n.length;return 0===r?null:(e=t.segmentIndex)<0?n[0].pointAtT(0):r<=e?n[r-1].pointAtT(1):(r=Qi.clamp(t.value,0,1),n[e].pointAtT(r))}divideAt(t,e={}){var n;return 0===this.segments.length?null:(t=Qi.clamp(t,0,1),e=this.getOptions(e),n=this.length(e),this.divideAtLength(n*t,e))}divideAtLength(t,e={}){if(0===this.segments.length)return null;let n=!0;t<0&&(n=!1,t=-t);var r=this.getPrecision(e),i=this.getSubdivisions(e);let s,o,a,l,h=0;for(let w=0,C=this.segments.length;w<C;w+=1){const e=n?w:C-1-w;var u=this.getSegment(e),c={precision:r,subdivisions:i[e]},g=u.length(c);if(u.isDifferentiable()&&(a=u,l=e,t<=h+g)){o=e,s=u.divideAtLength((n?1:-1)*(t-h),c);break}h+=g}if(!a)return null;s||(o=l,e=n?1:0,s=a.divideAtT(e));var d=this.clone();const p=o;d.replaceSegment(p,s),e=p;let f=p+1,m=p+2;s[0].isDifferentiable()||(d.removeSegment(e),--f,--m);var v=d.getSegment(f).start,y=(d.insertSegment(f,Po.createSegment("M",v)),m+=1,s[1].isDifferentiable()||(d.removeSegment(m-1),--m),m-e-1);for(let w=m,C=d.segments.length;w<C;w+=1){var b=this.getSegment(w-y),x=d.getSegment(w);"Z"!==x.type||b.subpathStartSegment.end.equals(x.subpathStartSegment.end)||(x=Po.createSegment("L",b.end),d.replaceSegment(w,x))}return[new Po(d.segments.slice(0,f)),new Po(d.segments.slice(f))]}intersectsWithLine(t,e={}){var n=this.toPolylines(e);if(null==n)return null;let r=null;for(let s=0,o=n.length;s<o;s+=1){var i=n[s];i=t.intersect(i);i&&(null==r&&(r=[]),Array.isArray(i)?r.push(...i):r.push(i))}return r}isDifferentiable(){for(let t=0,e=this.segments.length;t<e;t+=1)if(this.segments[t].isDifferentiable())return!0;return!1}isValid(){var t=this.segments;return 0===t.length||"M"===t[0].type}length(t={}){if(0===this.segments.length)return 0;var e=this.getSubdivisions(t);let n=0;for(let s=0,o=this.segments.length;s<o;s+=1){var r=this.segments[s],i=e[s];n+=r.length({subdivisions:i})}return n}lengthAtT(t,e={}){var n=this.segments.length;if(0===n)return 0;let r=t.segmentIndex;if(r<0)return 0;let i=Qi.clamp(t.value,0,1);r>=n&&(r=n-1,i=1);var s=this.getPrecision(e),o=this.getSubdivisions(e);let a=0;for(let u=0;u<r;u+=1){const t=this.segments[u],e=o[u];a+=t.length({precision:s,subdivisions:e})}const l=this.segments[r],h=o[r];return a+l.lengthAtT(i,{precision:s,subdivisions:h})}tangentAt(t,e={}){var n;return 0===this.segments.length?null:(t=Qi.clamp(t,0,1),e=this.getOptions(e),n=this.length(e),this.tangentAtLength(n*t,e))}tangentAtLength(t,e={}){if(0===this.segments.length)return null;let n=!0;t<0&&(n=!1,t=-t);var r=this.getPrecision(e),i=this.getSubdivisions(e);let s,o=0;for(let u=0,c=this.segments.length;u<c;u+=1){var a=n?u:c-1-u,l=this.segments[a],h=(a=i[a],l.length({precision:r,subdivisions:a}));if(l.isDifferentiable()){if(t<=o+h)return l.tangentAtLength((n?1:-1)*(t-o),{precision:r,subdivisions:a});s=l}o+=h}return s?(e=n?1:0,s.tangentAtT(e)):null}tangentAtT(t){var e,n=this.segments.length;return 0===n?null:(e=t.segmentIndex)<0?this.segments[0].tangentAtT(0):n<=e?this.segments[n-1].tangentAtT(1):(n=Qi.clamp(t.value,0,1),this.segments[e].tangentAtT(n))}getPrecision(t={}){return null==t.precision?this.PRECISION:t.precision}getSubdivisions(t={}){var e;return null==t.segmentSubdivisions?(e=this.getPrecision(t),this.getSegmentSubdivisions({precision:e})):t.segmentSubdivisions}getOptions(t={}){return{precision:this.getPrecision(t),segmentSubdivisions:this.getSubdivisions(t)}}toPoints(t={}){var e=this.segments,n=e.length;if(0===n)return null;var r=this.getSubdivisions(t),i=[];let s=[];for(let l=0;l<n;l+=1){var o,a=e[l];a.isVisible?0<(o=r[l]).length?o.forEach((t=>s.push(t.start))):s.push(a.start):0<s.length&&(s.push(e[l-1].end),i.push(s),s=[])}return 0<s.length&&(s.push(this.end),i.push(s)),i}toPolylines(t={}){return t=this.toPoints(t),t?t.map((t=>new lo(t))):null}scale(t,e,n){return this.segments.forEach((r=>r.scale(t,e,n))),this}rotate(t,e){return this.segments.forEach((n=>n.rotate(t,e))),this}translate(t,e){return"number"==typeof t?this.segments.forEach((n=>n.translate(t,e))):this.segments.forEach((e=>e.translate(t))),this}clone(){const t=new Po;return this.segments.forEach((e=>t.appendSegment(e.clone()))),t}equals(t){if(null==t)return!1;var e=this.segments,n=t.segments,r=e.length;if(n.length!==r)return!1;for(let o=0;o<r;o+=1){var i=e[o],s=n[o];if(i.type!==s.type||!i.equals(s))return!1}return!0}toJSON(){return this.segments.map((t=>t.toJSON()))}serialize(){if(this.isValid())return this.segments.map((t=>t.serialize())).join(" ");throw new Error("Invalid path segments.")}toString(){return this.serialize()}}function Ao(t,...e){if("M"===t)return fo.create.call(null,...e);if("L"===t)return go.create.call(null,...e);if("C"===t)return mo.create.call(null,...e);if("z"===t||"Z"===t)return po.create();throw new Error(`Invalid path segment type "${t}"`)}(fs=Po=Po||{}).isPath=function(t){return null!=t&&t instanceof fs},(ms=Po=Po||{}).parse=function(t){if(!t)return new ms;var e=new ms,n=ms.normalize(t).match(/(?:[a-zA-Z] *)(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)? *,? *)|(?:-?\.\d+ *,? *))+|(?:[a-zA-Z] *)(?! |\d|-|\.)/g);if(null!=n)for(let s=0,o=n.length;s<o;s+=1){var r,i=n[s].match(/(?:[a-zA-Z])|(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)?))|(?:(?:-?\.\d+))/g);null!=i&&(r=i[0],i=i.slice(1).map((t=>+t)),r=Ao.call(null,r,...i),e.appendSegment(r))}return e},ms.createSegment=Ao,(ve=Po=Po||{}).normalize=Co,ve.isValid=ro,ve.drawArc=ao,ve.drawPoints=so,ve.arcToCurves=oo;class Eo{constructor(t){this.options=Object.assign({},t),this.data=this.options.data||{},this.register=this.register.bind(this),this.unregister=this.unregister.bind(this)}get names(){return Object.keys(this.data)}register(t,e,n=!1){if("object"!=typeof t)return!this.exist(t)||n||Xe.isApplyingHMR()||this.onDuplicated(t),n=(n=this.options.process)?M(n,this,t,e):e,this.data[t]=n;Object.entries(t).forEach((([t,n])=>{this.register(t,n,e)}))}unregister(t){var e=t?this.data[t]:null;return delete this.data[t],e}get(t){return t?this.data[t]:null}exist(t){return!!t&&null!=this.data[t]}onDuplicated(t){try{throw this.options.onConflict&&M(this.options.onConflict,this,t),new Error(Ie(this.options.type)+` with name '${t}' already registered.`)}catch(t){throw t}}onNotFound(t,e){throw new Error(this.getSpellingSuggestion(t,e))}getSpellingSuggestion(t,e){var n=this.getSpellingSuggestionForName(t);e=e?e+" "+qe(this.options.type):this.options.type;return Ie(e)+` with name '${t}' does not exist.`+(n?` Did you mean '${n}'?`:"")}getSpellingSuggestionForName(t){return We(t,Object.keys(this.data),(t=>t))}}(vs=Eo=Eo||{}).create=function(t){return new vs(t)};const Mo={color:"#aaaaaa",thickness:1,markup:"rect",update(t,e){var n=e.thickness*e.sx,r=e.thickness*e.sy;ur(t,{width:n,height:r,rx:n,ry:r,fill:e.color})}},So={color:"#aaaaaa",thickness:1,markup:"rect",update(t,e){var n=e.sx<=1?e.thickness*e.sx:e.thickness;ur(t,{width:n,height:n,rx:n,ry:n,fill:e.color})}},Oo={color:"rgba(224,224,224,1)",thickness:1,markup:"path",update(t,e){let n;var r=e.width,i=e.height,s=e.thickness;ur(t,{d:n=0<=r-s&&0<=i-s?["M",r,0,"H0 M0 0 V0",i].join(" "):"M 0 0 0 0",stroke:e.color,"stroke-width":e.thickness})}},To=[{color:"rgba(224,224,224,1)",thickness:1,markup:"path",update(t,e){let n;var r=e.width,i=e.height,s=e.thickness;ur(t,{d:n=0<=r-s&&0<=i-s?["M",r,0,"H0 M0 0 V0",i].join(" "):"M 0 0 0 0",stroke:e.color,"stroke-width":e.thickness})}},{color:"rgba(224,224,224,0.2)",thickness:3,factor:4,markup:"path",update(t,e){let n;var r=e.factor||1,i=e.width*r,s=(r=e.height*r,e.thickness);n=0<=i-s&&0<=r-s?["M",i,0,"H0 M0 0 V0",r].join(" "):"M 0 0 0 0",e.width=i,e.height=r,ur(t,{d:n,stroke:e.color,"stroke-width":e.thickness})}}];class No{constructor(){this.patterns={},this.root=Wr.create($n(),{width:"100%",height:"100%"},[Fn("defs")]).node}add(t,e){var n=this.root.childNodes[0];n&&n.appendChild(e),this.patterns[t]=e,Wr.create("rect",{width:"100%",height:"100%",fill:`url(#${t})`}).appendTo(this.root)}get(t){return this.patterns[t]}has(t){return null!=this.patterns[t]}}(K=No=No||{}).presets=e,K.registry=Eo.create({type:"grid"}),K.registry.register(K.presets,!0);const ko=function(t){var e=document.createElement("canvas"),n=t.width,r=t.height,i=(e.width=2*n,e.height=r,e.getContext("2d"));return i.drawImage(t,0,0,n,r),i.translate(2*n,0),i.scale(-1,1),i.drawImage(t,0,0,n,r),e},jo=function(t){var e=document.createElement("canvas"),n=t.width,r=t.height,i=(e.width=n,e.height=2*r,e.getContext("2d"));return i.drawImage(t,0,0,n,r),i.translate(0,2*r),i.scale(1,-1),i.drawImage(t,0,0,n,r),e},Lo=function(t){var e=document.createElement("canvas"),n=t.width,r=t.height,i=(e.width=2*n,e.height=2*r,e.getContext("2d"));return i.drawImage(t,0,0,n,r),i.setTransform(-1,0,0,-1,e.width,e.height),i.drawImage(t,0,0,n,r),i.setTransform(-1,0,0,1,e.width,0),i.drawImage(t,0,0,n,r),i.setTransform(1,0,0,-1,0,e.height),i.drawImage(t,0,0,n,r),e},Bo=function(t,e){var n=t.width,r=t.height,i=document.createElement("canvas"),s=(i.width=3*n,i.height=3*r,i.getContext("2d")),o=(e=null!=e.angle?-e.angle:-20,Ki.toRad(e)),a=i.width/4,l=i.height/4;for(let h=0;h<4;h+=1)for(let e=0;e<4;e+=1)0<(h+e)%2&&(s.setTransform(1,0,0,1,(2*h-1)*a,(2*e-1)*l),s.rotate(o),s.drawImage(t,-n/2,-r/2,n,r));return i};function Ro(t,e){return null!=t?t:e}function Do(t,e){return null!=t&&Number.isFinite(t)?t:e}function Io(t={}){var e=Ro(t.color,"blue"),n=Do(t.width,1),r=Do(t.margin,2);return`\n    <filter>\n      <feFlood flood-color="${e}" flood-opacity="${Do(t.opacity,1)}" result="colored"/>\n      <feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="${r+n}" />\n      <feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="${r}" />\n      <feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/>\n      <feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/>\n      <feMerge>\n        <feMergeNode in="outline"/>\n        <feMergeNode in="SourceGraphic"/>\n      </feMerge>\n    </filter>\n  `.trim()}function Vo(t={}){var e=Ro(t.color,"red"),n=Do(t.blur,0),r=Do(t.width,1);return`\n      <filter>\n        <feFlood flood-color="${e}" flood-opacity="${Do(t.opacity,1)}" result="colored"/>\n        <feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="${r}"/>\n        <feComposite result="composed" in="colored" in2="morphed" operator="in"/>\n        <feGaussianBlur result="blured" in="composed" stdDeviation="${n}"/>\n        <feBlend in="SourceGraphic" in2="blured" mode="normal"/>\n      </filter>\n    `.trim()}function zo(t={}){var e=Do(t.x,2);return`\n    <filter>\n      <feGaussianBlur stdDeviation="${null!=t.y&&Number.isFinite(t.y)?[e,t.y]:e}"/>\n    </filter>\n  `.trim()}function Fo(t={}){var e=Do(t.dx,0),n=Do(t.dy,0),r=Ro(t.color,"black"),i=Do(t.blur,4);t=Do(t.opacity,1);return("SVGFEDropShadowElement"in window?`<filter>\n         <feDropShadow stdDeviation="${i}" dx="${e}" dy="${n}" flood-color="${r}" flood-opacity="${t}" />\n       </filter>`:`<filter>\n         <feGaussianBlur in="SourceAlpha" stdDeviation="${i}" />\n         <feOffset dx="${e}" dy="${n}" result="offsetblur" />\n         <feFlood flood-color="${r}" />\n         <feComposite in2="offsetblur" operator="in" />\n         <feComponentTransfer>\n           <feFuncA type="linear" slope="${t}" />\n         </feComponentTransfer>\n         <feMerge>\n           <feMergeNode/>\n           <feMergeNode in="SourceGraphic"/>\n         </feMerge>\n       </filter>`).trim()}function $o(t={}){t=Do(t.amount,1);var e=.7152-.7152*(1-t);return`\n    <filter>\n      <feColorMatrix type="matrix" values="${.2126+.7874*(1-t)} ${e} ${.0722-.0722*(1-t)} 0 0 ${.2126-.2126*(1-t)} ${.7152+.2848*(1-t)} ${.0722-.0722*(1-t)} 0 0 ${.2126-.2126*(1-t)} ${e} ${.0722+.9278*(1-t)} 0 0 0 0 0 1 0"/>\n    </filter>\n  `.trim()}function Go(t={}){return t=Do(t.amount,1),`\n      <filter>\n        <feColorMatrix type="matrix" values="${.393+.607*(1-t)} ${.769-.769*(1-t)} ${.189-.189*(1-t)} 0 0 ${.349-.349*(1-t)} ${.686+.314*(1-t)} ${.168-.168*(1-t)} 0 0 ${.272-.272*(1-t)} ${.534-.534*(1-t)} ${.131+.869*(1-t)} 0 0 0 0 0 1 0"/>\n      </filter>\n    `.trim()}function qo(t={}){return`\n      <filter>\n        <feColorMatrix type="saturate" values="${1-Do(t.amount,1)}"/>\n      </filter>\n    `.trim()}function Ho(t={}){return`\n      <filter>\n        <feColorMatrix type="hueRotate" values="${Do(t.angle,0)}"/>\n      </filter>\n    `.trim()}function Zo(t={}){t=Do(t.amount,1);var e=1-t;return`\n      <filter>\n        <feComponentTransfer>\n          <feFuncR type="table" tableValues="${t} ${e}"/>\n          <feFuncG type="table" tableValues="${t} ${e}"/>\n          <feFuncB type="table" tableValues="${t} ${e}"/>\n        </feComponentTransfer>\n      </filter>\n    `.trim()}function Uo(t={}){return t=Do(t.amount,1),`\n    <filter>\n      <feComponentTransfer>\n        <feFuncR type="linear" slope="${t}"/>\n        <feFuncG type="linear" slope="${t}"/>\n        <feFuncB type="linear" slope="${t}"/>\n      </feComponentTransfer>\n    </filter>\n  `.trim()}function Jo(t={}){t=Do(t.amount,1);var e=.5-t/2;return`\n    <filter>\n     <feComponentTransfer>\n        <feFuncR type="linear" slope="${t}" intercept="${e}"/>\n        <feFuncG type="linear" slope="${t}" intercept="${e}"/>\n        <feFuncB type="linear" slope="${t}" intercept="${e}"/>\n      </feComponentTransfer>\n    </filter>\n  `.trim()}(Zt=ys=ys||{}).presets=Object.assign({},a),Zt.presets["flip-x"]=ko,Zt.presets["flip-y"]=jo,Zt.presets["flip-xy"]=Lo,Zt.registry=Eo.create({type:"background pattern"}),Zt.registry.register(Zt.presets,!0),(Ce=bs=bs||{}).presets=l,Ce.registry=Eo.create({type:"filter"}),Ce.registry.register(Ce.presets,!0);const Wo={xlinkHref:"xlink:href",xlinkShow:"xlink:show",xlinkRole:"xlink:role",xlinkType:"xlink:type",xlinkArcrole:"xlink:arcrole",xlinkTitle:"xlink:title",xlinkActuate:"xlink:actuate",xmlSpace:"xml:space",xmlBase:"xml:base",xmlLang:"xml:lang",preserveAspectRatio:"preserveAspectRatio",requiredExtension:"requiredExtension",requiredFeatures:"requiredFeatures",systemLanguage:"systemLanguage",externalResourcesRequired:"externalResourceRequired"},Xo={},Yo={position:ba("x","width","origin")},_o={position:ba("y","height","origin")},Ko={position:ba("x","width","corner")},Qo={position:ba("y","height","corner")},ta={set:xa("width","width")},ea={set:xa("height","height")},na={set:xa("rx","width")},ra={set:xa("ry","height")},ia={set:(()=>{const t=xa("r","width"),e=xa("r","height");return function(n,r){var i=r.refBBox;return M(i.height>i.width?t:e,this,n,r)}})()},sa={set(t,{refBBox:e}){let n,r=parseFloat(t);return t=nn(t),t&&(r/=100),e=Math.sqrt(e.height*e.height+e.width*e.width),{r:n=Number.isFinite(r)?t||0<=r&&r<=1?r*e:Math.max(r+e,0):n}}},oa={set:xa("cx","width")},aa={set:xa("cy","height")},la={set:Ca({resetOffset:!0})},ha={set:Ca({resetOffset:!1})},ua={set:Pa({resetOffset:!0})},ca={set:Pa({resetOffset:!1})},ga=ia,da=la,pa=ua,fa=Yo,ma=_o,va=ta,ya=ea;function ba(t,e,n){return(r,{refBBox:i})=>{if(null==r)return null;let s=parseFloat(r);var o;r=nn(r);let a;return r&&(s/=100),Number.isFinite(s)&&(o=i[n],a=r||0<s&&s<1?o[t]+i[e]*s:o[t]+s),r=new Js,r[t]=a||0,r}}function xa(t,e){return function(n,{refBBox:r}){let i=parseFloat(n);n=nn(n);var s=(n&&(i/=100),{});return Number.isFinite(i)&&(n=n||0<=i&&i<=1?i*r[e]:Math.max(i+r[e],0),s[t]=n),s}}function wa(t,e){const n=e&&e.resetOffset;return function(e,{elem:r,refBBox:i}){let s=Zr(r,"x6-shape");s&&s.value===e||(o=t(e),Zr(r,"x6-shape",s={value:e,shape:o,shapeBBox:o.bbox()}));r=s.shape.clone(),e=s.shapeBBox.clone();var o=e.getOrigin(),a=i.getOrigin(),l=(a=(e.x=a.x,e.y=a.y,i.getMaxScaleToFit(e,a)),0===e.width||0===i.width?1:a.sx);e=0===e.height||0===i.height?1:a.sy;return r.scale(l,e,o),n&&r.translate(-o.x,-o.y),r}}function Ca(t){const e=wa((function(t){return Po.parse(t)}),t);return(t,n)=>({d:e(t,n).serialize()})}function Pa(t){const e=wa((t=>new lo(t)),t);return(t,n)=>({points:e(t,n).serialize()})}const Aa={qualify:X.Z,set(t,{view:e}){return`url(#${e.graph.defineGradient(t)})`}},Ea={qualify:X.Z,set(t,{view:e}){var n,r,i=e.cell;t=Object.assign({},t);return i.isEdge()&&"linearGradient"===t.type&&(n=e.sourcePoint,r=e.targetPoint,t.id=`gradient-${t.type}-`+i.id,t.attrs=Object.assign(Object.assign({},t.attrs),{x1:n.x,y1:n.y,x2:r.x,y2:r.y,gradientUnits:"userSpaceOnUse"}),e.graph.defs.remove(t.id)),`url(#${e.graph.defineGradient(t)})`}},Ma={qualify(t,{attrs:e}){return null==e.textWrap||!X.Z(e.textWrap)},set(t,{view:e,elem:n,attrs:r}){var i=Zr(n,"x6-text"),s=e=>{try{return JSON.parse(e)}catch(t){return e}},o=(s={x:r.x,eol:r.eol,annotations:s(r.annotations),textPath:s(r["text-path"]||r.textPath),textVerticalAnchor:r["text-vertical-anchor"]||r.textVerticalAnchor,displayEmpty:"true"===(r["display-empty"]||r.displayEmpty),lineHeight:r["line-height"]||r.lineHeight},r=r["font-size"]||r.fontSize,JSON.stringify([t,s]));r&&n.setAttribute("font-size",r),null!=i&&i===o||(null!=(r=s.textPath)&&"object"==typeof r&&"string"==typeof(i=r.selector)&&(e=e.find(i)[0])instanceof SVGPathElement&&(Bn(e),s.textPath=Object.assign({"xlink:href":"#"+e.id},r)),ti(n,""+t,s),Zr(n,"x6-text",o))}},Sa={qualify:X.Z,set(t,{view:e,elem:n,attrs:r,refBBox:i}){var s=t.width||0;nn(s)?i.width*=parseFloat(s)/100:s<=0?i.width+=s:i.width=s,s=t.height||0;nn(s)?i.height*=parseFloat(s)/100:s<=0?i.height+=s:i.height=s;let o,a=t.text;null==a&&(a=r.text||(null==n?void 0:n.textContent)),o=null!=a?ri(""+a,i,{"font-weight":r["font-weight"]||r.fontWeight,"font-size":r["font-size"]||r.fontSize,"font-family":r["font-family"]||r.fontFamily,lineHeight:r.lineHeight},{ellipsis:t.ellipsis}):"",M(Ma.set,this,o,{view:e,elem:n,attrs:r,refBBox:i,cell:e.cell})}};fe=(t,{attrs:e})=>void 0!==e.text;const Oa={qualify:fe},Ta={qualify:fe},Na={qualify:fe},ka={qualify:fe},ja={qualify:fe},La={qualify:fe},Ba={qualify(t,{elem:e}){return e instanceof SVGElement},set(t,{elem:e}){t=""+t;var n,r=Zr(e,"x6-title");null!=r&&r===t||(Zr(e,"x6-title",t),(r=e.firstChild)&&"TITLE"===r.tagName.toUpperCase()?r.textContent=t:((n=document.createElementNS(e.namespaceURI,"title")).textContent=t,e.insertBefore(n,r)))}},Ra={offset:Va("x","width","right")},Da={offset:Va("y","height","bottom")},Ia={offset(t,{refBBox:e}){return t?{x:-e.x,y:-e.y}:{x:0,y:0}}};function Va(t,e,n){return(r,{refBBox:i})=>{var s=new Js;let o;return o="middle"===r?i[e]/2:r===n?i[e]:"number"==typeof r&&Number.isFinite(r)?-1<r&&r<1?-i[e]*r:-r:nn(r)?i[e]*parseFloat(r)/100:0,s[t]=-(i[t]+o),s}}const za={qualify:X.Z,set(t,{elem:e}){$r(e,t)}},Fa={set(t,{elem:e}){e.innerHTML=""+t}},$a={qualify:X.Z,set(t,{view:e}){return`url(#${e.graph.defineFilter(t)})`}},Ga={set(t){return null!=t&&"object"==typeof t&&t.id?t.id:t}};function qa(t,e,n){let r,i;if(i="object"==typeof e?(r=e.x,e.y):(r=e,n),e=Po.parse(t),n=e.bbox(),n){let t=-n.height/2-n.y,s=-n.width/2-n.x;"number"==typeof r&&(s-=r),"number"==typeof i&&(t-=i),e.translate(s,t)}return e.serialize()}var Ha=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const Za=t=>{var{size:e,width:n,height:r,offset:i,open:s}=t;return Ja({size:e,width:n,height:r,offset:i},!0===s,!0,void 0,Ha(t,["size","width","height","offset","open"]))},Ua=t=>{var{size:e,width:n,height:r,offset:i,factor:s}=t;return Ja({size:e,width:n,height:r,offset:i},!1,!1,s,Ha(t,["size","width","height","offset","factor"]))};function Ja(t,e,n,r=.75,i={}){var s=t.size||10,o=t.width||s,a=(s=t.height||s,new Po),l={};return e?(a.moveTo(o,0).lineTo(0,s/2).lineTo(o,s),l.fill="none"):(a.moveTo(0,s/2),a.lineTo(o,0),n||(e=en(r,0,1),a.lineTo(o*e,s/2)),a.lineTo(o,s),a.close()),Object.assign(Object.assign(Object.assign({},l),i),{tagName:"path",d:qa(a.serialize(),{x:null!=t.offset?t.offset:-o/2})})}var Wa=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const Xa=t=>{var{size:e,width:n,height:r,offset:i}=t,n=(t=Wa(t,["size","width","height","offset"]),e=e||10,n||e),r=r||e,e=new Po;return e.moveTo(0,r/2).lineTo(n/2,0).lineTo(n,r/2).lineTo(n/2,r).close(),Object.assign(Object.assign({},t),{tagName:"path",d:qa(e.serialize(),null==i?-n/2:i)})};var Ya=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const _a=t=>{var{d:e,offsetX:n,offsetY:r}=t;t=Ya(t,["d","offsetX","offsetY"]);return Object.assign(Object.assign({},t),{tagName:"path",d:qa(e,n,r)})};var Ka=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const Qa=t=>{var{size:e,width:n,height:r,offset:i}=t,n=(t=Ka(t,["size","width","height","offset"]),e=e||10,n||e),r=r||e,e=new Po;return e.moveTo(0,0).lineTo(n,r).moveTo(0,r).lineTo(n,0),Object.assign(Object.assign({},t),{tagName:"path",fill:"none",d:qa(e.serialize(),i||-n/2)})};var tl=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const el=t=>{var{width:e,height:n,offset:r,open:i,flip:s}=t;t=tl(t,["width","height","offset","open","flip"]);let o=n||6;return n=e||10,e=!0===i,i=!0===s,s=Object.assign(Object.assign({},t),{tagName:"path"}),i&&(o=-o),t=new Po,t.moveTo(0,o).lineTo(n,0),e?s.fill="none":(t.lineTo(n,o),t.close()),s.d=qa(t.serialize(),{x:r||-n/2,y:o/2}),s};var nl=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const rl=t=>{var e=t["r"];t=nl(t,["r"]),e=e||5;return Object.assign(Object.assign({cx:e},t),{tagName:"circle",r:e})},il=t=>{var e=t["r"],n=(t=nl(t,["r"]),e=e||5,new Po);return n.moveTo(e,0).lineTo(e,2*e),n.moveTo(0,e).lineTo(2*e,e),{children:[Object.assign(Object.assign({},rl({r:e})),{fill:"none"}),Object.assign(Object.assign({},t),{tagName:"path",d:qa(n.serialize(),-e)})]}};var sl,ol=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const al=t=>{var{rx:e,ry:n}=t,e=(t=ol(t,["rx","ry"]),e||5),n=n||5;return Object.assign(Object.assign({cx:e},t),{tagName:"ellipse",rx:e,ry:n})};(Pe=sl=sl||{}).presets=h,Pe.registry=Eo.create({type:"marker"}),Pe.registry.register(Pe.presets,!0),(sl=sl||{}).normalize=qa;var ll=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};function hl(t){return"string"==typeof t||X.Z(t)}const ul={qualify:hl,set(t,{view:e,attrs:n}){return dl("marker-start",t,e,n)}},cl={qualify:hl,set(t,{view:e,attrs:n}){return dl("marker-end",t,e,n,{transform:"rotate(180)"})}},gl={qualify:hl,set(t,{view:e,attrs:n}){return dl("marker-mid",t,e,n)}};function dl(t,e,n,r,i={}){e="string"==typeof e?{name:e}:e;var{name:s,args:o}=e;e=ll(e,["name","args"]);let a=e;if(s&&"string"==typeof s){var l=sl.registry.get(s);if(!l)return sl.registry.onNotFound(s);a=l(Object.assign(Object.assign({},e),o))}return s=Object.assign(Object.assign(Object.assign({},function(t,e){var n={},r=t.stroke;"string"==typeof r&&(n.stroke=r,n.fill=r);let i=t.strokeOpacity;return null==i&&(i=t["stroke-opacity"]),null==i&&(i=t.opacity),null!=i&&(n["stroke-opacity"]=i,n["fill-opacity"]=i),"marker-mid"!==e&&(r=parseFloat(t.strokeWidth||t["stroke-width"]),Number.isFinite(r))&&1<r&&(t=Math.ceil(r/2),n.refX="marker-start"===e?t:-t),n}(r,t)),i),a),{[t]:`url(#${n.graph.defineMarker(s)})`}}var pl,fl,ml,vl;Ae=(t,{view:e})=>e.cell.isEdge();const yl={qualify:Ae,set(t,e){e=e.view;var n=t.reverse||!1;t=t.stubs||0;let r;if(Number.isFinite(t)&&0!==t)if(n){let i,s;n=e.getConnectionLength()||0,n=(s=t<0?(i=(n+t)/2,-t):n-2*(i=t),e.getConnection());r=null==(n=null==(n=null==(n=null==(n=null==n?void 0:n.divideAtLength(i))?void 0:n[1])?void 0:n.divideAtLength(s))?void 0:n[0])?void 0:n.serialize()}else{let i;i=t<0?((e.getConnectionLength()||0)+t)/2:t,n=e.getConnection(),n&&(t=n.divideAtLength(i),n=n.divideAtLength(-i),t)&&n&&(r=t[0].serialize()+" "+n[1].serialize())}return{d:r||e.getConnectionPathData()}}},bl={qualify:Ae,set:El("getTangentAtLength",{rotate:!0})},xl={qualify:Ae,set:El("getTangentAtLength",{rotate:!1})},wl={qualify:Ae,set:El("getTangentAtRatio",{rotate:!0})},Cl={qualify:Ae,set:El("getTangentAtRatio",{rotate:!1})},Pl=bl,Al=wl;function El(t,e){const n={x:1,y:0};return(r,i)=>{let s,o;return i=i.view,r=i[t](Number(r)),r?(o=e.rotate?r.vector().vectorAngle(n):0,s=r.start):(s=i.path.start,o=0),0===o?{transform:`translate(${s.x},${s.y}')`}:{transform:`translate(${s.x},${s.y}') rotate(${o})`}}}(pl||(pl={})).isValidDefinition=function(t,e,n){if(null!=t){if("string"==typeof t)return!0;if("function"!=typeof t.qualify||M(t.qualify,this,e,n))return!0}return!1},(ye=pl=pl||{}).presets=Object.assign(Object.assign({},Wo),u),ye.registry=Eo.create({type:"attribute definition"}),ye.registry.register(ye.presets,!0);const Ml={prefixCls:"x6",autoInsertCSS:!0,useCSSSelector:!0,prefix(t){return Ml.prefixCls+"-"+t}},Sl=Ml.prefix("highlighted"),Ol={highlight(t,e,n){Tn(e,n&&n.className||Sl)},unhighlight(t,e,n){Nn(e,n&&n.className||Sl)}},Tl=Ml.prefix("highlight-opacity"),Nl={highlight(t,e){Tn(e,Tl)},unhighlight(t,e){Nn(e,Tl)}};function kl(t,e){return t=Ci(t.x,t.y).matrixTransform(e),new Js(t.x,t.y)}function jl(t,e){var n=Fn("svg").createSVGPoint(),r=(n.x=t.x,n.y=t.y,n.matrixTransform(e)),i=(n.x=t.x+t.width,n.y=t.y,n.matrixTransform(e)),s=(n.x=t.x+t.width,n.y=t.y+t.height,n.matrixTransform(e)),o=(t=(n.x=t.x,n.y=t.y+t.height,n.matrixTransform(e)),n=Math.min(r.x,i.x,s.x,t.x),e=Math.max(r.x,i.x,s.x,t.x),Math.min(r.y,i.y,s.y,t.y));r=Math.max(r.y,i.y,s.y,t.y);return new _s(n,o,e-n,r-o)}function Ll(t,e={}){let n;var r,i,s,o;if(!t.ownerSVGElement||!Rn(t))return rr(t)?(({left:o,top:r,width:i,height:s}=Bl(t)),new _s(o,r,i,s)):new _s(0,0,0,0);let a=e.target;if(!e.recursive){try{n=t.getBBox()}catch(e){n={x:t.clientLeft,y:t.clientTop,width:t.clientWidth,height:t.clientHeight}}return a?(o=Ii(t,a),jl(n,o)):_s.create(n)}var l=t.childNodes,h=l.length;if(0===h)return Ll(t,{target:a});a=a||t;for(let c=0;c<h;c+=1){var u=l[c];let t;t=0===u.childNodes.length?Ll(u,{target:a}):Ll(u,{target:a,recursive:!0}),n=n?n.union(t):t}return n}function Bl(t){let e=0,n=0,r=0,i=0;if(t){let s=t;for(;s;)e+=s.offsetLeft,n+=s.offsetTop,(s=s.offsetParent)&&(e+=parseInt(Br(s,"borderLeft"),10),n+=parseInt(Br(s,"borderTop"),10));r=t.offsetWidth,i=t.offsetHeight}return{left:e,top:n,width:r,height:i}}function Rl(t){var e=e=>(e=t.getAttribute(e),e=e?parseFloat(e):0,Number.isNaN(e)?0:e);switch(t instanceof SVGElement&&t.nodeName.toLowerCase()){case"rect":return new _s(e("x"),e("y"),e("width"),e("height"));case"circle":return new to(e("cx"),e("cy"),e("r"),e("r"));case"ellipse":return new to(e("cx"),e("cy"),e("rx"),e("ry"));case"polyline":var n=ci(t);return new lo(n);case"polygon":return n=ci(t),1<n.length&&n.push(n[0]),new lo(n);case"path":{let e=t.getAttribute("d");return Po.isValid(e)||(e=Po.normalize(e)),Po.parse(e)}case"line":return new Qs(e("x1"),e("y1"),e("x2"),e("y2"))}return Ll(t)}function Dl(t){if(null==t)return null;let e=t;do{let t=e.tagName;if("string"!=typeof t)return null;if(t=t.toUpperCase(),On(e,"x6-port"))e=e.nextElementSibling;else if("G"===t)e=e.firstElementChild;else{if("TITLE"!==t)break;e=e.nextElementSibling}}while(e);return e}(we=fl=fl||{}).normalizeMarker=qa,we.transformPoint=kl,we.transformLine=function(t,e){return new Qs(kl(t.start,e),kl(t.end,e))},we.transformPolyline=function(t,e){let n=t instanceof lo?t.points:t;return Array.isArray(n)||(n=[]),new lo(n.map((t=>kl(t,e))))},we.transformRectangle=jl,we.bbox=function(t,e,n){let r;var i=t.ownerSVGElement;if(!i)return new _s(0,0,0,0);try{r=t.getBBox()}catch(e){r={x:t.clientLeft,y:t.clientTop,width:t.clientWidth,height:t.clientHeight}}return e?_s.create(r):(e=Ii(t,n||i),jl(r,e))},we.getBBox=Ll,we.getBoundingOffsetRect=Bl,we.toGeometryShape=Rl,we.translateAndAutoOrient=function(t,e,n,r){e=Js.create(e),n=Js.create(n);var i=(r=r||(t instanceof SVGSVGElement?t:t.ownerSVGElement),Di(t)),s=(t.setAttribute("transform",""),Ll(t,{target:r}).scale(i.sx,i.sy)),o=Ai(),a=(o.setTranslate(-s.x-s.width/2,-s.y-s.height/2),Ai()),l=((l=e.angleBetween(n,e.clone().translate(1,0)))&&a.setRotate(l,0,0),Ai());n=e.clone().move(n,s.width/2),l.setTranslate(2*e.x-n.x,2*e.y-n.y),s=Ii(t,r);(e=Ai()).setMatrix(l.matrix.multiply(a.matrix.multiply(o.matrix.multiply(s.scale(i.sx,i.sy))))),t.setAttribute("transform",Mi(e.matrix))},we.findShapeNode=Dl,we.getBBoxV2=function(t){var e,n,r=Dl(t);return Rn(r)?Rl(r).bbox()||_s.create():rr(t)?(({left:r,top:t,width:e,height:n}=Bl(t)),new _s(r,t,e,n)):new _s(0,0,0,0)};const Il={padding:3,rx:0,ry:0,attrs:{"stroke-width":3,stroke:"#FEB663"}},Vl={highlight(t,e,n){const r=ml.getHighlighterId(e,n);if(!ml.hasCache(r)){n=ut({},n,Il);var i=Wr.create(e);let l,h;try{l=i.toPathData()}catch(r){h=fl.bbox(i.node,!0),l=fi(Object.assign(Object.assign({},n),h))}var s=Fn("path");if(ur(s,Object.assign({d:l,"pointer-events":"none","vector-effect":"non-scaling-stroke",fill:"none"},n.attrs?gr(n.attrs):null)),t.isEdgeElement(e))ur(s,"d",t.getConnectionPathData());else{let r=i.getTransformToElement(t.container);var o;e=n.padding;e&&(n=(h=null==h?fl.bbox(i.node,!0):h).x+h.width/2,i=h.y+h.height/2,h=fl.transformRectangle(h,r),o=Pi({a:a=((a=Math.max(h.width,1))+e)/a,b:0,c:0,d:e=((o=Math.max(h.height,1))+e)/o,e:n-a*n,f:i-e*i}),r=r.multiply(o)),Li(s,r)}Tn(s,Ml.prefix("highlight-stroke"));var a=t.cell;n=()=>ml.removeHighlighter(r);a.on("removed",n),a.model&&a.model.on("reseted",n),t.container.appendChild(s),ml.setCache(r,s)}},unhighlight(t,e,n){ml.removeHighlighter(ml.getHighlighterId(e,n))}};{(xe=ml=ml||{}).getHighlighterId=function(t,e){return Bn(t),t.id+JSON.stringify(e)};const nd={};xe.setCache=function(t,e){nd[t]=e},xe.hasCache=function(t){return null!=nd[t]},xe.removeHighlighter=function(t){var e=nd[t];e&&(Xn(e),delete nd[t])}}function zl(t,e={}){return new Js(rn(e.x,t.width),rn(e.y,t.height))}function Fl(t,e,n){return Object.assign({angle:e,position:t.toJSON()},n)}(vl||(vl={})).check=function(t,e){if("function"!=typeof e.highlight)throw new Error(`Highlighter '${t}' is missing required \`highlight()\` method`);if("function"!=typeof e.unhighlight)throw new Error(`Highlighter '${t}' is missing required \`unhighlight()\` method`)},(be=vl=vl||{}).presets=c,be.registry=Eo.create({type:"highlighter"}),be.registry.register(be.presets,!0);const $l=(t,e)=>t.map((({x:t,y:n,angle:r})=>Fl(zl(e,{x:t,y:n}),r||0))),Gl=(t,e,n)=>{var r=n.start||0;const i=n.step||20;return Hl(t,e,r,((t,e)=>(t+.5-e/2)*i))},ql=(t,e,n)=>{var r=n.start||0;const i=n.step||360/t.length;return Hl(t,e,r,(t=>t*i))};function Hl(t,e,n,r){const i=e.getCenter(),s=e.getTopCenter(),o=e.width/e.height,a=to.fromRect(e),l=t.length;return t.map(((t,e)=>{e=n+r(e,l),e=s.clone().rotate(-e,i).scale(o,1,i);var h=t.compensateRotate?-a.tangentTheta(e):0;return(t.dx||t.dy)&&e.translate(t.dx||0,t.dy||0),t.dr&&e.move(i,t.dr),Fl(e.round(),h,t)}))}var Zl,Ul,Jl,Wl,Xl,Yl=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const _l=(t,e,n)=>nh(t,zl(e,n.start||e.getOrigin()),zl(e,n.end||e.getCorner()),n),Kl=(t,e,n)=>nh(t,e.getTopLeft(),e.getBottomLeft(),n),Ql=(t,e,n)=>nh(t,e.getTopRight(),e.getBottomRight(),n),th=(t,e,n)=>nh(t,e.getTopLeft(),e.getTopRight(),n),eh=(t,e,n)=>nh(t,e.getBottomLeft(),e.getBottomRight(),n);function nh(t,e,n,r){const i=new Qs(e,n),s=t.length;return t.map(((t,e)=>{var n=t["strict"];t=Yl(t,["strict"]),n=n||r.strict?(e+1)/(s+1):(e+.5)/s,e=i.pointAt(n);return(t.dx||t.dy)&&e.translate(t.dx||0,t.dy||0),Fl(e.round(),0,t)}))}(pe=Zl=Zl||{}).presets=g,pe.registry=Eo.create({type:"port layout"}),pe.registry.register(pe.presets,!0);const rh={position:{x:0,y:0},angle:0,attrs:{".":{y:"0","text-anchor":"start"}}};function ih(t,e){var{x:e,y:n,angle:r,attrs:i}=e||{};return ut({},{angle:r,attrs:i,position:{x:e,y:n}},t,rh)}const sh=(t,e,n)=>ih({position:e.getTopLeft()},n),oh=(t,e,n)=>ih({position:{x:-15,y:0},attrs:{".":{y:".3em","text-anchor":"end"}}},n),ah=(t,e,n)=>ih({position:{x:15,y:0},attrs:{".":{y:".3em","text-anchor":"start"}}},n),lh=(t,e,n)=>ih({position:{x:0,y:-15},attrs:{".":{"text-anchor":"middle"}}},n),hh=(t,e,n)=>ih({position:{x:0,y:15},attrs:{".":{y:".6em","text-anchor":"middle"}}},n),uh=(t,e,n)=>ph(t,e,!1,n),ch=(t,e,n)=>ph(t,e,!0,n),gh=(t,e,n)=>fh(t,e,!1,n),dh=(t,e,n)=>fh(t,e,!0,n);function ph(t,e,n,r){var i=null!=r.offset?r.offset:15;t=e.getCenter().theta(t),e=mh(e);let s,o,a,l,h=0;return l=t<e[1]||t>e[2]?(s=".3em",o=i,a=0,"start"):t<e[0]?(s="0",o=0,a=-i,n?(h=-90,"start"):"middle"):t<e[3]?(s=".3em",o=-i,a=0,"end"):(s=".6em",o=0,a=i,n?(h=90,"start"):"middle"),ih({position:{x:Math.round(o),y:Math.round(a)},angle:h,attrs:{".":{y:s,"text-anchor":l}}},r)}function fh(t,e,n,r){var i=null!=r.offset?r.offset:15;t=e.getCenter().theta(t),e=mh(e);let s,o,a,l,h=0;return l=t<e[1]||t>e[2]?(s=".3em",o=-i,a=0,"end"):t<e[0]?(s=".6em",o=0,a=i,n?(h=90,"start"):"middle"):t<e[3]?(s=".3em",o=i,a=0,"start"):(s="0em",o=0,a=-i,n?(h=-90,"start"):"middle"),ih({position:{x:Math.round(o),y:Math.round(a)},angle:h,attrs:{".":{y:s,"text-anchor":l}}},r)}function mh(t){var e=t.getCenter(),n=e.theta(t.getTopLeft()),r=e.theta(t.getBottomLeft()),i=e.theta(t.getBottomRight());return[n,e.theta(t.getTopRight()),i,r]}const vh=(t,e,n)=>bh(t.diff(e.getCenter()),!1,n),yh=(t,e,n)=>bh(t.diff(e.getCenter()),!0,n);function bh(t,e,n){var r=null!=n.offset?n.offset:20,i=new Js(0,0),s=-t.theta(i);i=t.clone().move(i,r).diff(t).round();let o,a=".3em",l=s;return(90+s)%180==0?(o=e?"end":"middle",e||-270!=s||(a="0em")):-270<s&&s<-90?(o="start",l=s-180):o="end",ih({position:i.round().toJSON(),angle:e?l:0,attrs:{".":{y:a,"text-anchor":o}}},n)}(me=Ul=Ul||{}).presets=d,me.registry=Eo.create({type:"port label layout"}),me.registry.register(me.presets,!0);class xh extends yt{get priority(){return 2}get disposeContainer(){return!0}constructor(){super(),this.cid=Wl.uniqueId(),xh.views[this.cid]=this}confirmUpdate(t,e){return 0}empty(t=this.container){return Yn(t),this}unmount(t=this.container){return Xn(t),this}remove(t=this.container){return t===this.container&&(this.removeEventListeners(document),this.onRemove(),delete xh.views[this.cid],!this.disposeContainer)||this.unmount(t),this}onRemove(){}setClass(t,e=this.container){e.classList.value=Array.isArray(t)?t.join(" "):t}addClass(t,e=this.container){return Tn(e,Array.isArray(t)?t.join(" "):t),this}removeClass(t,e=this.container){return Nn(e,Array.isArray(t)?t.join(" "):t),this}setStyle(t,e=this.container){return $r(e,t),this}setAttrs(t,e=this.container){return null!=t&&null!=e&&ur(e,t),this}findAttr(t,e=this.container){let n=e;for(;n&&1===n.nodeType;){var r=n.getAttribute(t);if(null!=r)return r;if(n===this.container)return null;n=n.parentNode}return null}find(t,e=this.container,n=this.selectors){return xh.find(t,e,n).elems}findOne(t,e=this.container,n=this.selectors){return t=this.find(t,e,n),0<t.length?t[0]:null}findByAttr(t,e=this.container){let n=e;for(;n&&n.getAttribute;){var r=n.getAttribute(t);if((null!=r||n===this.container)&&"false"!==r)return n;n=n.parentNode}return null}getSelector(t,e){let n;var r;return t===this.container?n="string"==typeof e?"> "+e:n:(t&&(r=Hn(t)+1,n=t.tagName.toLowerCase()+`:nth-child(${r})`,e&&(n+=" > "+e),n=this.getSelector(t.parentNode,n)),n)}prefixClassName(t){return Ml.prefix(t)}delegateEvents(t,e){if(null!=t){e||this.undelegateEvents();const n=/^(\S+)\s*(.*)$/;Object.keys(t).forEach((e=>{var r=e.match(n);null!=r&&"function"==typeof(e=this.getEventHandler(t[e]))&&this.delegateEvent(r[1],r[2],e)}))}return this}undelegateEvents(){return qi.off(this.container,this.getEventNamespace()),this}delegateDocumentEvents(t,e){return this.addEventListeners(document,t,e),this}undelegateDocumentEvents(){return this.removeEventListeners(document),this}delegateEvent(t,e,n){return qi.on(this.container,t+this.getEventNamespace(),e,n),this}undelegateEvent(t,e,n){return t+=this.getEventNamespace(),null==e?qi.off(this.container,t):"string"==typeof e?qi.off(this.container,t,e,n):qi.off(this.container,t,e),this}addEventListeners(t,e,n){if(null!=e){const r=this.getEventNamespace();Object.keys(e).forEach((i=>{var s=this.getEventHandler(e[i]);"function"==typeof s&&qi.on(t,i+r,n,s)}))}return this}removeEventListeners(t){return null!=t&&qi.off(t,this.getEventNamespace()),this}getEventNamespace(){return`.${Ml.prefixCls}-event-`+this.cid}getEventHandler(t){let e;if("string"==typeof t){const n=this[t];"function"==typeof n&&(e=(...t)=>n.call(this,...t))}else e=(...e)=>t.call(this,...e);return e}getEventTarget(t,e={}){var{target:t,type:n,clientX:r=0,clientY:i=0}=t;return e.fromPoint||"touchmove"===n||"touchend"===n?document.elementFromPoint(r,i):t}stopPropagation(t){return this.setEventData(t,{propagationStopped:!0}),this}isPropagationStopped(t){return!0===this.getEventData(t).propagationStopped}getEventData(t){return this.eventData(t)}setEventData(t,e){return this.eventData(t,e)}eventData(t,e){if(null==t)throw new TypeError("Event object required");let n=t.data;var r=`__${this.cid}__`;return null==e?null!=n&&n[r]||{}:(null==(n=null==n?t.data={}:n)[r]?n[r]=Object.assign({},e):n[r]=Object.assign(Object.assign({},n[r]),e),n[r])}normalizeEvent(t){return xh.normalizeEvent(t)}dispose(){this.remove()}}(function(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(o=(s<3?i(o):3<s?i(e,n,o):i(e,n))||o);3<s&&o&&Object.defineProperty(e,n,o)})([xh.dispose()],xh.prototype,"dispose",null),(ve=xh=xh||{}).createElement=function(t,e){return e?Fn(t||"g"):zn(t||"div")},ve.find=function(t,e,n){return t&&"."!==t?n&&(n=n[t],n)?{elems:Array.isArray(n)?n:[n]}:Ml.useCSSSelector?(n=t.includes(">")?":scope "+t:t,{isCSSSelector:!0,elems:Array.prototype.slice.call(e.querySelectorAll(n))}):{elems:[]}:{elems:[e]}},ve.normalizeEvent=function(t){let e=t;var n=t.originalEvent,r=n&&n.changedTouches&&n.changedTouches[0];if(r){for(const e in t)void 0===r[e]&&(r[e]=t[e]);e=r}return e},(Jl=xh=xh||{}).views={},Jl.getView=function(t){return Jl.views[t]||null};{e=Wl=Wl||{};let rd=0;e.uniqueId=function(){var t="v"+rd;return rd+=1,t}}class wh{constructor(t){this.view=t,this.clean()}clean(){this.elemCache&&this.elemCache.dispose(),this.elemCache=new zs,this.pathCache={}}get(t){return this.elemCache.has(t)||this.elemCache.set(t,{}),this.elemCache.get(t)}getData(t){return t=this.get(t),t.data||(t.data={}),t.data}getMatrix(t){var e,n=this.get(t);return null==n.matrix&&(e=this.view.container,n.matrix=Vi(t,e)),Pi(n.matrix)}getShape(t){var e=this.get(t);return null==e.shape&&(e.shape=fl.toGeometryShape(t)),e.shape.clone()}getBoundingRect(t){var e=this.get(t);return null==e.boundingRect&&(e.boundingRect=fl.getBBoxV2(t)),e.boundingRect.clone()}}function Ch(t){return null!=t&&"string"==typeof t}function Ph(t,e={ns:Dn.svg}){var n=document.createDocumentFragment();const r={},i={},s=[{markup:Array.isArray(t)?t:[t],parent:n,ns:e.ns}];for(;0<s.length;){var o=s.pop();let t=o.ns||Dn.svg;var a=o.markup;const e=o.parent;a.forEach((n=>{var o=n.tagName;if(!o)throw new TypeError("Invalid tagName");const a=(t=n.ns?n.ns:t)?zn(o,t):Vn(o);if(o=n.attrs,o&&ur(a,gr(o)),o=n.style,o&&$r(a,o),o=n.className,null!=o&&a.setAttribute("class",Array.isArray(o)?o.join(" "):o),n.textContent&&(a.textContent=n.textContent),o=n.selector,null!=o){if(i[o])throw new TypeError("Selector must be unique");i[o]=a}if(n.groupSelector){let t=n.groupSelector;(t=Array.isArray(t)?t:[t]).forEach((t=>{r[t]||(r[t]=[]),r[t].push(a)}))}e.appendChild(a),o=n.children,Array.isArray(o)&&s.push({ns:t,markup:o,parent:a})}))}return Object.keys(r).forEach((t=>{if(i[t])throw new Error("Ambiguous group selector");i[t]=r[t]})),{fragment:n,selectors:i,groups:r}}function Ah(t){return t instanceof SVGElement?Fn("g"):Vn("div")}(K=Xl=Xl||{}).isJSONMarkup=function(t){return null!=t&&!Ch(t)},K.isStringMarkup=Ch,K.clone=function(t){return null==t||Ch(t)?t:_.Z(t)},K.sanitize=function(t){return(""+t).trim().replace(/[\r|\n]/g," ").replace(/>\s+</g,"><")},K.parseJSONMarkup=Ph,K.renderMarkup=function(t){if(Ch(t)){var e=Wr.createVectors(t),n=e.length;if(1===n)return{elem:e[0].node};if(1<n){const t=Ah(e[0].node);return e.forEach((e=>{t.appendChild(e.node)})),{elem:t}}return{}}n=Ph(t),e=n.fragment;let r=null;return 1<e.childNodes.length?(r=Ah(e.firstChild)).appendChild(e):r=e.firstChild,{elem:r,selectors:n.selectors}},K.parseLabelStringMarkup=function(t){var e=Wr.createVectors(t),n=document.createDocumentFragment();for(let i=0,s=e.length;i<s;i+=1){var r=e[i].node;n.appendChild(r)}return{fragment:n,selectors:{}}},(Xl||(Xl={})).getSelector=function t(e,n,r){if(null==e)return r;{let o;var i,s=e.tagName.toLowerCase();return e===n?o="string"==typeof r?`> ${s} > `+r:"> "+s:(i=e.parentNode,o=i&&1<i.childNodes.length?s+`:nth-child(${Hn(e)+1})`:s,r&&(o+=" > "+r),t(e.parentNode,n,o))}},(a=Xl=Xl||{}).getPortContainerMarkup=function(){return"g"},a.getPortMarkup=function(){return{tagName:"circle",selector:"circle",attrs:{r:10,fill:"#FFFFFF",stroke:"#000000"}}},a.getPortLabelMarkup=function(){return{tagName:"text",selector:"text",attrs:{fill:"#000000"}}},(Xl||(Xl={})).getEdgeMarkup=function(){return[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}]},(Xl||(Xl={})).getForeignObjectMarkup=function(t=!1){return{tagName:"foreignObject",selector:"fo",children:[{ns:Dn.xhtml,tagName:"body",selector:"foBody",attrs:{xmlns:Dn.xhtml},style:{width:"100%",height:"100%",background:"transparent"},children:t?[]:[{tagName:"div",selector:"foContent",style:{width:"100%",height:"100%"}}]}]}};class Eh{constructor(t){this.view=t}get cell(){return this.view.cell}getDefinition(t){return this.cell.getAttrDefinition(t)}processAttrs(t,e){let n,r,i,s;const o=[];return Object.keys(e).forEach((r=>{var i=e[r],s=this.getDefinition(r),a=M(pl.isValidDefinition,this.view,s,i,{elem:t,attrs:e,cell:this.cell,view:this.view});s&&a?"string"==typeof s?(n=null==n?{}:n)[s]=i:null!==i&&o.push({name:r,definition:s}):(null==n&&(n={}),a=sr.includes(r)?r:He(r),n[a]=i)})),o.forEach((({name:t,definition:n})=>{var o=e[t],a=("function"==typeof n.set&&((r=null==r?{}:r)[t]=o),n);"function"==typeof a.offset&&((i=null==i?{}:i)[t]=o),a=n;"function"==typeof a.position&&((s=null==s?{}:s)[t]=o)})),{raw:e,normal:n,set:r,offset:i,position:s}}mergeProcessedAttrs(t,e){t.set=Object.assign(Object.assign({},t.set),e.set),t.position=Object.assign(Object.assign({},t.position),e.position),t.offset=Object.assign(Object.assign({},t.offset),e.offset);var n=t.normal&&t.normal.transform;null!=n&&e.normal&&(e.normal.transform=n),t.normal=e.normal}findAttrs(t,e,n,r){const i=[],s=new zs;return Object.keys(t).forEach((o=>{var a=t[o];if(X.Z(a)){var{isCSSSelector:l,elems:h}=xh.find(o,e,r);for(let t=0,e=(n[o]=h).length;t<e;t+=1){var u,c,g=h[t],d=r&&r[o]===g,p=s.get(g);p?(p.array||(i.push(g),p.array=!0,p.attrs=[p.attrs],p.priority=[p.priority]),u=p.attrs,p=p.priority,d?(u.unshift(a),p.unshift(-1)):(c=Ot(p,l?-1:e),u.splice(c,0,a),p.splice(c,0,e))):s.set(g,{elem:g,attrs:a,priority:d?-1:e,array:!1})}}})),i.forEach((t=>{t=s.get(t);var e=t.attrs;t.attrs=e.reduceRight(((t,e)=>D.Z(t,e)),{})})),s}updateRelativeAttrs(t,e,n){const r=e.raw||{};let i=e.normal||{};const s=e.set,o=e.position,a=e.offset,l=()=>({elem:t,cell:this.cell,view:this.view,attrs:r,refBBox:n.clone()});if(null!=s&&Object.keys(s).forEach((t=>{var e=s[t],n=this.getDefinition(t);null!=n&&("object"==typeof(n=M(n.set,this.view,e,l()))?i=Object.assign(Object.assign({},i),n):null!=n&&(i[t]=n))})),t instanceof HTMLElement)this.view.setAttrs(i,t);else{e=i.transform;var h=Ei(e?""+e:null);const n=new Js(h.e,h.f);e&&(delete i.transform,h.e=0,h.f=0);let s=!1,c=(null!=o&&Object.keys(o).forEach((t=>{var e=o[t];t=this.getDefinition(t);null!=t&&null!=(t=M(t.position,this.view,e,l()))&&(s=!0,n.translate(Js.create(t)))})),this.view.setAttrs(i,t),!1);if(null!=a){var u=this.view.getBoundingRectOfElement(t);if(0<u.width&&0<u.height){const e=fl.transformRectangle(u,h);Object.keys(a).forEach((i=>{var s=a[i];i=this.getDefinition(i);null!=i&&null!=(i=M(i.offset,this.view,s,{elem:t,cell:this.cell,view:this.view,attrs:r,refBBox:e}))&&(c=!0,n.translate(Js.create(i)))}))}}(null!=e||s||c)&&(n.round(1),h.e=n.x,h.f=n.y,t.setAttribute("transform",Mi(h)))}}update(t,e,n){const r={};var i=this.findAttrs(n.attrs||e,t,r,n.selectors);const s=n.attrs?this.findAttrs(e,t,r,n.selectors):i,o=[],a=(i.each((e=>{const i=e.elem;var a=e.attrs,l=this.processAttrs(i,a);if(null==l.set&&null==l.position&&null==l.offset)this.view.setAttrs(l.normal,i);else{const e=s.get(i);var h=e?e.attrs:null;a=(h&&null==a.ref?h:a).ref;let u;if(a){if(!(u=(r[a]||this.view.find(a,t,n.selectors))[0]))throw new Error(`"${a}" reference does not exist.`)}else u=null;a={node:i,refNode:u,attributes:h,processedAttributes:l},h=o.findIndex((t=>t.refNode===i)),-1<h?o.splice(h,0,a):o.push(a)}})),new zs);let l;o.forEach((e=>{var r=e.node,i=e.refNode;let s;var o,h=null!=i&&null!=n.rotatableNode&&Wn(n.rotatableNode,i);(s=i?a.get(i):s)||(o=h?n.rotatableNode:t,s=i?fl.getBBox(i,{target:o}):n.rootBBox,i&&a.set(i,s));let u,c=(n.attrs&&e.attributes?(u=this.processAttrs(r,e.attributes),this.mergeProcessedAttrs(u,e.processedAttributes)):u=e.processedAttributes,s);h&&null!=n.rotatableNode&&!n.rotatableNode.contains(r)&&(l=l||Ei(ur(n.rotatableNode,"transform")),c=fl.transformRectangle(s,l)),this.updateRelativeAttrs(r,u,c)}))}}n(92087);class Mh{get cell(){return this.view.cell}constructor(t,e,n=[]){this.view=t;const r={},i={};let s=0,o=(Object.keys(e).forEach((t=>{let n=e[t];(n=Array.isArray(n)?n:[n]).forEach((e=>{let n=r[e];n||(s+=1,n=r[e]=1<<s),i[t]|=n}))})),n);if((o=Array.isArray(o)?o:[o]).forEach((t=>{r[t]||(s+=1,r[t]=1<<s)})),25<s)throw new Error("Maximum number of flags exceeded.");this.flags=r,this.attrs=i,this.bootstrap=n}getFlag(t){const e=this.flags;return null==e?0:Array.isArray(t)?t.reduce(((t,n)=>t|e[n]),0):0|e[t]}hasAction(t,e){return t&this.getFlag(e)}removeAction(t,e){return t^t&this.getFlag(e)}getBootstrapFlag(){return this.getFlag(this.bootstrap)}getChangedFlag(){let t=0;return this.attrs&&Object.keys(this.attrs).forEach((e=>{this.cell.hasChanged(e)&&(t|=this.attrs[e])})),t}}Zt=function(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(o=(s<3?i(o):3<s?i(e,n,o):i(e,n))||o);return 3<s&&o&&Object.defineProperty(e,n,o),o};var Sh,Oh,Th,Nh,kh=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};class jh extends xh{static getDefaults(){return this.defaults}static config(t){this.defaults=this.getOptions(t)}static getOptions(t){const e=(t,e)=>null!=e?xt([...Array.isArray(t)?t:[t],...Array.isArray(e)?e:[e]]):Array.isArray(t)?[...t]:[t],n=_.Z(this.getDefaults());var{bootstrap:r,actions:i,events:s,documentEvents:o}=t,a=kh(t,["bootstrap","actions","events","documentEvents"]);return r&&(n.bootstrap=e(n.bootstrap,r)),i&&Object.entries(i).forEach((([t,r])=>{var i=n.actions[t];r&&i?n.actions[t]=e(i,r):r&&(n.actions[t]=e(r))})),s&&(n.events=Object.assign(Object.assign({},n.events),s)),t.documentEvents&&(n.documentEvents=Object.assign(Object.assign({},n.documentEvents),o)),D.Z(n,a)}get[Symbol.toStringTag](){return jh.toStringTag}constructor(t,e={}){super(),this.cell=t,this.options=this.ensureOptions(e),this.graph=this.options.graph,this.attr=new Eh(this),this.flag=new Mh(this,this.options.actions,this.options.bootstrap),this.cache=new wh(this),this.setContainer(this.ensureContainer()),this.setup(),this.init()}init(){}onRemove(){this.removeTools()}get priority(){return this.options.priority}get rootSelector(){return this.options.rootSelector}getConstructor(){return this.constructor}ensureOptions(t){return this.getConstructor().getOptions(t)}getContainerTagName(){return this.options.isSvgElement?"g":"div"}getContainerStyle(){}getContainerAttrs(){return{"data-cell-id":this.cell.id,"data-shape":this.cell.shape}}getContainerClassName(){return this.prefixClassName("cell")}ensureContainer(){return xh.createElement(this.getContainerTagName(),this.options.isSvgElement)}setContainer(t){var e;return this.container!==t&&(this.undelegateEvents(),this.container=t,null!=this.options.events&&this.delegateEvents(this.options.events),null!=(e=this.getContainerAttrs())&&this.setAttrs(e,t),null!=(e=this.getContainerStyle())&&this.setStyle(e,t),null!=(e=this.getContainerClassName()))&&this.addClass(e,t),this}isNodeView(){return!1}isEdgeView(){return!1}render(){return this}confirmUpdate(t,e=0){return 0}getBootstrapFlag(){return this.flag.getBootstrapFlag()}getFlag(t){return this.flag.getFlag(t)}hasAction(t,e){return this.flag.hasAction(t,e)}removeAction(t,e){return this.flag.removeAction(t,e)}handleAction(t,e,n,r){return this.hasAction(t,e)?(n(),n=[e],r&&("string"==typeof r?n.push(r):n.push(...r)),this.removeAction(t,n)):t}setup(){this.cell.on("changed",this.onCellChanged,this)}onCellChanged({options:t}){this.onAttrsChange(t)}onAttrsChange(t){let e=this.flag.getChangedFlag();!t.updated&&e&&(t.dirty&&this.hasAction(e,"update")&&(e|=this.getFlag("render")),t.toolId&&(t.async=!1),null!=this.graph)&&this.graph.renderer.requestViewUpdate(this,e,t)}parseJSONMarkup(t,e){t=Xl.parseJSONMarkup(t);var n=t.selectors,r=this.rootSelector;if(e&&r){if(n[r])throw new Error("Invalid root selector");n[r]=e}return t}can(t){let e=this.graph.options.interacting;if("object"!=typeof(e="function"==typeof e?M(e,this.graph,this):e))return"boolean"==typeof e&&e;{let n=e[t];return!1!==(n="function"==typeof n?M(n,this.graph,this):n)}}cleanCache(){return this.cache.clean(),this}getCache(t){return this.cache.get(t)}getDataOfElement(t){return this.cache.getData(t)}getMatrixOfElement(t){return this.cache.getMatrix(t)}getShapeOfElement(t){return this.cache.getShape(t)}getBoundingRectOfElement(t){return this.cache.getBoundingRect(t)}getBBoxOfElement(t){var e=this.getBoundingRectOfElement(t),n=(t=this.getMatrixOfElement(t),this.getRootRotatedMatrix()),r=this.getRootTranslatedMatrix();return fl.transformRectangle(e,r.multiply(n).multiply(t))}getUnrotatedBBoxOfElement(t){var e=this.getBoundingRectOfElement(t),n=(t=this.getMatrixOfElement(t),this.getRootTranslatedMatrix());return fl.transformRectangle(e,n.multiply(t))}getBBox(t={}){let e;var n;return e=t.useCellGeometry?(n=(t=this.cell).isNode()?t.getAngle():0,t.getBBox().bbox(n)):this.getBBoxOfElement(this.container),this.graph.coord.localToGraphRect(e)}getRootTranslatedMatrix(){var t=this.cell;t=t.isNode()?t.getPosition():{x:0,y:0};return Pi().translate(t.x,t.y)}getRootRotatedMatrix(){let t=Pi();var e,n=this.cell,r=n.isNode()?n.getAngle():0;return r&&(e=(n=n.getBBox()).width/2,n=n.height/2,t=t.translate(e,n).rotate(r).translate(-e,-n)),t}findMagnet(t=this.container){return this.findByAttr("magnet",t)}updateAttrs(t,e,n={}){null==n.rootBBox&&(n.rootBBox=new _s),null==n.selectors&&(n.selectors=this.selectors),this.attr.update(t,e,n)}isEdgeElement(t){return this.cell.isEdge()&&(null==t||t===this.container)}prepareHighlight(t,e={}){return t=t||this.container,e.partial=t===this.container,t}highlight(t,e={}){return t=this.prepareHighlight(t,e),this.notify("cell:highlight",{magnet:t,options:e,view:this,cell:this.cell}),this.isEdgeView()?this.notify("edge:highlight",{magnet:t,options:e,view:this,edge:this.cell,cell:this.cell}):this.isNodeView()&&this.notify("node:highlight",{magnet:t,options:e,view:this,node:this.cell,cell:this.cell}),this}unhighlight(t,e={}){return t=this.prepareHighlight(t,e),this.notify("cell:unhighlight",{magnet:t,options:e,view:this,cell:this.cell}),this.isNodeView()?this.notify("node:unhighlight",{magnet:t,options:e,view:this,node:this.cell,cell:this.cell}):this.isEdgeView()&&this.notify("edge:unhighlight",{magnet:t,options:e,view:this,edge:this.cell,cell:this.cell}),this}notifyUnhighlight(t,e){}getEdgeTerminal(t,e,n,r,i){var s=this.cell,o=this.findAttr("port",t),a=t.getAttribute("data-selector"),l={cell:s.id};return null!=a&&(l.magnet=a),null!=o?(l.port=o,s.isNode()&&!s.hasPort(o)&&null==a&&(l.selector=this.getSelector(t))):null==a&&this.container!==t&&(l.selector=this.getSelector(t)),l}getMagnetFromEdgeTerminal(t){var e=this.cell,n=this.container,r=t.port;let i=t.magnet;return null!=r&&e.isNode()&&e.hasPort(r)?this.findPortElem(r,i)||n:((i=i||t.selector)||null==r||(i=`[port="${r}"]`),this.findOne(i,n,this.selectors))}hasTools(t){var e=this.tools;return null!=e&&(null==t||e.name===t)}addTools(t){if(this.removeTools(),t){if(!this.can("toolsAddable"))return this;t=Lh.isToolsView(t)?t:new Lh(t),(this.tools=t).config({view:this}),t.mount()}return this}updateTools(t={}){return this.tools&&this.tools.update(t),this}removeTools(){return this.tools&&(this.tools.remove(),this.tools=null),this}hideTools(){return this.tools&&this.tools.hide(),this}showTools(){return this.tools&&this.tools.show(),this}renderTools(){var t=this.cell.getTools();return this.addTools(t),this}notify(t,e){return this.trigger(t,e),this.graph.trigger(t,e),this}getEventArgs(t,e,n){var r=this.cell;return null==e||null==n?{e:t,view:this,cell:r}:{e:t,x:e,y:n,view:this,cell:r}}onClick(t,e,n){this.notify("cell:click",this.getEventArgs(t,e,n))}onDblClick(t,e,n){this.notify("cell:dblclick",this.getEventArgs(t,e,n))}onContextMenu(t,e,n){this.notify("cell:contextmenu",this.getEventArgs(t,e,n))}onMouseDown(t,e,n){this.cell.model&&(this.cachedModelForMouseEvent=this.cell.model,this.cachedModelForMouseEvent.startBatch("mouse")),this.notify("cell:mousedown",this.getEventArgs(t,e,n))}onMouseUp(t,e,n){this.notify("cell:mouseup",this.getEventArgs(t,e,n)),this.cachedModelForMouseEvent&&(this.cachedModelForMouseEvent.stopBatch("mouse",{cell:this.cell}),this.cachedModelForMouseEvent=null)}onMouseMove(t,e,n){this.notify("cell:mousemove",this.getEventArgs(t,e,n))}onMouseOver(t){this.notify("cell:mouseover",this.getEventArgs(t))}onMouseOut(t){this.notify("cell:mouseout",this.getEventArgs(t))}onMouseEnter(t){this.notify("cell:mouseenter",this.getEventArgs(t))}onMouseLeave(t){this.notify("cell:mouseleave",this.getEventArgs(t))}onMouseWheel(t,e,n,r){this.notify("cell:mousewheel",Object.assign({delta:r},this.getEventArgs(t,e,n)))}onCustomEvent(t,e,n,r){this.notify("cell:customevent",Object.assign({name:e},this.getEventArgs(t,n,r))),this.notify(e,Object.assign({},this.getEventArgs(t,n,r)))}onMagnetMouseDown(t,e,n,r){}onMagnetDblClick(t,e,n,r){}onMagnetContextMenu(t,e,n,r){}onLabelMouseDown(t,e,n){}checkMouseleave(t){var e=this.getEventTarget(t,{fromPoint:!0});e=this.graph.findViewByElem(e);e!==this&&(this.onMouseLeave(t),e)&&e.onMouseEnter(t)}dispose(){this.cell.off("changed",this.onCellChanged,this)}}jh.defaults={isSvgElement:!0,rootSelector:"root",priority:0,bootstrap:[],actions:{}},Zt([jh.dispose()],jh.prototype,"dispose",null),(l=jh=jh||{}).Flag=Mh,l.Attr=Eh,(Sh=jh=jh||{}).toStringTag="X6."+Sh.name,Sh.isCellView=function(t){var e;return null!=t&&(t instanceof Sh||(null==(e=t[Symbol.toStringTag])||e===Sh.toStringTag)&&"function"==typeof t.isNodeView&&"function"==typeof t.isEdgeView&&"function"==typeof t.confirmUpdate)},(Ce=jh=jh||{}).priority=function(t){return function(e){e.config({priority:t})}},Ce.bootstrap=function(t){return function(e){e.config({bootstrap:t})}},(jh=jh||{}).registry=Eo.create({type:"view"});class Lh extends xh{get name(){return this.options.name}get graph(){return this.cellView.graph}get cell(){return this.cellView.cell}get[Symbol.toStringTag](){return Lh.toStringTag}constructor(t={}){super(),this.svgContainer=this.createContainer(!0,t),this.htmlContainer=this.createContainer(!1,t),this.config(t)}createContainer(t,e){return t=t?xh.createElement("g",!0):xh.createElement("div",!1),Tn(t,this.prefixClassName("cell-tools")),e.className&&Tn(t,e.className),t}config(t){if(this.options=Object.assign(Object.assign({},this.options),t),jh.isCellView(t.view)&&t.view!==this.cellView&&(this.cellView=t.view,this.cell.isEdge()?(Tn(this.svgContainer,this.prefixClassName("edge-tools")),Tn(this.htmlContainer,this.prefixClassName("edge-tools"))):this.cell.isNode()&&(Tn(this.svgContainer,this.prefixClassName("node-tools")),Tn(this.htmlContainer,this.prefixClassName("node-tools"))),this.svgContainer.setAttribute("data-cell-id",this.cell.id),this.htmlContainer.setAttribute("data-cell-id",this.cell.id),this.name&&(this.svgContainer.setAttribute("data-tools-name",this.name),this.htmlContainer.setAttribute("data-tools-name",this.name)),t=this.options.items,Array.isArray(t))){this.tools=[];const i=[];t.forEach((t=>{Lh.ToolItem.isToolItem(t)?"vertices"===t.name?i.unshift(t):i.push(t):"vertices"===("object"==typeof t?t.name:t)?i.unshift(t):i.push(t)}));for(let t=0;t<i.length;t+=1){var e=i[t];let s;if(Lh.ToolItem.isToolItem(e))s=e;else{var n="object"==typeof e?e.name:e;e="object"==typeof e&&e.args||{};if(n)if(this.cell.isNode()){var r=iu.registry.get(n);if(!r)return iu.registry.onNotFound(n);s=new r(e)}else if(this.cell.isEdge()){if(r=su.registry.get(n),!r)return su.registry.onNotFound(n);s=new r(e)}}s&&(s.config(this.cellView,this),s.render(),(!1!==s.options.isSVGElement?this.svgContainer:this.htmlContainer).appendChild(s.container),this.tools.push(s))}}return this}update(t={}){var e=this.tools;return e&&e.forEach((e=>{t.toolId!==e.cid&&e.isVisible()&&e.update()})),this}focus(t){var e=this.tools;return e&&e.forEach((e=>{t===e?e.show():e.hide()})),this}blur(t){var e=this.tools;return e&&e.forEach((e=>{e===t||e.isVisible()||(e.show(),e.update())})),this}hide(){return this.focus(null)}show(){return this.blur(null)}remove(){var t=this.tools;return t&&(t.forEach((t=>t.remove())),this.tools=null),Xn(this.svgContainer),Xn(this.htmlContainer),super.remove()}mount(){var t,e=this.tools,n=this.cellView;return n&&e&&(t=e.some((t=>!1!==t.options.isSVGElement)),e=e.some((t=>!1===t.options.isSVGElement)),t&&(this.options.local?n.container:n.graph.view.decorator).appendChild(this.svgContainer),e)&&this.graph.container.appendChild(this.htmlContainer),this}}(Oh=Lh=Lh||{}).toStringTag="X6."+Oh.name,Oh.isToolsView=function(t){var e;return null!=t&&(t instanceof Oh||(null==(e=t[Symbol.toStringTag])||e===Oh.toStringTag)&&null!=t.graph&&null!=t.cell&&"function"==typeof t.config&&"function"==typeof t.update&&"function"==typeof t.focus&&"function"==typeof t.blur&&"function"==typeof t.show&&"function"==typeof t.hide)};{fe=Lh=Lh||{};class id extends xh{static getDefaults(){return this.defaults}static config(t){this.defaults=this.getOptions(t)}static getOptions(t){return D.Z(_.Z(this.getDefaults()),t)}get graph(){return this.cellView.graph}get cell(){return this.cellView.cell}get name(){return this.options.name}get[Symbol.toStringTag](){return id.toStringTag}constructor(t={}){super(),this.visible=!0,this.options=this.getOptions(t),this.container=xh.createElement(this.options.tagName||"g",!1!==this.options.isSVGElement),Tn(this.container,this.prefixClassName("cell-tool")),"string"==typeof this.options.className&&Tn(this.container,this.options.className),this.init()}init(){}getOptions(t){return this.constructor.getOptions(t)}delegateEvents(){return this.options.events&&super.delegateEvents(this.options.events),this}config(t,e){return this.cellView=t,this.parent=e,this.stamp(this.container),this.cell.isEdge()?Tn(this.container,this.prefixClassName("edge-tool")):this.cell.isNode()&&Tn(this.container,this.prefixClassName("node-tool")),this.name&&this.container.setAttribute("data-tool-name",this.name),this.delegateEvents(),this}render(){this.empty();var t=this.options.markup;return t&&(t=Xl.parseJSONMarkup(t),this.container.appendChild(t.fragment),this.childNodes=t.selectors),this.onRender(),this}onRender(){}update(){return this}stamp(t){t&&t.setAttribute("data-cell-id",this.cellView.cell.id)}show(){return this.container.style.display="",this.visible=!0,this}hide(){return this.container.style.display="none",this.visible=!1,this}isVisible(){return this.visible}focus(){var t=this.options.focusOpacity;return null!=t&&Number.isFinite(t)&&(this.container.style.opacity=""+t),this.parent.focus(this),this}blur(){return this.container.style.opacity="",this.parent.blur(this),this}guard(t){return null==this.graph||null==this.cellView||this.graph.view.guard(t,this.cellView)}}id.defaults={isSVGElement:!0,tagName:"g"},fe.ToolItem=id;{h=id=fe.ToolItem||(fe.ToolItem={});let sd=0;h.define=function(t){var e=dt((e=t.name)?Ze(e):"CustomTool"+(sd+=1),this);return e.config(t),e}}(Th=id=fe.ToolItem||(fe.ToolItem={})).toStringTag="X6."+Th.name,Th.isToolItem=function(t){var e;return null!=t&&(t instanceof Th||(null==(e=t[Symbol.toStringTag])||e===Th.toStringTag)&&null!=t.graph&&null!=t.cell&&"function"==typeof t.config&&"function"==typeof t.update&&"function"==typeof t.focus&&"function"==typeof t.blur&&"function"==typeof t.show&&"function"==typeof t.hide&&"function"==typeof t.isVisible)}}const Bh=t=>t;function Rh(t,e){return 0===e?"0%":Math.round(t/e*100)+"%"}function Dh(t){return(e,n,r,i)=>{if(n.isEdgeElement(r))return o=t,l=e,a=i,(s=(s=n).getConnection())&&(a=s.closestPointLength(a),o?(o=s.length(),l.anchor={name:"ratio",args:{ratio:a/o}}):l.anchor={name:"length",args:{length:a}}),l;{var s=t,o=e,a=r,l=i;r=(e=n).cell,i=r.getAngle(),e=e.getUnrotatedBBoxOfElement(a),a=r.getBBox().getCenter();let h=(r=Js.create(l).rotate(i,a)).x-e.x,u=r.y-e.y;return s&&(h=Rh(h,e.width),u=Rh(u,e.height)),o.anchor={name:"topLeft",args:{dx:h,dy:u,rotate:!0}},o}}}const Ih=Dh(!0),Vh=Dh(!1);function zh(t,e,n,r){return M(Nh.presets.pinRelative,this.graph,{},e,n,t,this.cell,r,{}).anchor}function Fh(t,e){return e?t.cell.getBBox():t.cell.isEdge()?t.getConnection().bbox():t.getUnrotatedBBoxOfElement(t.container)}(Pe=Nh=Nh||{}).presets=p,Pe.registry=Eo.create({type:"connection strategy"}),Pe.registry.register(Pe.presets,!0);class $h extends Lh.ToolItem{onRender(){Tn(this.container,this.prefixClassName("cell-tool-button")),this.update()}update(){return this.updatePosition(),this}updatePosition(){var t=this.cellView.cell.isEdge()?this.getEdgeMatrix():this.getNodeMatrix();Li(this.container,t,{absolute:!0})}getNodeMatrix(){var t=this.cellView,e=this.options,{x:n=0,y:r=0}=e,{offset:e,useCellGeometry:i,rotate:s}=e;let o=Fh(t,i);i=t.cell.getAngle(),s||(o=o.bbox(i));let a=0,l=0,h=("number"==typeof e?(a=e,l=e):"object"==typeof e&&(a=e.x,l=e.y),n=rn(n,o.width),r=rn(r,o.height),Pi().translate(o.x+o.width/2,o.y+o.height/2));return(h=s?h.rotate(i):h).translate(n+a-o.width/2,r+l-o.height/2)}getEdgeMatrix(){var t=this.cellView,{offset:e=0,distance:n=0,rotate:r}=this.options;let i,s,o;n=rn(n,1),i=0<=n&&n<=1?t.getTangentAtRatio(n):t.getTangentAtLength(n),o=i?(s=i.start,i.vector().vectorAngle(new Js(1,0))||0):(s=t.getConnection().start,0);let a=Pi().translate(s.x,s.y).rotate(o);return a="object"==typeof e?a.translate(e.x||0,e.y||0):a.translate(0,e),r?a:a.rotate(-o)}onMouseDown(t){var e;this.guard(t)||(t.stopPropagation(),t.preventDefault(),"function"==typeof(e=this.options.onClick)&&M(e,this.cellView,{e:t,view:this.cellView,cell:this.cellView.cell,btn:this}))}}($h=$h||{}).config({name:"button",useCellGeometry:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"}}),(Ae=$h=$h||{}).Remove=Ae.define({name:"button-remove",markup:[{tagName:"circle",selector:"button",attrs:{r:7,fill:"#FF1D00",cursor:"pointer"}},{tagName:"path",selector:"icon",attrs:{d:"M -3 -3 3 3 M -3 3 3 -3",fill:"none",stroke:"#FFFFFF","stroke-width":2,"pointer-events":"none"}}],distance:60,offset:0,useCellGeometry:!0,onClick({view:t,btn:e}){e.parent.remove(),t.cell.remove({ui:!0,toolId:e.cid})}});var Gh,qh,Hh=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};class Zh extends Lh.ToolItem{onRender(){var t,e;Tn(this.container,this.prefixClassName("cell-tool-boundary")),this.options.attrs&&(t=(e=this.options.attrs)["class"],e=Hh(e,["class"]),ur(this.container,gr(e)),t)&&Tn(this.container,t),this.update()}update(){var t=this.cellView,e=this.options,{useCellGeometry:n,rotate:r}=e;e=sn(e.padding);let i=Fh(t,n).moveAndExpand({x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom});return n=t.cell,n.isNode()&&(e=n.getAngle())&&(r?(t=n.getBBox().getCenter(),Ri(this.container,e,t.x,t.y,{absolute:!0})):i=i.bbox(e)),ur(this.container,i.toJSON()),this}}(Zh=Zh||{}).config({name:"boundary",tagName:"rect",padding:10,useCellGeometry:!0,attrs:{fill:"none",stroke:"#333","stroke-width":.5,"stroke-dasharray":"5, 5","pointer-events":"none"}});class Uh extends Lh.ToolItem{constructor(){super(...arguments),this.handles=[]}get vertices(){return this.cellView.cell.getVertices()}onRender(){return this.addClass(this.prefixClassName("edge-tool-vertices")),this.options.addable&&this.updatePath(),this.resetHandles(),this.renderHandles(),this}update(){return this.vertices.length===this.handles.length?this.updateHandles():(this.resetHandles(),this.renderHandles()),this.options.addable&&this.updatePath(),this}resetHandles(){var t=this.handles;this.handles=[],t&&t.forEach((t=>{this.stopHandleListening(t),t.remove()}))}renderHandles(){var t=this.vertices;for(let i=0,s=t.length;i<s;i+=1){var e=t[i],n=this.options.createHandle,r=this.options.processHandle;n=n({index:i,graph:this.graph,guard:t=>this.guard(t),attrs:this.options.attrs||{}});r&&r(n),n.updatePosition(e.x,e.y),this.stamp(n.container),this.container.appendChild(n.container),this.handles.push(n),this.startHandleListening(n)}}updateHandles(){var t=this.vertices;for(let r=0,i=t.length;r<i;r+=1){var e=t[r],n=this.handles[r];n&&n.updatePosition(e.x,e.y)}}updatePath(){var t=this.childNodes.connection;t&&t.setAttribute("d",this.cellView.getConnectionPathData())}startHandleListening(t){var e=this.cellView;e.can("vertexMovable")&&(t.on("change",this.onHandleChange,this),t.on("changing",this.onHandleChanging,this),t.on("changed",this.onHandleChanged,this)),e.can("vertexDeletable")&&t.on("remove",this.onHandleRemove,this)}stopHandleListening(t){var e=this.cellView;e.can("vertexMovable")&&(t.off("change",this.onHandleChange,this),t.off("changing",this.onHandleChanging,this),t.off("changed",this.onHandleChanged,this)),e.can("vertexDeletable")&&t.off("remove",this.onHandleRemove,this)}getNeighborPoints(t){var e=this.cellView,n=this.vertices,r=0<t?n[t-1]:e.sourceAnchor;n=t<n.length-1?n[t+1]:e.targetAnchor;return{prev:Js.create(r),next:Js.create(n)}}getMouseEventArgs(t){t=this.normalizeEvent(t);var{x:e,y:n}=this.graph.snapToGrid(t.clientX,t.clientY);return{e:t,x:e,y:n}}onHandleChange({e:t}){this.focus();var e,n,r=this.cellView;r.cell.startBatch("move-vertex",{ui:!0,toolId:this.cid}),this.options.stopPropagation||(({e:t,x:e,y:n}=this.getMouseEventArgs(t)),this.eventData(t,{start:{x:e,y:n}}),r.notifyMouseDown(t,e,n))}onHandleChanging({handle:t,e:e}){var n=this.cellView,r=t.options.index,{e:e,x:i,y:s}=this.getMouseEventArgs(e),o={x:i,y:s};this.snapVertex(o,r),n.cell.setVertexAt(r,o,{ui:!0,toolId:this.cid}),t.updatePosition(o.x,o.y),this.options.stopPropagation||n.notifyMouseMove(e,i,s)}stopBatch(t){this.cell.stopBatch("move-vertex",{ui:!0,toolId:this.cid}),t&&this.cell.stopBatch("add-vertex",{ui:!0,toolId:this.cid})}onHandleChanged({e:t}){var e,n,r,i,s,o=this.options,a=this.cellView;o.addable&&this.updatePath(),o.removeRedundancies?(({e:e,x:n,y:r}=(a.removeRedundantLinearVertices({ui:!0,toolId:this.cid})&&this.render(),this.blur(),this.stopBatch(this.eventData(t).vertexAdded),this.getMouseEventArgs(t))),this.options.stopPropagation||(a.notifyMouseUp(e,n,r),i=this.eventData(e)["start"],i&&(({x:i,y:s}=i),i===n)&&s===r&&a.onClick(e,n,r)),a.checkMouseleave(e),o.onChanged&&o.onChanged({edge:a.cell,edgeView:a})):this.stopBatch(this.eventData(t).vertexAdded)}snapVertex(t,e){var n,r,i=this.options.snapRadius||0;0<i&&(n=(e=this.getNeighborPoints(e)).prev,r=e.next,Math.abs(t.x-n.x)<i?t.x=n.x:Math.abs(t.x-r.x)<i&&(t.x=r.x),Math.abs(t.y-n.y)<i?t.y=e.prev.y:Math.abs(t.y-r.y)<i&&(t.y=r.y))}onHandleRemove({handle:t,e:e}){var n;this.options.removable&&(t=t.options.index,(n=this.cellView).cell.removeVertexAt(t,{ui:!0}),this.options.addable&&this.updatePath(),n.checkMouseleave(this.normalizeEvent(e)))}allowAddVertex(t){var e=this.guard(t),n=this.options.addable&&this.cellView.can("vertexAddable");t=!this.options.modifiers||Xi.isMatch(t,this.options.modifiers);return!e&&n&&t}onPathMouseDown(t){var e,n,r=this.cellView;this.allowAddVertex(t)&&(t.stopPropagation(),t.preventDefault(),t=this.normalizeEvent(t),e=this.graph.snapToGrid(t.clientX,t.clientY).toJSON(),r.cell.startBatch("add-vertex",{ui:!0,toolId:this.cid}),n=r.getVertexIndex(e.x,e.y),this.snapVertex(e,n),r.cell.insertVertex(e,n,{ui:!0,toolId:this.cid}),this.render(),r=this.handles[n],this.eventData(t,{vertexAdded:!0}),r.onMouseDown(t))}onRemove(){this.resetHandles()}}{var Jh=Uh=Uh||{};class od extends xh{get graph(){return this.options.graph}constructor(t){super(),this.options=t,this.render(),this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDoubleClick"})}render(){this.container=xh.createElement("circle",!0);var t,e=this.options.attrs;"function"==typeof e?(t=Jh.getDefaults(),this.setAttrs(Object.assign(Object.assign({},t.attrs),e(this)))):this.setAttrs(e),this.addClass(this.prefixClassName("edge-tool-vertex"))}updatePosition(t,e){this.setAttrs({cx:t,cy:e})}onMouseDown(t){this.options.guard(t)||(t.stopPropagation(),t.preventDefault(),this.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},t.data),this.emit("change",{e:t,handle:this}))}onMouseMove(t){this.emit("changing",{e:t,handle:this})}onMouseUp(t){this.emit("changed",{e:t,handle:this}),this.undelegateDocumentEvents(),this.graph.view.delegateEvents()}onDoubleClick(t){this.emit("remove",{e:t,handle:this})}}Jh.Handle=od}Gh=Uh=Uh||{},u=Ml.prefix("edge-tool-vertex-path"),Gh.config({name:"vertices",snapRadius:20,addable:!0,removable:!0,removeRedundancies:!0,stopPropagation:!0,attrs:{r:6,fill:"#333",stroke:"#fff",cursor:"move","stroke-width":2},createHandle:t=>new Gh.Handle(t),markup:[{tagName:"path",selector:"connection",className:u,attrs:{fill:"none",stroke:"transparent","stroke-width":10,cursor:"pointer"}}],events:{["mousedown ."+u]:"onPathMouseDown",["touchstart ."+u]:"onPathMouseDown"}});class Wh extends Lh.ToolItem{constructor(){super(...arguments),this.handles=[]}get vertices(){return this.cellView.cell.getVertices()}update(){return this.render(),this}onRender(){Tn(this.container,this.prefixClassName("edge-tool-segments")),this.resetHandles();var t=this.cellView,e=[...this.vertices];e.unshift(t.sourcePoint),e.push(t.targetPoint);for(let i=0,s=e.length;i<s-1;i+=1){var n=e[i],r=e[i+1];n=this.renderHandle(n,r,i);this.stamp(n.container),this.handles.push(n)}return this}renderHandle(t,e,n){return n=this.options.createHandle({index:n,graph:this.graph,guard:t=>this.guard(t),attrs:this.options.attrs||{}}),this.options.processHandle&&this.options.processHandle(n),this.updateHandle(n,t,e),this.container.appendChild(n.container),this.startHandleListening(n),n}startHandleListening(t){t.on("change",this.onHandleChange,this),t.on("changing",this.onHandleChanging,this),t.on("changed",this.onHandleChanged,this)}stopHandleListening(t){t.off("change",this.onHandleChange,this),t.off("changing",this.onHandleChanging,this),t.off("changed",this.onHandleChanged,this)}resetHandles(){var t=this.handles;this.handles=[],t&&t.forEach((t=>{this.stopHandleListening(t),t.remove()}))}shiftHandleIndexes(t){var e=this.handles;for(let n=0,r=e.length;n<r;n+=1)e[n].options.index+=t}resetAnchor(t,e){var n=this.cellView.cell,r={ui:!0,toolId:this.cid};e?n.prop([t,"anchor"],e,r):n.removeProp([t,"anchor"],r)}snapHandle(t,e,n){var r=t.options.axis,i=(t=t.options.index,this.cellView.cell.getVertices()),s=i[t-2]||n.sourceAnchor;i=i[t+1]||n.targetAnchor,t=this.options.snapRadius;return Math.abs(e[r]-s[r])<t?e[r]=s[r]:Math.abs(e[r]-i[r])<t&&(e[r]=i[r]),e}onHandleChanging({handle:t,e:e}){var n=this.graph,r=this.options,i=this.cellView,s=r.anchor,o=t.options.axis,a=t.options.index-1,l=this.getEventData(e),h=(e=this.normalizeEvent(e),n=n.snapToGrid(e.clientX,e.clientY),this.snapHandle(t,n.clone(),l)),u=_.Z(this.vertices);let c=u[a],g=u[1+a];var d=i.sourceView,p=i.sourceBBox;let f=!1,m=!1;c?0==a?p.containsPoint(c)?(u.shift(),this.shiftHandleIndexes(-1),f=!0):(c[o]=h[o],m=!0):c[o]=h[o]:((c=i.sourceAnchor.toJSON())[o]=h[o],p.containsPoint(c)?f=!0:(u.unshift(c),this.shiftHandleIndexes(1),m=!0)),"function"==typeof s&&d&&(f&&((p=l.sourceAnchor.clone())[o]=h[o],p=M(s,i,p,d,i.sourceMagnet||d.container,"source",i,this),this.resetAnchor("source",p)),m)&&this.resetAnchor("source",l.sourceAnchorDef);d=i.targetView,p=i.targetBBox;let v=!1,y=!1;g?a==u.length-2?p.containsPoint(g)?(u.pop(),v=!0):(g[o]=h[o],y=!0):g[o]=h[o]:((g=i.targetAnchor.toJSON())[o]=h[o],p.containsPoint(g)?v=!0:(u.push(g),y=!0)),"function"==typeof s&&d&&(v&&((a=l.targetAnchor.clone())[o]=h[o],p=M(s,i,a,d,i.targetMagnet||d.container,"target",i,this),this.resetAnchor("target",p)),y)&&this.resetAnchor("target",l.targetAnchorDef),Js.equalPoints(u,this.vertices)||this.cellView.cell.setVertices(u,{ui:!0,toolId:this.cid}),this.updateHandle(t,c,g,0),r.stopPropagation||i.notifyMouseMove(e,n.x,n.y)}onHandleChange({handle:t,e:e}){var n=this.options,r=this.handles,i=this.cellView,s=t.options.index;if(Array.isArray(r)){for(let t=0,e=r.length;t<e;t+=1)t!==s&&r[t].hide();this.focus(),this.setEventData(e,{sourceAnchor:i.sourceAnchor.clone(),targetAnchor:i.targetAnchor.clone(),sourceAnchorDef:_.Z(this.cell.prop(["source","anchor"])),targetAnchorDef:_.Z(this.cell.prop(["target","anchor"]))}),this.cell.startBatch("move-segment",{ui:!0,toolId:this.cid}),n.stopPropagation||(t=this.normalizeEvent(e),n=this.graph.snapToGrid(t.clientX,t.clientY),i.notifyMouseDown(t,n.x,n.y))}}onHandleChanged({e:t}){var e=this.options,n=this.cellView,r=(t=(e.removeRedundancies&&n.removeRedundantLinearVertices({ui:!0,toolId:this.cid}),this.normalizeEvent(t)),this.graph.snapToGrid(t.clientX,t.clientY));this.render(),this.blur(),this.cell.stopBatch("move-segment",{ui:!0,toolId:this.cid}),e.stopPropagation||n.notifyMouseUp(t,r.x,r.y),n.checkMouseleave(t),e.onChanged&&e.onChanged({edge:n.cell,edgeView:n})}updateHandle(t,e,n,r=0){var i=this.options.precision||0,s=Math.abs(e.x-n.x)<i;i=Math.abs(e.y-n.y)<i;!s&&!i||(i=new Qs(e,n)).length()<this.options.threshold?t.hide():((e=i.getCenter())[n=s?"x":"y"]+=r||0,s=i.vector().vectorAngle(new Js(1,0)),t.updatePosition(e.x,e.y,s,this.cellView),t.show(),t.options.axis=n)}onRemove(){this.resetHandles()}}{var Xh=Wh=Wh||{};class ad extends xh{constructor(t){super(),this.options=t,this.render(),this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown"})}render(){this.container=xh.createElement("rect",!0);var t,e=this.options.attrs;"function"==typeof e?(t=Xh.getDefaults(),this.setAttrs(Object.assign(Object.assign({},t.attrs),e(this)))):this.setAttrs(e),this.addClass(this.prefixClassName("edge-tool-segment"))}updatePosition(t,e,n,r){r=r.getClosestPoint(new Js(t,e))||new Js(t,e);let i=Pi().translate(r.x,r.y);if(r.equals({x:t,y:e}))i=i.rotate(n);else{let n=new Qs(t,e,r.x,r.y).vector().vectorAngle(new Js(1,0));0!==n&&(n+=90),i=i.rotate(n)}this.setAttrs({transform:Mi(i),cursor:n%180==0?"row-resize":"col-resize"})}onMouseDown(t){this.options.guard(t)||(this.trigger("change",{e:t,handle:this}),t.stopPropagation(),t.preventDefault(),this.options.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},t.data))}onMouseMove(t){this.emit("changing",{e:t,handle:this})}onMouseUp(t){this.emit("changed",{e:t,handle:this}),this.undelegateDocumentEvents(),this.options.graph.view.delegateEvents()}show(){this.container.style.display=""}hide(){this.container.style.display="none"}}Xh.Handle=ad}(qh=Wh=Wh||{}).config({name:"segments",precision:.5,threshold:40,snapRadius:10,stopPropagation:!0,removeRedundancies:!0,attrs:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#333",stroke:"#fff","stroke-width":2},createHandle:t=>new qh.Handle(t),anchor:zh});class Yh extends Lh.ToolItem{get type(){return this.options.type}onRender(){Tn(this.container,this.prefixClassName(`edge-tool-${this.type}-anchor`)),this.toggleArea(!1),this.update()}update(){var t=this.type;return this.cellView.getTerminalView(t)?(this.updateAnchor(),this.updateArea(),this.container.style.display=""):this.container.style.display="none",this}updateAnchor(){var t=this.childNodes;if(t){const i=t.anchor;if(i){t=this.type;var e=this.cellView,n=this.options,r=e.getTerminalAnchor(t);e=e.cell.prop([t,"anchor"]);i.setAttribute("transform",`translate(${r.x}, ${r.y})`);const s=e?n.customAnchorAttrs:n.defaultAnchorAttrs;s&&Object.keys(s).forEach((t=>{i.setAttribute(t,s[t])}))}}}updateArea(){var t=this.childNodes;if(t&&(t=t.area,t)){var e=this.type,n=this.cellView,r=n.getTerminalView(e);if(r){var i=r.cell;n=n.getTerminalMagnet(e);let s,o,a,l=this.options.areaPadding||0;Number.isFinite(l)||(l=0),r.isEdgeElement(n)?(s=r.getBBox(),o=0,a=s.getCenter()):(s=r.getUnrotatedBBoxOfElement(n),o=i.getAngle(),a=s.getCenter(),o&&a.rotate(-o,i.getBBox().getCenter())),s.inflate(l),ur(t,{x:-s.width/2,y:-s.height/2,width:s.width,height:s.height,transform:`translate(${a.x}, ${a.y}) rotate(${o})`})}}}toggleArea(t){var e;this.childNodes&&(e=this.childNodes.area)&&(e.style.display=t?"":"none")}onMouseDown(t){this.guard(t)||(t.stopPropagation(),t.preventDefault(),this.graph.view.undelegateEvents(),this.options.documentEvents&&this.delegateDocumentEvents(this.options.documentEvents),this.focus(),this.toggleArea(this.options.restrictArea),this.cell.startBatch("move-anchor",{ui:!0,toolId:this.cid}))}resetAnchor(t){var e=this.type,n=this.cell;t?n.prop([e,"anchor"],t,{rewrite:!0,ui:!0,toolId:this.cid}):n.removeProp([e,"anchor"],{ui:!0,toolId:this.cid})}onMouseMove(t){var e=this.type,n=this.cellView,r=n.getTerminalView(e);if(null!=r){t=this.normalizeEvent(t);var i=r.cell,s=n.getTerminalMagnet(e);let l=this.graph.coord.clientToLocalPoint(t.clientX,t.clientY);var o,a;t=this.options.snap;let h;"function"==typeof t&&(t=M(t,n,l,r,s,e,n,this),l=Js.create(t)),this.options.restrictArea&&(r.isEdgeElement(s)?(t=r.getClosestPoint(l))&&(l=t):(t=r.getUnrotatedBBoxOfElement(s),o=i.getAngle(),i=i.getBBox().getCenter(),a=l.clone().rotate(o,i),t.containsPoint(a)||(l=t.getNearestPointToPoint(a).rotate(-o,i)))),t=this.options.anchor,"function"==typeof t&&(h=M(t,n,l,r,s,e,n,this)),this.resetAnchor(h),this.update()}}onMouseUp(t){this.graph.view.delegateEvents(),this.undelegateDocumentEvents(),this.blur(),this.toggleArea(!1);var e=this.cellView;this.options.removeRedundancies&&e.removeRedundantLinearVertices({ui:!0,toolId:this.cid}),this.cell.stopBatch("move-anchor",{ui:!0,toolId:this.cid})}onDblClick(){var t=this.options.resetAnchor;t&&this.resetAnchor(!0===t?void 0:t),this.update()}}(Yh||(Yh={})).config({tagName:"g",markup:[{tagName:"circle",selector:"anchor",attrs:{cursor:"pointer"}},{tagName:"rect",selector:"area",attrs:{"pointer-events":"none",fill:"none",stroke:"#33334F","stroke-dasharray":"2,4",rx:5,ry:5}}],events:{mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDblClick"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},customAnchorAttrs:{"stroke-width":4,stroke:"#33334F",fill:"#FFFFFF",r:5},defaultAnchorAttrs:{"stroke-width":2,stroke:"#FFFFFF",fill:"#33334F",r:6},areaPadding:6,snapRadius:10,resetAnchor:!0,restrictArea:!0,removeRedundancies:!0,anchor:zh,snap(t,e,n,r,i,s){return s=s.options.snapRadius||0,r="source"===r,r=this.cell.getVertexAt(r?0:-1)||this.getTerminalAnchor(r?"target":"source"),r&&(Math.abs(r.x-t.x)<s&&(t.x=r.x),Math.abs(r.y-t.y)<s)&&(t.y=r.y),t}});const _h=Yh.define({name:"source-anchor",type:"source"}),Kh=Yh.define({name:"target-anchor",type:"target"});var Qh=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};class tu extends Lh.ToolItem{get type(){return this.options.type}get ratio(){return this.options.ratio}init(){var t,e;this.options.attrs&&(t=(e=this.options.attrs)["class"],e=Qh(e,["class"]),this.setAttrs(e,this.container),t)&&Tn(this.container,t)}onRender(){Tn(this.container,this.prefixClassName(`edge-tool-${this.type}-arrowhead`)),this.update()}update(){var t=this.ratio,e=this.cellView,n=e.getTangentAtRatio(t);e=n?n.start:e.getPointAtRatio(t),t=n&&n.vector().vectorAngle(new Js(1,0))||0;return e&&(n=Pi().translate(e.x,e.y).rotate(t),Li(this.container,n,{absolute:!0})),this}onMouseDown(t){var e,n;this.guard(t)||(t.stopPropagation(),t.preventDefault(),(e=this.cellView).can("arrowheadMovable")&&(e.cell.startBatch("move-arrowhead",{ui:!0,toolId:this.cid}),n=this.graph.snapToGrid(t.clientX,t.clientY),n=e.prepareArrowheadDragging(this.type,{x:n.x,y:n.y,options:Object.assign(Object.assign({},this.options),{toolId:this.cid})}),this.cellView.setEventData(t,n),this.delegateDocumentEvents(this.options.documentEvents,t.data),e.graph.view.undelegateEvents(),this.container.style.pointerEvents="none"),this.focus())}onMouseMove(t){t=this.normalizeEvent(t);var e=this.graph.snapToGrid(t.clientX,t.clientY);this.cellView.onMouseMove(t,e.x,e.y),this.update()}onMouseUp(t){this.undelegateDocumentEvents();t=this.normalizeEvent(t);var e=this.cellView,n=this.graph.snapToGrid(t.clientX,t.clientY);e.onMouseUp(t,n.x,n.y),this.graph.view.delegateEvents(),this.blur(),this.container.style.pointerEvents="",e.cell.stopBatch("move-arrowhead",{ui:!0,toolId:this.cid})}}(tu=tu||{}).config({tagName:"path",isSVGElement:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}});const eu=tu.define({name:"source-arrowhead",type:"source",ratio:0,attrs:{d:"M 10 -8 -10 0 10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}}),nu=tu.define({name:"target-arrowhead",type:"target",ratio:1,attrs:{d:"M -10 -8 10 0 -10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}});class ru extends Lh.ToolItem{constructor(){super(...arguments),this.labelIndex=-1,this.distance=.5,this.dblClick=this.onCellDblClick.bind(this)}onRender(){var t=this.cellView;t&&t.on("cell:dblclick",this.dblClick)}createElement(){var t=[this.prefixClassName((this.cell.isEdge()?"edge":"node")+"-tool-editor"),this.prefixClassName("cell-tool-editor")];this.editor=Lh.createElement("div",!1),this.addClass(t,this.editor),this.editor.contentEditable="true",this.container.appendChild(this.editor)}removeElement(){this.undelegateDocumentEvents(),this.editor&&(this.container.removeChild(this.editor),this.editor=null)}updateEditor(){var t,{cell:e,editor:n}=this;if(n)return t=n["style"],e=(e.isNode()?this.updateNodeEditorTransform():e.isEdge()&&this.updateEdgeEditorTransform(),this.options)["attrs"],t.fontSize=e.fontSize+"px",t.fontFamily=e.fontFamily,t.color=e.color,t.backgroundColor=e.backgroundColor,t=this.getCellText()||"",n.innerText=t,this.setCellText(""),this}updateNodeEditorTransform(){var{graph:t,cell:e,editor:n}=this;if(n){let l=Js.create(),h=20,u="";var{x:r,y:i}=this.options,{width:s,height:o}=this.options,a=(void 0!==r&&void 0!==i?(r=rn(r,(a=e.getBBox()).width),i=rn(i,a.height),l=a.topLeft.translate(r,i),h=a.width-2*r):(i=e.getBBox(),l=i.center,h=i.width-4,u="translate(-50%, -50%)"),t.scale()),r=n["style"];l=t.localToGraph(l),r.left=l.x+"px",r.top=l.y+"px",r.transform=`scale(${a.sx}, ${a.sy}) `+u,r.minWidth=h+"px","number"==typeof s&&(r.width=s+"px"),"number"==typeof o&&(r.height=o+"px")}}updateEdgeEditorTransform(){if(this.event){var{graph:t,editor:e}=this;if(e){let s=Js.create(),o=20;var e=e["style"],n=this.event.target,r=n.parentElement;if(r&&On(r,this.prefixClassName("edge-label"))){var i=r.getAttribute("data-index")||"0";i=(this.labelIndex=parseInt(i,10),r.getAttribute("transform")),r=Si(i)["translation"];s=new Js(r.tx,r.ty),o=fl.getBBox(n).width}else{if(!this.options.labelAddable)return this;s=t.clientToLocal(Js.create(this.event.clientX,this.event.clientY)),i=this.cellView.path.closestPointLength(s),this.distance=i,this.labelIndex=-1}s=t.localToGraph(s),r=t.scale(),e.left=s.x+"px",e.top=s.y+"px",e.minWidth=o+"px",e.transform=`scale(${r.sx}, ${r.sy}) translate(-50%, -50%)`}}}onDocumentMouseUp(t){this.editor&&t.target!==this.editor&&(t=this.editor.innerText.replace(/\n$/,"")||"",this.setCellText(""!==t?t:null),this.removeElement())}onCellDblClick({e:t}){this.editor||(t.stopPropagation(),this.removeElement(),this.event=t,this.createElement(),this.updateEditor(),this.autoFocus(),this.delegateDocumentEvents(this.options.documentEvents))}onMouseDown(t){t.stopPropagation()}autoFocus(){setTimeout((()=>{this.editor&&(this.editor.focus(),this.selectText())}))}selectText(){var t,e;window.getSelection&&this.editor&&(t=document.createRange(),e=window.getSelection(),t.selectNodeContents(this.editor),e.removeAllRanges(),e.addRange(t))}getCellText(){var t=this.options["getText"];return"function"==typeof t?M(t,this.cellView,{cell:this.cell,index:this.labelIndex}):"string"==typeof t?this.cell.isNode()?this.cell.attr(t):this.cell.isEdge()&&-1!==this.labelIndex?this.cell.prop(`labels/${this.labelIndex}/attrs/`+t):void 0:void 0}setCellText(t){var e,n,r=this.options.setText;"function"==typeof r?M(r,this.cellView,{cell:this.cell,value:t,index:this.labelIndex,distance:this.distance}):"string"==typeof r&&(this.cell.isNode()?null!==t&&this.cell.attr(r,t):this.cell.isEdge()&&(e=this.cell,-1===this.labelIndex?t&&(mt(n={position:{distance:this.distance},attrs:{}},"attrs/"+r,t),e.appendLabel(n)):null!==t?e.prop(`labels/${this.labelIndex}/attrs/`+r,t):"number"==typeof this.labelIndex&&e.removeLabelAt(this.labelIndex)))}onRemove(){var t=this.cellView;t&&t.off("cell:dblclick",this.dblClick),this.removeElement()}}(ru=ru||{}).config({tagName:"div",isSVGElement:!1,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mouseup:"onDocumentMouseUp",touchend:"onDocumentMouseUp",touchcancel:"onDocumentMouseUp"}}),(ye=ru=ru||{}).NodeEditor=ye.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},getText:"text/text",setText:"text/text"}),ye.EdgeEditor=ye.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},labelAddable:!0,getText:"label/text",setText:"label/text"});var iu,su,ou=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};(we=iu=iu||{}).presets={boundary:Zh,button:$h,"button-remove":$h.Remove,"node-editor":ru.NodeEditor},we.registry=Eo.create({type:"node tool",process(t,e){if("function"==typeof e)return e;let n=Lh.ToolItem;var r,i=e["inherit"];e=ou(e,["inherit"]);return i&&(null==(r=this.get(i))?this.onNotFound(i,"inherited"):n=r),null==e.name&&(e.name=t),n.define.call(n,e)}}),we.registry.register(we.presets,!0),(xe=su=su||{}).presets={boundary:Zh,vertices:Uh,segments:Wh,button:$h,"button-remove":$h.Remove,"source-anchor":_h,"target-anchor":Kh,"source-arrowhead":eu,"target-arrowhead":nu,"edge-editor":ru.EdgeEditor},xe.registry=Eo.create({type:"edge tool",process(t,e){if("function"==typeof e)return e;let n=Lh.ToolItem;var r,i=e["inherit"];e=ou(e,["inherit"]);return i&&(null==(r=this.get(i))?this.onNotFound(i,"inherited"):n=r),null==e.name&&(e.name=t),n.define.call(n,e)}}),xe.registry.register(xe.presets,!0);const au=mu("center"),lu=mu("topCenter"),hu=mu("bottomCenter"),uu=mu("leftMiddle"),cu=mu("rightMiddle"),gu=mu("topLeft"),du=mu("topRight"),pu=mu("bottomLeft"),fu=mu("bottomRight");function mu(t){return function(e,n,r,i={}){n=i.rotate?e.getUnrotatedBBoxOfElement(n):e.getBBoxOfElement(n);var s=n[t];s.x+=rn(i.dx,n.width),s.y+=rn(i.dy,n.height),n=e.cell;return i.rotate?s.rotate(-n.getAngle(),n.getBBox().getCenter()):s}}function vu(t){return function(e,n,r,i){if(r instanceof Element){var s=this.graph.findViewByElem(r);let o;return o=s?s.isEdgeElement(r)?yu(s,null!=i.fixedAt?i.fixedAt:"50%"):s.getBBoxOfElement(r).getCenter():new Js,t.call(this,e,n,o,i)}return t.apply(this,arguments)}}function yu(t,e){var n=nn(e);e="string"==typeof e?parseFloat(e):e;return n?t.getPointAtRatio(e/100):t.getPointAtLength(e)}const bu=vu((function(t,e,n,r){var i=Ki.normalize(t.cell.getAngle()),s=(t=t.getBBoxOfElement(e),e=t.getCenter(),t.getTopLeft());t=t.getBottomRight();let o=r.padding;return Number.isFinite(o)||(o=0),s.y+o<=n.y&&n.y<=t.y-o?(r=n.y-e.y,e.x+=0===i||180===i?0:r/Math.tan(Ki.toRad(i)),e.y+=r):s.x+o<=n.x&&n.x<=t.x-o&&(r=n.x-e.x,e.y+=90===i||270===i?0:r*Math.tan(Ki.toRad(i)),e.x+=r),e})),xu=function(t,e,n,r,i){return t=t.cell.getConnectionPoint(this.cell,i),(r.dx||r.dy)&&t.translate(r.dx||0,r.dy||0),t};var wu;function Cu(t,e,n,r){return null!=(t=t.getClosestPoint(n))?t:new Js}const Pu=vu((function(t,e,n,r){let i,s,o=0;var a=t.cell;r.rotate?(i=t.getUnrotatedBBoxOfElement(e),s=a.getBBox().getCenter(),o=a.getAngle()):i=t.getBBoxOfElement(e),a=r.padding,null!=a&&Number.isFinite(a)&&i.inflate(a),r.rotate&&n.rotate(o,s),t=i.getNearestSideToPoint(n);let l;switch(t){case"left":l=i.getLeftMiddle();break;case"right":l=i.getRightMiddle();break;case"top":l=i.getTopCenter();break;case"bottom":l=i.getBottomCenter()}return e=r.direction,"H"===e?"top"!==t&&"bottom"!==t||(l=n.x<=i.x+i.width?i.getLeftMiddle():i.getRightMiddle()):"V"===e&&(l=n.y<=i.y+i.height?i.getTopCenter():i.getBottomCenter()),r.rotate?l.rotate(-o,s):l})),Au=((c=wu=wu||{}).presets=f,c.registry=Eo.create({type:"node endpoint"}),c.registry.register(c.presets,!0),function(t,e,n,r){let i=null!=r.ratio?r.ratio:.5;return 1<i&&(i/=100),t.getPointAtRatio(i)}),Eu=function(t,e,n,r){return r=null!=r.length?r.length:20,t.getPointAtLength(r)},Mu=vu(Cu);var Su,Ou,Tu,Nu,ku;const ju=vu((function(t,e,n,r){var i=t.getConnection(),s=t.getConnectionSubdivisions(),o=new Qs(n.clone().translate(0,1e6),n.clone().translate(0,-1e6)),a=new Qs(n.clone().translate(1e6,0),n.clone().translate(-1e6,0));o=o.intersect(i,{segmentSubdivisions:s}),a=a.intersect(i,{segmentSubdivisions:s}),i=[];return o&&i.push(...o),a&&i.push(...a),0<i.length?n.closest(i):null!=r.fallbackAt?yu(t,r.fallbackAt):M(Cu,this,t,e,n,r)}));function Lu(t,e,n){let r;var i,s;return null==(r="object"==typeof n?(Number.isFinite(n.y)&&(({start:s,end:i}=new Qs(e,t).parallel(n.y)),e=s,t=i),n.x):n)||!Number.isFinite(r)||(s=t.distance(e),0===r&&0<s)?t:t.move(e,-Math.min(r,s-1))}function Bu(t){return t=t.getAttribute("stroke-width"),null!==t&&parseFloat(t)||0}(be=Su=Su||{}).presets=m,be.registry=Eo.create({type:"edge endpoint"}),be.registry.register(be.presets,!0);const Ru=function(t,e,n,r){return e=e.getBBoxOfElement(n),r.stroked&&e.inflate(Bu(n)/2),n=t.intersect(e),Lu(n&&n.length?t.start.closest(n):t.end,t.start,r.offset)},Du=function(t,e,n,r,i){var s=e.cell;s=s.isNode()?s.getAngle():0;return 0===s?M(Ru,this,t,e,n,r,i):(i=e.getUnrotatedBBoxOfElement(n),r.stroked&&i.inflate(Bu(n)/2),e=i.getCenter(),Lu((i=(n=t.clone().rotate(s,e)).setLength(1e6).intersect(i))&&i.length?n.start.closest(i).rotate(-s,e):t.end,t.start,r.offset))},Iu=function(t,e,n,r){let i,s;var o=t.end,a=r.selector;if(!Rn(i="string"==typeof a?e.findOne(a):Array.isArray(a)?ft(n,a):function(t){if(null==t)return null;let e=t;do{let t=e.tagName;if("string"!=typeof t)return null;if("G"===(t=t.toUpperCase()))e=e.firstElementChild;else{if("TITLE"!==t)break;e=e.nextElementSibling}}while(e);return e}(n))){if(i===n||!Rn(n))return o;i=n}a=e.getShapeOfElement(i),n=e.getMatrixOfElement(i);var l=e.getRootTranslatedMatrix(),h=e.getRootRotatedMatrix();l=l.multiply(h).multiply(n),h=l.inverse(),n=fl.transformLine(t,h),h=n.start.clone(),e=e.getDataOfElement(i);if(!1===r.insideout){null==e.shapeBBox&&(e.shapeBBox=a.bbox());var u=e.shapeBBox;if(null!=u&&u.containsPoint(h))return o}let c;!0===r.extrapolate&&n.setLength(1e6),(s=Po.isPath(a)?(u=r.precision||2,null==e.segmentSubdivisions&&(e.segmentSubdivisions=a.getSegmentSubdivisions({precision:u})),c={precision:u,segmentSubdivisions:e.segmentSubdivisions},n.intersect(a,c)):n.intersect(a))?Array.isArray(s)&&(s=h.closest(s)):!0===r.sticky&&(s=_s.isRectangle(a)?a.getNearestPointToPoint(h):to.isEllipse(a)?a.intersectsWithLineFromCenterToPoint(h):a.closestPoint(h,c)),u=s?fl.transformPoint(s,l):o;let g=r.offset||0;return!1!==r.stroked&&("object"==typeof g?(null==(g=Object.assign({},g)).x&&(g.x=0),g.x+=Bu(i)/2):g+=Bu(i)/2),Lu(u,t.start,g)},Vu=function(t,e,n,r){var{alignOffset:i,align:s}=r;return s&&function(t,e,n=0){var{start:r,end:i}=t;let s,o,a,l;switch(e){case"left":l="x",s=i,o=r,a=-1;break;case"right":l="x",s=r,o=i,a=1;break;case"top":l="y",s=i,o=r,a=-1;break;case"bottom":l="y",s=r,o=i,a=1;break;default:return}r[l]<i[l]?s[l]=o[l]:o[l]=s[l],Number.isFinite(n)&&(s[l]+=a*n,o[l]+=a*n)}(t,s,i),Lu(t.end,t.start,r.offset)},zu=((g=Ou=Ou||{}).presets=v,g.registry=Eo.create({type:"connection point"}),g.registry.register(g.presets,!0),function(t){return[...t]}),Fu=function(t,e,n){var r=e.side||"bottom",i=(e=sn(e.padding||40),n.sourceBBox),s=(n=n.targetBBox,i.getCenter()),o=n.getCenter();let a,l,h;switch(r){case"top":h=-1,a="y",l="height";break;case"left":h=-1,a="x",l="width";break;case"right":h=1,a="x",l="width";break;default:h=1,a="y",l="height"}return s[a]+=h*(i[l]/2+e[r]),o[a]+=h*(n[l]/2+e[r]),0<h*(s[a]-o[a])?o[a]=s[a]:s[a]=o[a],[s.toJSON(),...t,o.toJSON()]};function $u(t){return new _s(t.x,t.y,0,0)}function Gu(t={}){return t=sn(t.padding||20),{x:-t.left,y:-t.top,width:t.left+t.right,height:t.top+t.bottom}}function qu(t,e={}){return t.sourceBBox.clone().moveAndExpand(Gu(e))}function Hu(t,e={}){return t.targetBBox.clone().moveAndExpand(Gu(e))}const Zu=function(t,e,n){let r=qu(n,e),i=Hu(n,e);[s,o={}]=[n,e];var s=s.sourceAnchor||qu(s,o).getCenter(),o=([o,n={}]=[n,e],o.targetAnchor||Hu(o,n).getCenter()),a=(r=r.union($u(s)),i=i.union($u(o)),t.map((t=>Js.create(t))));a.unshift(s),a.push(o);let l=null;var h=[];for(let p=0,f=a.length-1;p<f;p+=1){let t=null;var u,c=a[p],g=a[p+1],d=null!=Tu.getBearing(c,g);0===p?p+1===f?r.intersectsWithRect(i.clone().inflate(1))?t=Tu.insideNode(c,g,r,i):d||(t=Tu.nodeToNode(c,g,r,i)):r.containsPoint(g)?t=Tu.insideNode(c,g,r,$u(g).moveAndExpand(Gu(e))):d||(t=Tu.nodeToVertex(c,g,r)):p+1===f?(u=d&&Tu.getBearing(g,c)===l,i.containsPoint(c)||u?t=Tu.insideNode(c,g,$u(c).moveAndExpand(Gu(e)),i,l):d||(t=Tu.vertexToNode(c,g,i,l))):d||(t=Tu.vertexToVertex(c,g,l)),l=t?(h.push(...t.points),t.direction):Tu.getBearing(c,g),p+1<f&&h.push(g)}return h};{pe=Tu=Tu||{};const ld={N:"S",S:"N",E:"W",W:"E"},hd={N:-Math.PI/2*3,S:-Math.PI/2,E:0,W:Math.PI};function ud(t,e,n){let r=new Js(t.x,e.y);return n.containsPoint(r)?new Js(e.x,t.y):r}function cd(t,e){return t["W"===e||"E"===e?"width":"height"]}function gd(t,e){return t.x===e.x?t.y>e.y?"N":"S":t.y===e.y?t.x>e.x?"W":"E":null}function dd(t,e,n){var r=new Js(t.x,e.y),i=new Js(e.x,t.y),s=gd(t,r),o=(t=gd(t,i),n?ld[n]:null);s=s===n||s!==o&&(t===o||t!==n)?r:i;return{points:[s],direction:gd(s,e)}}function pd(t,e,n){return t=ud(t,e,n),{points:[t],direction:gd(t,e)}}pe.getBBoxSize=cd,pe.getBearing=gd,pe.vertexToVertex=dd,pe.nodeToVertex=pd,pe.vertexToNode=function(t,e,n,r){var i=[new Js(t.x,e.y),new Js(e.x,t.y)],s=i.filter((t=>!n.containsPoint(t))),o=s.filter((e=>gd(e,t)!==r));let a;return 0<o.length?{points:[a=(a=o.filter((e=>gd(t,e)===r)).pop())||o[0]],direction:gd(a,e)}:(a=te(i,s)[0],{points:[ud(o=Js.create(e).move(a,-cd(n,r)/2),t,n),o],direction:gd(o,e)})},pe.nodeToNode=function(t,e,n,r){let i=pd(e,t,r);var s,o=i.points[0];return n.containsPoint(o)&&(s=(i=pd(t,e,n)).points[0],r.containsPoint(s))&&(s=Js.create(t).move(s,-cd(n,gd(t,s))/2),r=Js.create(e).move(o,-cd(r,gd(e,o))/2),r=dd(o=new Qs(s,r).getCenter(),e,(s=pd(t,o,n)).direction),i.points=[s.points[0],r.points[0]],i.direction=r.direction),i},pe.insideNode=function(t,e,n,r,i){n=n.union(r).inflate(1);var s=(r=(r=n.getCenter()).distance(e)>r.distance(t))?e:t;t=r?t:e;let o,a,l;return o=i?(o=Js.fromPolar(n.width+n.height,hd[i],s),n.getNearestPointToPoint(o).move(o,-1)):n.getNearestPointToPoint(s).move(s,1),a=ud(o,t,n),l=o.round().equals(a.round())?(a=Js.fromPolar(n.width+n.height,Ki.toRad(o.theta(s))+Math.PI/2,t),a=n.getNearestPointToPoint(a).move(t,1).round(),i=ud(o,a,n),r?[a,i,o]:[o,i,a]):r?[a,o]:[o,a],s=gd(r?o:a,e),{points:l,direction:s}}}const Uu={step:10,maxLoopCount:2e3,precision:1,maxDirectionChange:90,perpendicular:!0,excludeTerminals:[],excludeNodes:[],excludeShapes:[],startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},cost(){return Ju(this.step,this)},directions(){var t=Ju(this.step,this),e=Ju(this.cost,this);return[{cost:e,offsetX:t,offsetY:0},{cost:e,offsetX:-t,offsetY:0},{cost:e,offsetX:0,offsetY:t},{cost:e,offsetX:0,offsetY:-t}]},penalties(){var t=Ju(this.step,this);return{0:0,45:t/2,90:t/2}},paddingBox(){var t=Ju(this.step,this);return{x:-t,y:-t,width:2*t,height:2*t}},fallbackRouter:Zu,draggingRouter:null,snapToGrid:!0};function Ju(t,e){return"function"==typeof t?t.call(e):t}class Wu{constructor(){this.items=[],this.hash={},this.values={}}add(t,e){this.hash[t]?this.items.splice(this.items.indexOf(t),1):this.hash[t]=1,this.values[t]=e,e=Nt(this.items,t,(t=>this.values[t])),this.items.splice(e,0,t)}pop(){var t=this.items.shift();return t&&(this.hash[t]=2),t}isOpen(t){return 1===this.hash[t]}isClose(t){return 2===this.hash[t]}isEmpty(){return 0===this.items.length}}class Xu{constructor(t){this.options=t,this.mapGridSize=100,this.map={}}build(t,e){const n=this.options,r=n.excludeTerminals.reduce(((n,r)=>{r=e[r];return r&&(r=t.getCell(r.cell))&&n.push(r),n}),[]);let i=[];var s=t.getCell(e.getSourceCellId());s&&(i=wt.Z(i,s.getAncestors().map((t=>t.id)))),s=t.getCell(e.getTargetCellId());s&&(i=wt.Z(i,s.getAncestors().map((t=>t.id))));const o=this.mapGridSize;return t.getNodes().reduce(((t,e)=>{var s=r.some((t=>t.id===e.id)),a=!!e.shape&&n.excludeShapes.includes(e.shape),l=n.excludeNodes.some((t=>"string"==typeof t?e.id===t:t===e)),h=i.includes(e.id);a=a||s||l||h;if(e.isVisible()&&!a){var u=e.getBBox().moveAndExpand(n.paddingBox),c=u.getOrigin().snapToGrid(o),g=u.getCorner().snapToGrid(o);for(let e=c.x;e<=g.x;e+=o)for(let n=c.y;n<=g.y;n+=o){var d=new Js(e,n).toString();null==t[d]&&(t[d]=[]),t[d].push(u)}}return t}),this.map),this}isAccessible(t){var e=t.clone().snapToGrid(this.mapGridSize).toString();e=this.map[e];return!e||e.every((e=>!e.containsPoint(t)))}}function Yu(t,e){return t=t.sourceBBox.clone(),e&&e.paddingBox?t.moveAndExpand(e.paddingBox):t}function _u(t,e){return t=t.targetBBox.clone(),e&&e.paddingBox?t.moveAndExpand(e.paddingBox):t}function Ku(t,e){return t.sourceAnchor||Yu(t,e).getCenter()}function Qu(t,e,n,r,i){var s,o;n=360/n,r=t.theta((s=r,i=i.step,o=e.x-t.x,e=e.y-t.y,o/=r.x,e/=r.y,s=o*i,o=e*i,new Js(t.x+s,t.y+o))),e=Ki.normalize(r+n/2);return n*Math.floor(e/n)}function tc(t,e){return t=Math.abs(t-e),180<t?360-t:t}function ec(t,e){var n;return t?(t=Math.abs(t),(n=Math.round(t/e))?e+(t-n*e)/n:t):e}function nc(t,e){return t.round(e)}function rc(t,e,n){return nc((t=t.clone(),r=e.source,i=Qi.snapToGrid(t.x-r.x,e.x)+r.x,t=Qi.snapToGrid(t.y-r.y,e.y)+r.y,new Js(i,t)),n);var r,i}function ic(t){return t.toString()}function sc(t){return new Js(0===t.x?0:Math.abs(t.x)/t.x,0===t.y?0:Math.abs(t.y)/t.y)}function oc(t,e){let n=1/0;for(let i=0,s=e.length;i<s;i+=1){var r=t.manhattanDistance(e[i]);r<n&&(n=r)}return n}function ac(t,e,n,r,i){const s=i.precision,o=i.directionMap,a=t.diff(e.getCenter());return i=Object.keys(o).reduce(((i,l)=>{if(n.includes(l)){l=o[l];var h=new Js(t.x+l.x*(Math.abs(a.x)+e.width),t.y+l.y*(Math.abs(a.y)+e.height)),u=new Qs(t,h).intersect(e)||[];let n,d=null;for(let e=0;e<u.length;e+=1){var c=u[e],g=t.squaredDistance(c);(null==n||g>n)&&(n=g,d=c)}if(d){let t=rc(d,r,s);e.containsPoint(t)&&(t=rc(t.translate(l.x*r.x,l.y*r.y),r,s)),i.push(t)}}return i}),[]),e.containsPoint(t)||i.push(rc(t,r,s)),i}function lc(t,e,n,r,i){var s=i.precision;let o,a;o=_s.isRectangle(e)?nc(Ku(t,i).clone(),s):nc(e.clone(),s),a=_s.isRectangle(n)?nc((l=i,(t.targetAnchor||_u(t,l).getCenter()).clone()),s):nc(n.clone(),s),t=i.step,l=o,h=a;var l,h,u={source:l.clone(),x:ec(h.x-l.x,t),y:ec(h.y-l.y,t)};const c=o;var g=a;let d,p;if(d=_s.isRectangle(e)?ac(c,e,i.startDirections,u,i):[c],p=_s.isRectangle(n)?ac(a,n,i.endDirections,u,i):[g],d=d.filter((t=>r.isAccessible(t))),p=p.filter((t=>r.isAccessible(t))),0<d.length&&0<p.length){var f=new Wu,m={},v={},y={};for(let e=0,n=d.length;e<n;e+=1){const t=d[e];var b=ic(t);f.add(b,oc(t,p)),m[b]=t,y[b]=0}var x=i.previousDirectionAngle,w=void 0===x,C=function(t,e){const n=e.step;return e.directions.forEach((e=>{e.gridOffsetX=e.offsetX/n*t.x,e.gridOffsetY=e.offsetY/n*t.y})),e.directions}(u,i),P=C.length,A=p.reduce(((t,e)=>(e=ic(e),t.push(e),t)),[]),E=Js.equalPoints(d,p);let t=i.maxLoopCount;for(;!f.isEmpty()&&0<t;){var S=f.pop(),O=m[S],T=v[S],N=y[S],k=O.equals(c),j=null==T;let e;if(e=j?w?k?null:Qu(c,O,P,u,i):x:Qu(T,O,P,u,i),(!j||!E)&&0<=A.indexOf(S)){i.previousDirectionAngle=e;{var L=v,B=m;T=O,j=c,S=g;var R=[];let t=sc(S.diff(T)),e=ic(T),n=L[e];for(;n;){var D,I=sc((D=B[e]).diff(n));I.equals(t)||(R.unshift(D),t=I),e=ic(n),n=L[e]}return sc((S=B[e]).diff(j)).equals(t)||R.unshift(S),R}}for(let t=0;t<P;t+=1){var V,z=(V=C[t]).angle,F=tc(e,z);if(w&&k||!(F>i.maxDirectionChange)){var $=rc(O.clone().translate(V.gridOffsetX||0,V.gridOffsetY||0),u,s),G=ic($);if(!f.isClose(G)&&r.isAccessible($)){if(0<=A.indexOf(G)){var q=$.equals(g);if(!q&&tc(z,Qu($,g,P,u,i))>i.maxDirectionChange)continue}q=N+V.cost+(k?0:i.penalties[F]),(!f.isOpen(G)||q<y[G])&&(m[G]=$,v[G]=O,f.add(G,(y[G]=q)+oc($,p)))}}}--t}}return i.fallbackRoute?M(i.fallbackRoute,this,c,g,i):null}function hc(t,e,n){r=e,(e=Object.keys(r).reduce(((t,e)=>{var n=t;return n[e]="fallbackRouter"===e||"draggingRouter"===e||"fallbackRoute"===e?r[e]:Ju(r[e],r),t}),{})).padding&&(i=sn(e.padding),e.paddingBox={x:-i.left,y:-i.top,width:i.left+i.right,height:i.top+i.bottom}),e.directions.forEach((t=>{var e=new Js(0,0),n=new Js(t.offsetX,t.offsetY);t.angle=Ki.normalize(e.theta(n))}));var r,i,s=e,o=Yu(n,s),a=_u(n,s),l=Ku(n,s),h=new Xu(s).build(n.graph.model,n.cell),u=t.map((t=>Js.create(t))),c=[];let g,d=l;for(let C=0,P=u.length;C<=P;C+=1){let e=null;var p,f=g||o;if(null==(g=u[C])&&(g=a,null==(m=n.cell).getSourceCellId()||null==m.getTargetCellId())&&"function"==typeof s.draggingRouter&&(m=f===o?l:f,p=g.getOrigin(),e=M(s.draggingRouter,n,m,p,s)),null===(e=null==e?lc(n,f,g,h,s):e))return M(s.fallbackRouter,this,t,s,n);var m=e[0];m&&m.equals(d)&&e.shift(),d=e[e.length-1]||d,c.push(...e)}if(s.snapToGrid){var[v,y=10]=[c,n.graph.grid.getGridSize()];if(!(v.length<=1))for(let t=0,e=v.length;t<e-1;t+=1){var b,x=v[t],w=v[t+1];x.x===w.x?(b=y*Math.round(x.x/y),x.x!==b&&(x.x=b,w.x=b)):x.y===w.y&&(b=y*Math.round(x.y/y),x.y!==b)&&(x.y=b,w.y=b)}return v}return c}const uc=function(t,e,n){return M(hc,this,t,Object.assign(Object.assign({},Uu),e),n)},cc={maxDirectionChange:45,directions(){var t=Ju(this.step,this),e=Ju(this.cost,this),n=Math.ceil(Math.sqrt(t*t<<1));return[{cost:e,offsetX:t,offsetY:0},{cost:n,offsetX:t,offsetY:t},{cost:e,offsetX:0,offsetY:t},{cost:n,offsetX:-t,offsetY:t},{cost:e,offsetX:-t,offsetY:0},{cost:n,offsetX:-t,offsetY:-t},{cost:e,offsetX:0,offsetY:-t},{cost:n,offsetX:t,offsetY:-t}]},fallbackRoute(t,e,n){var r=t.theta(e),i=[];let s={x:e.x,y:t.y},o={x:t.x,y:e.y};90<r%180&&(a=s,s=o,o=a);var a=r%90<45?s:o,l=new Qs(t,a);r=90*Math.ceil(r/90),r=Js.fromPolar(l.squaredLength(),Ki.toRad(135+r),a),a=new Qs(e,r),r=l.intersectsWithLine(a),l=r||e,a=r?l:t,r=360/n.directions.length,t=a.theta(e),a=Ki.normalize(t+r/2),t=r*Math.floor(a/r);return n.previousDirectionAngle=t,l&&i.push(l.round()),i.push(e),i}},gc=function(t,e,n){return M(uc,this,t,Object.assign(Object.assign({},cc),e),n)},dc=function(t,e,n){var r=e.offset||32,i=null==e.min?16:e.min;let s=0,o=e.direction;e=n.sourceBBox,n=n.targetBBox;var a=e.getCenter(),l=n.getCenter();if("number"==typeof r&&(s=r),null==o){let t=n.left-e.right,r=n.top-e.bottom;o=0<=t&&0<=r?t>=r?"L":"T":t<=0&&0<=r?0<=(t=e.left-n.right)&&t>=r?"R":"T":0<=t&&r<=0?!(0<=(r=e.top-n.bottom))||t>=r?"L":"B":(t=e.left-n.right,r=e.top-n.bottom,0<=t&&0<=r?t>=r?"R":"B":t<=0&&0<=r||!(0<=t&&r<=0||Math.abs(t)>Math.abs(r))?"B":"R")}let h,u,c;if("H"===o?o=0<=l.x-a.x?"L":"R":"V"===o&&(o=0<=l.y-a.y?"T":"B"),"center"===r&&("L"===o?s=(n.left-e.right)/2:"R"===o?s=(e.left-n.right)/2:"T"===o?s=(n.top-e.bottom)/2:"B"===o&&(s=(e.top-n.bottom)/2)),r="L"===o||"R"===o,r){if(l.y===a.y)return[...t];c="L"===o?1:-1,h="x",u="width"}else{if(l.x===a.x)return[...t];c="T"===o?1:-1,h="y",u="height"}var g,d,p,f=a.clone(),m=l.clone();return f[h]+=c*(e[u]/2+s),m[h]-=c*(n[u]/2+s),r?(r=f.x,g=m.x,d=e.width/2+i,p=n.width/2+i,l.x>a.x?g<=r&&(f.x=Math.max(g,a.x+d),m.x=Math.min(r,l.x-p)):r<=g&&(f.x=Math.min(g,a.x-d),m.x=Math.max(r,l.x+p))):(g=f.y,d=m.y,r=e.height/2+i,p=n.height/2+i,l.y>a.y?d<=g&&(f.y=Math.max(d,a.y+r),m.y=Math.min(g,l.y-p)):g<=d&&(f.y=Math.min(d,a.y-r),m.y=Math.max(g,l.y+p))),[f.toJSON(),...t,m.toJSON()]};function pc(t,e){var n;return null!=e&&!1!==e?0<(e="boolean"==typeof e?0:e)?(n=Js.create(t[1]).move(t[2],e),e=Js.create(t[1]).move(t[0],e),[n.toJSON(),...t,e.toJSON()]):(n=t[1],[Object.assign({},n),...t,Object.assign({},n)]):t}const fc=function(t,e,n){const r=e.width||50,i=(e.height||80)/2;var s=e.angle||"auto";const o=n.sourceAnchor;var a=n.targetAnchor;const l=n.sourceBBox;var h=n.targetBBox;if(o.equals(a)){var u=t=>{t=Ki.toRad(t);var e=Math.sin(t),n=(t=Math.cos(t),new Js(o.x+t*r,o.y+e*r));t=new Js(n.x-t*i,n.y-e*i),e=t.clone().rotate(-90,n),t=t.clone().rotate(90,n);return[e.toJSON(),n.toJSON(),t.toJSON()]},c=t=>{var e=o.clone().move(t,-1);e=new Qs(e,t);return!l.containsPoint(t)&&!l.intersectsWithLine(e)},g=[0,90,180,270,45,135,225,315];if("number"==typeof s)return pc(u(s),e.merge);if(s=l.getCenter(),s.equals(o))return pc(u(0),e.merge);var d=s.angleBetween(o,s.clone().translate(1,0));let t=u(d);if(!c(t[1]))for(let n=1,r=g.length;n<r;n+=1)if(c((t=u(d+g[n]))[1]))return pc(t,e.merge);return pc(t,e.merge)}{s=new Qs(o,a);let t=s.parallel(-r),u=t.getCenter(),c=t.start.clone().move(t.end,i),g=t.end.clone().move(t.start,i);var p=s.parallel(-1),f=new Qs(p.start,u);p=new Qs(p.end,u);return(l.containsPoint(u)||h.containsPoint(u)||l.intersectsWithLine(f)||l.intersectsWithLine(p)||h.intersectsWithLine(f)||h.intersectsWithLine(p))&&(t=s.parallel(r),u=t.getCenter(),c=t.start.clone().move(t.end,i),g=t.end.clone().move(t.start,i)),e.merge&&(f=new Qs(o,a),p=new Qs(u,f.center).setLength(Number.MAX_SAFE_INTEGER),s=l.intersectsWithLine(p),a=h.intersectsWithLine(p),h=s?Array.isArray(s)?s:[s]:[],a&&(Array.isArray(a)?h.push(...a):h.push(a)),(p=f.center.closest(h))?(n.sourceAnchor=p.clone(),n.targetAnchor=p.clone()):(n.sourceAnchor=f.center.clone(),n.targetAnchor=f.center.clone())),pc([c.toJSON(),u.toJSON(),g.toJSON()],e.merge)}},mc=((d=Nu=Nu||{}).presets=y,d.registry=Eo.create({type:"router"}),d.registry.register(d.presets,!0),function(t,e,n,r={}){return t=[t,...n,e],n=new lo(t),e=new Po(n),r.raw?e:e.serialize()}),vc=function(t,e,n,r={}){var i=3===n.length?0:1,s=Js.create(n[0+i]),o=Js.create(n[2+i]),a=(n=Js.create(n[1+i]),Js.equals(t,e)||1<(a=(i=new Js((t.x+e.x)/2,(t.y+e.y)/2)).angleBetween(Js.create(t).rotate(90,i),n))&&(s.rotate(180-a,i),o.rotate(180-a,i),n.rotate(180-a,i)),`\n     M ${t.x} ${t.y}\n     Q ${s.x} ${s.y} ${n.x} ${n.y}\n     Q ${o.x} ${o.y} ${e.x} ${e.y}\n  `);return r.raw?Po.parse(a):a},yc=function(t,e,n,r={}){var i=new Po,s=(i.appendSegment(Po.createSegment("M",t)),r.radius||10);let o;for(let g=0,d=n.length;g<d;g+=1){var a=Js.create(n[g]),l=n[g-1]||t,h=n[g+1]||e,u=o||a.distance(l)/2,c=(u=(o=a.distance(h)/2,-Math.min(s,u)),-Math.min(s,o));l=a.clone().move(l,u).round(),u=a.clone().move(h,c).round(),h=new Js(1/3*l.x+2/3*a.x,2/3*a.y+1/3*l.y),c=new Js(1/3*u.x+2/3*a.x,2/3*a.y+1/3*u.y);i.appendSegment(Po.createSegment("L",l)),i.appendSegment(Po.createSegment("C",h,c,u))}return i.appendSegment(Po.createSegment("L",e)),r.raw?i:i.serialize()},bc=function(t,e,n,r={}){let i,s=r.direction;return n&&0!==n.length?(n=[t,...n,e],n=ho.throughPoints(n),i=new Po(n)):((i=new Po).appendSegment(Po.createSegment("M",t)),"H"===(s=s||(Math.abs(t.x-e.x)>=Math.abs(t.y-e.y)?"H":"V"))?(n=(t.x+e.x)/2,i.appendSegment(Po.createSegment("C",n,t.y,n,e.y,e.x,e.y))):(n=(t.y+e.y)/2,i.appendSegment(Po.createSegment("C",t.x,n,e.x,n,e.x,e.y)))),r.raw?i:i.serialize()},xc=1,wc=1/3,Cc=2/3;function Pc(t,e,n=[]){const r=[t,...n,e],i=[];return r.forEach(((t,e)=>{e=r[e+1],null!=e&&i.push(new Qs(t,e))})),i}function Ac(t,e){return new Qs(t,e).squaredLength()}function Ec(t,e,n,r){const i=new Po;let s;return s=Po.createSegment("M",t[0].start),i.appendSegment(s),t.forEach(((o,a)=>{if(Mc.includes(o)){let t,r,a,u;if("arc"===n){t=-90,((r=o.start.diff(o.end)).x<0||0===r.x&&r.y<0)&&(t+=180);var l=o.getCenter(),h=new Qs(l,o.end).rotate(t,l);let e;e=new Qs(o.start,l),a=e.pointAt(2/3).rotate(t,o.start),u=h.pointAt(1/3).rotate(-t,h.end),s=Po.createSegment("C",a,u,h.end),i.appendSegment(s),e=new Qs(l,o.end),a=h.pointAt(1/3).rotate(t,h.end),u=e.pointAt(1/3).rotate(-t,o.end),s=Po.createSegment("C",a,u,o.end),i.appendSegment(s)}else if("gap"===n)s=Po.createSegment("M",o.end),i.appendSegment(s);else if("cubic"===n){t=o.start.theta(o.end),l=.6*e;let n=1.35*e;((r=o.start.diff(o.end)).x<0||0===r.x&&r.y<0)&&(n*=-1),a=new Js(o.start.x+l,o.start.y+n).rotate(t,o.start),u=new Js(o.end.x-l,o.end.y+n).rotate(t,o.end),s=Po.createSegment("C",a,u,o.end),i.appendSegment(s)}}else h=t[a+1],0===r||!h||Mc.includes(h)?(s=Po.createSegment("L",o.end),i.appendSegment(s)):(l=r,a=i,u=o.end,o=o.start,h=h.end,c=u.distance(o)/2,g=u.distance(h)/2,c=-Math.min(l,c),l=-Math.min(l,g),g=u.clone().move(o,c).round(),o=u.clone().move(h,l).round(),c=new Js(wc*g.x+Cc*u.x,Cc*u.y+wc*g.y),h=new Js(wc*o.x+Cc*u.x,Cc*u.y+wc*o.y),l=Po.createSegment("L",g),a.appendSegment(l),l=Po.createSegment("C",c,h,o),a.appendSegment(l));var u,c,g})),i}let Mc,Sc;const Oc=function(t,e,n,r={}){Mc=[],Sc=[];{var i=this;let t=i.graph._jumpOverUpdateList;null==t&&(t=i.graph._jumpOverUpdateList=[],i.graph.on("cell:mouseup",(()=>{const t=i.graph._jumpOverUpdateList;setTimeout((()=>{for(let e=0;e<t.length;e+=1)t[e].update()}))})),i.graph.on("model:reseted",(()=>{t=i.graph._jumpOverUpdateList=[]}))),t.indexOf(i)<0&&(t.push(i),i.cell.once("change:connector",o=()=>t.splice(t.indexOf(i),1)),i.cell.once("removed",o))}const s=r.size||5;var o=r.type||"arc",a=r.radius||0;const l=r.ignoreConnectors||["smooth"],h=this.graph;var u=h.model.getEdges();if(1===u.length)return Ec(Pc(t,e,n),s,o,a);const c=this.cell,g=u.indexOf(c),d=h.options.connecting.connector||{},p=u.filter(((t,e)=>(t=t.getConnector()||d,!(l.includes(t.name)||e>g&&"jumpover"===t.name))));u=p.map((t=>h.findViewByCell(t)));const f=Pc(t,e,n),m=u.map((t=>null==t?[]:t===this?f:Pc(t.sourcePoint,t.targetPoint,t.routePoints))),v=[];return f.forEach((t=>{var e,n,r,i=p.reduce(((e,n,r)=>(n!==c&&(n=function(t,e){const n=[];return e.forEach((e=>{e=t.intersectsWithLine(e),e&&n.push(e)})),n}(t,m[r]),e.push(...n)),e)),[]).sort(((e,n)=>Ac(t.start,e)-Ac(t.start,n)));0<i.length?v.push(...(e=t,n=i,r=s,n.reduce(((t,i,s)=>{if(!Sc.includes(i)){var o=t.pop()||e,a=Js.create(i).move(o.start,-r);let l=Js.create(i).move(o.start,+r);if(i=n[s+1],null!=i){s=l.distance(i);s<=r&&(l=i.move(o.start,s),Sc.push(i))}else if(a.distance(o.end)<2*r+xc)return t.push(o),t;l.distance(o.start)<2*r+xc?t.push(o):(s=new Qs(a,l),Mc.push(s),t.push(new Qs(o.start,a),s,new Qs(l,o.end)))}return t}),[]))):v.push(t)})),t=Ec(v,s,o,a),Mc=[],Sc=[],r.raw?t:t.serialize()};(me=ku=ku||{}).presets=b,me.registry=Eo.create({type:"connector"}),me.registry.register(me.presets,!0);class Tc extends yt{constructor(t={}){super(),this.pending=!1,this.changing=!1,this.data={},this.mutate(_.Z(t)),this.changed={}}mutate(t,e={}){const n=!0===e.unset;var r=!0===e.silent;const i=[];var s=this.changing;this.changing=!0,s||(this.previous=_.Z(this.data),this.changed={});const o=this.data,a=this.previous,l=this.changed;if(Object.keys(t).forEach((e=>{var r=t[e];I.Z(o[e],r)||i.push(e),I.Z(a[e],r)?delete l[e]:l[e]=r,n?delete o[e]:o[e]=r})),!r&&0<i.length&&(this.pending=!0,this.pendingOptions=e,i.forEach((t=>{this.emit("change:*",{key:t,options:e,store:this,current:o[t],previous:a[t]})}))),!s){if(!r)for(;this.pending;)this.pending=!1,this.emit("changed",{current:o,previous:a,store:this,options:this.pendingOptions});this.pending=!1,this.changing=!1,this.pendingOptions=null}return this}get(t,e){return null==t?this.data:null==(t=this.data[t])?e:t}getPrevious(t){return this.previous&&null!=(t=this.previous[t])?t:void 0}set(t,e,n){return null!=t&&("object"==typeof t?this.mutate(t,e):this.mutate({[t]:e},n)),this}remove(t,e){const n={};let r;if("string"==typeof t)n[t]=void 0,r=e;else if(Array.isArray(t))t.forEach((t=>n[t]=void 0)),r=e;else{for(const t in this.data)n[t]=void 0;r=t}return this.mutate(n,Object.assign(Object.assign({},r),{unset:!0})),this}getByPath(t){return ft(this.data,t,"/")}setByPath(t,e,n={}){var r=Array.isArray(t)?[...t]:t.split("/"),i=Array.isArray(t)?t.join("/"):t,s=r[0],o=r.length;if(n.propertyPath=i,n.propertyValue=e,n.propertyPathArray=r,1===o)this.set(s,e,n);else{i={};let h=i,u=s;for(let t=1;t<o;t+=1){var a=r[t],l=Number.isFinite(Number(a));h=h[u]=l?[]:{},u=a}mt(i,r,e,"/"),e=_.Z(this.data),n.rewrite&&vt(e,t,"/"),t=D.Z(e,i),this.set(s,t[s],n)}return this}removeByPath(t,e){t=Array.isArray(t)?t:t.split("/");var n,r=t[0];return 1===t.length?this.remove(r,e):(t=t.slice(1),(n=_.Z(this.get(r)))&&vt(n,t),this.set(r,n,e)),this}hasChanged(t){return null==t?0<Object.keys(this.changed).length:t in this.changed}getChanges(t){if(null==t)return this.hasChanged()?_.Z(this.changed):null;var e=this.changing?this.previous:this.data,n={};let r;for(const s in t){var i=t[s];I.Z(e[s],i)||(n[s]=i,r=!0)}return r?_.Z(n):null}toJSON(){return _.Z(this.data)}clone(){return new this.constructor(this.data)}dispose(){this.off(),this.data={},this.previous={},this.changed={},this.pending=!1,this.changing=!1,this.pendingOptions=null,this.trigger("disposed",{store:this})}}(function(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(o=(s<3?i(o):3<s?i(e,n,o):i(e,n))||o);3<s&&o&&Object.defineProperty(e,n,o)})([yt.dispose()],Tc.prototype,"dispose",null);class Nc{constructor(t){this.cell=t,this.ids={},this.cache={}}get(){return Object.keys(this.ids)}start(t,e,n={},r="/"){const i=this.cell.getPropByPath(t),s=it(n,Nc.defaultOptions),o=this.getTiming(s.timing),a=this.getInterp(s.interp,i,e);let l=0;const h=Array.isArray(t)?t.join(r):t,u=Array.isArray(t)?t:t.split(r),c=()=>{var t=(new Date).getTime();let e=(t-(l=0===l?t:l))/s.duration;e<1?this.ids[h]=requestAnimationFrame(c):e=1,t=a(o(e)),this.cell.setPropByPath(u,t),n.progress&&n.progress(Object.assign({progress:e,currentValue:t},this.getArgs(h))),1===e&&(this.cell.notify("transition:complete",this.getArgs(h)),n.complete&&n.complete(this.getArgs(h)),this.cell.notify("transition:finish",this.getArgs(h)),n.finish&&n.finish(this.getArgs(h)),this.clean(h))};return setTimeout((()=>{this.stop(t,void 0,r),this.cache[h]={startValue:i,targetValue:e,options:s},this.ids[h]=requestAnimationFrame(c),this.cell.notify("transition:start",this.getArgs(h)),n.start&&n.start(this.getArgs(h))}),n.delay),this.stop.bind(this,t,r,n)}stop(t,e={},n="/"){const r=Array.isArray(t)?t:t.split(n);return Object.keys(this.ids).filter((t=>I.Z(r,t.split(n).slice(0,r.length)))).forEach((t=>{cancelAnimationFrame(this.ids[t]);var n=this.cache[t],r=this.getArgs(t),i=Object.assign(Object.assign({},n.options),e),s=i.jumpedToEnd;s&&null!=n.targetValue&&(this.cell.setPropByPath(t,n.targetValue),this.cell.notify("transition:end",Object.assign({},r)),this.cell.notify("transition:complete",Object.assign({},r)),i.complete)&&i.complete(Object.assign({},r)),n=Object.assign({jumpedToEnd:s},r);this.cell.notify("transition:stop",Object.assign({},n)),i.stop&&i.stop(Object.assign({},n)),this.cell.notify("transition:finish",Object.assign({},r)),i.finish&&i.finish(Object.assign({},r)),this.clean(t)})),this}clean(t){delete this.ids[t],delete this.cache[t]}getTiming(t){return"string"==typeof t?Yi[t]:t}getInterp(t,e,n){return t?t(e,n):"number"==typeof n?_i.number(e,n):"string"==typeof n?"#"===n[0]?_i.color(e,n):_i.unit(e,n):_i.object(e,n)}getArgs(t){var e=this.cache[t];return{path:t,startValue:e.startValue,targetValue:e.targetValue,cell:this.cell}}}(Nc=Nc||{}).defaultOptions={delay:10,duration:100,timing:"linear"};ve=function(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(o=(s<3?i(o):3<s?i(e,n,o):i(e,n))||o);return 3<s&&o&&Object.defineProperty(e,n,o),o};var kc,jc,Lc,Bc,Rc=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};class Dc extends yt{static config(t){var{markup:e,propHooks:n,attrHooks:r}=t;t=Rc(t,["markup","propHooks","attrHooks"]);null!=e&&(this.markup=e),n&&(this.propHooks=this.propHooks.slice(),Array.isArray(n)?this.propHooks.push(...n):"function"==typeof n?this.propHooks.push(n):Object.values(n).forEach((t=>{"function"==typeof t&&this.propHooks.push(t)}))),r&&(this.attrHooks=Object.assign(Object.assign({},this.attrHooks),r)),this.defaults=D.Z({},this.defaults,t)}static getMarkup(){return this.markup}static getDefaults(t){return t?this.defaults:_.Z(this.defaults)}static getAttrHooks(){return this.attrHooks}static applyPropHooks(t,e){return this.propHooks.reduce(((e,n)=>n?M(n,t,e):e),e)}get[Symbol.toStringTag](){return Dc.toStringTag}constructor(t={}){super();var e=this.constructor.getDefaults(!0);e=D.Z({},this.preprocess(e),this.preprocess(t));this.id=e.id||Je(),this.store=new Tc(e),this.animation=new Nc(this),this.setup(),this.init(),this.postprocess(t)}init(){}get model(){return this._model}set model(t){this._model!==t&&(this._model=t)}preprocess(t,e){var n=t.id;t=this.constructor.applyPropHooks(this,t);return null==n&&!0!==e&&(t.id=Je()),t}postprocess(t){}setup(){this.store.on("change:*",(t=>{var{key:t,current:e,previous:n,options:r}=t;this.notify("change:*",{key:t,options:r,current:e,previous:n,cell:this}),this.notify("change:"+t,{options:r,current:e,previous:n,cell:this}),"source"!==t&&"target"!==t||this.notify("change:terminal",{type:t,current:e,previous:n,options:r,cell:this})})),this.store.on("changed",(({options:t})=>this.notify("changed",{options:t,cell:this})))}notify(t,e){this.trigger(t,e);var n=this.model;return n&&(n.notify("cell:"+t,e),this.isNode()?n.notify("node:"+t,Object.assign(Object.assign({},e),{node:this})):this.isEdge()&&n.notify("edge:"+t,Object.assign(Object.assign({},e),{edge:this}))),this}isNode(){return!1}isEdge(){return!1}isSameStore(t){return this.store===t.store}get view(){return this.store.get("view")}get shape(){return this.store.get("shape","")}getProp(t,e){return null==t?this.store.get():this.store.get(t,e)}setProp(t,e,n){return"string"==typeof t?this.store.set(t,e,n):(n=this.preprocess(t,!0),this.store.set(D.Z({},this.getProp(),n),e),this.postprocess(t)),this}removeProp(t,e){return"string"==typeof t||Array.isArray(t)?this.store.removeByPath(t,e):this.store.remove(e),this}hasChanged(t){return null==t?this.store.hasChanged():this.store.hasChanged(t)}getPropByPath(t){return this.store.getByPath(t)}setPropByPath(t,e,n={}){return this.model&&("children"===t?this._children=e?e.map((t=>this.model.getCell(t))).filter((t=>null!=t)):null:"parent"===t&&(this._parent=e?this.model.getCell(e):null)),this.store.setByPath(t,e,n),this}removePropByPath(t,e={}){return t=Array.isArray(t)?t:t.split("/"),"attrs"===t[0]&&(e.dirty=!0),this.store.removeByPath(t,e),this}prop(t,e,n){return null==t?this.getProp():"string"==typeof t||Array.isArray(t)?1===arguments.length?this.getPropByPath(t):null==e?this.removePropByPath(t,n||{}):this.setPropByPath(t,e,n||{}):this.setProp(t,e||{})}previous(t){return this.store.getPrevious(t)}get zIndex(){return this.getZIndex()}set zIndex(t){null==t?this.removeZIndex():this.setZIndex(t)}getZIndex(){return this.store.get("zIndex")}setZIndex(t,e={}){return this.store.set("zIndex",t,e),this}removeZIndex(t={}){return this.store.remove("zIndex",t),this}toFront(t={}){var e=this.model;if(e){let r,i=e.getMaxZIndex();t.deep?(r=this.getDescendants({deep:!0,breadthFirst:!0})).unshift(this):r=[this],i=i-r.length+1;var n=e.total();let s=e.indexOf(this)!==n-r.length;(s=s||r.some(((t,e)=>t.getZIndex()!==i+e)))&&this.batchUpdate("to-front",(()=>{i+=r.length,r.forEach(((e,n)=>{e.setZIndex(i+n,t)}))}))}return this}toBack(t={}){var e=this.model;if(e){let n,r=e.getMinZIndex(),i=(t.deep?(n=this.getDescendants({deep:!0,breadthFirst:!0})).unshift(this):n=[this],0!==e.indexOf(this));(i=i||n.some(((t,e)=>t.getZIndex()!==r+e)))&&this.batchUpdate("to-back",(()=>{r-=n.length,n.forEach(((e,n)=>{e.setZIndex(r+n,t)}))}))}return this}get markup(){return this.getMarkup()}set markup(t){null==t?this.removeMarkup():this.setMarkup(t)}getMarkup(){let t=this.store.get("markup");var e;return null==t&&(e=this.constructor,t=e.getMarkup()),t}setMarkup(t,e={}){return this.store.set("markup",t,e),this}removeMarkup(t={}){return this.store.remove("markup",t),this}get attrs(){return this.getAttrs()}set attrs(t){null==t?this.removeAttrs():this.setAttrs(t)}getAttrs(){var t=this.store.get("attrs");return t?Object.assign({},t):{}}setAttrs(t,e={}){var n,r;return null==t?this.removeAttrs(e):(n=t=>this.store.set("attrs",t,e),!0===e.overwrite?n(t):(r=this.getAttrs(),!1===e.deep?n(Object.assign(Object.assign({},r),t)):n(D.Z({},r,t)))),this}replaceAttrs(t,e={}){return this.setAttrs(t,Object.assign(Object.assign({},e),{overwrite:!0}))}updateAttrs(t,e={}){return this.setAttrs(t,Object.assign(Object.assign({},e),{deep:!1}))}removeAttrs(t={}){return this.store.remove("attrs",t),this}getAttrDefinition(t){if(!t)return null;var e=this.constructor.getAttrHooks()||{};let n=e[t]||pl.registry.get(t);return n||(t=Fe(t),n=e[t]||pl.registry.get(t)),n||null}getAttrByPath(t){return null==t||""===t?this.getAttrs():this.getPropByPath(this.prefixAttrPath(t))}setAttrByPath(t,e,n={}){return this.setPropByPath(this.prefixAttrPath(t),e,n),this}removeAttrByPath(t,e={}){return this.removePropByPath(this.prefixAttrPath(t),e),this}prefixAttrPath(t){return Array.isArray(t)?["attrs"].concat(t):"attrs/"+t}attr(t,e,n){return null==t?this.getAttrByPath():"string"==typeof t||Array.isArray(t)?1===arguments.length?this.getAttrByPath(t):null==e?this.removeAttrByPath(t,n||{}):this.setAttrByPath(t,e,n||{}):this.setAttrs(t,e||{})}get visible(){return this.isVisible()}set visible(t){this.setVisible(t)}setVisible(t,e={}){return this.store.set("visible",t,e),this}isVisible(){return!1!==this.store.get("visible")}show(t={}){return this.isVisible()||this.setVisible(!0,t),this}hide(t={}){return this.isVisible()&&this.setVisible(!1,t),this}toggleVisible(t,e={}){return e="boolean"==typeof t?e:t,("boolean"==typeof t?t:!this.isVisible())?this.show(e):this.hide(e),this}get data(){return this.getData()}set data(t){this.setData(t)}getData(){return this.store.get("data")}setData(t,e={}){var n,r;return null==t?this.removeData(e):(n=t=>this.store.set("data",t,e),!0===e.overwrite?n(t):(r=this.getData(),!1===e.deep?n("object"==typeof t?Object.assign(Object.assign({},r),t):t):n(D.Z({},r,t)))),this}replaceData(t,e={}){return this.setData(t,Object.assign(Object.assign({},e),{overwrite:!0}))}updateData(t,e={}){return this.setData(t,Object.assign(Object.assign({},e),{deep:!1}))}removeData(t={}){return this.store.remove("data",t),this}get parent(){return this.getParent()}get children(){return this.getChildren()}getParentId(){return this.store.get("parent")}getParent(){var t=this.getParentId();return t&&this.model?(t=this.model.getCell(t),this._parent=t):null}getChildren(){var t=this.store.get("children");return t&&t.length&&this.model?(t=t.map((t=>{var e;return null==(e=this.model)?void 0:e.getCell(t)})).filter((t=>null!=t)),[...this._children=t]):null}hasParent(){return null!=this.parent}isParentOf(t){return null!=t&&t.getParent()===this}isChildOf(t){return null!=t&&this.getParent()===t}eachChild(t,e){return this.children&&this.children.forEach(t,e),this}filterChild(t,e){return this.children?this.children.filter(t,e):[]}getChildCount(){return null==this.children?0:this.children.length}getChildIndex(t){return null==this.children?-1:this.children.indexOf(t)}getChildAt(t){return null!=this.children&&0<=t?this.children[t]:null}getAncestors(t={}){var e=[];let n=this.getParent();for(;n;)e.push(n),n=!1!==t.deep?n.getParent():null;return e}getDescendants(t={}){if(!1===t.deep)return this.getChildren()||[];if(t.breadthFirst){for(var e=[],n=this.getChildren()||[];0<n.length;){var r=n.shift(),i=r.getChildren();e.push(r),i&&n.push(...i)}return e}{const e=this.getChildren()||[];return e.forEach((n=>{e.push(...n.getDescendants(t))})),e}}isDescendantOf(t,e={}){if(null==t)return!1;if(!1===e.deep)return this.isChildOf(t);{let e=this.getParent();for(;e;){if(e===t)return!0;e=e.getParent()}return!1}}isAncestorOf(t,e={}){return null!=t&&t.isDescendantOf(this,e)}contains(t){return this.isAncestorOf(t)}getCommonAncestor(...t){return Dc.getCommonAncestor(this,...t)}setParent(t,e={}){return(this._parent=t)?this.store.set("parent",t.id,e):this.store.remove("parent",e),this}setChildren(t,e={}){return null!=(this._children=t)?this.store.set("children",t.map((t=>t.id)),e):this.store.remove("children",e),this}unembed(t,e={}){var n,r=this.children;return null!=r&&null!=t&&-1!==(n=this.getChildIndex(t))&&(r.splice(n,1),t.setParent(null,e),this.setChildren(r,e)),this}embed(t,e={}){return t.addTo(this,e),this}addTo(t,e={}){return Dc.isCell(t)?t.addChild(this,e):t.addCell(this,e),this}insertTo(t,e,n={}){return t.insertChild(this,e,n),this}addChild(t,e={}){return this.insertChild(t,void 0,e)}insertChild(t,e,n={}){if(null!=t&&t!==this){var r=t.getParent(),i=this!==r;let o=e;if(null==o&&(o=this.getChildCount(),i||--o),r){var s=r.getChildren();if(s){const e=s.indexOf(t);0<=e&&(t.setParent(null,n),s.splice(e,1),r.setChildren(s,n))}}let a=this.children;null==a?(a=[]).push(t):a.splice(o,0,t),t.setParent(this,n),this.setChildren(a,n),i&&this.model&&(e=this.model.getIncomingEdges(this),r=this.model.getOutgoingEdges(this),e&&e.forEach((t=>t.updateParent(n))),r)&&r.forEach((t=>t.updateParent(n))),this.model&&this.model.addCell(t,n)}return this}removeFromParent(t={}){var e,n=this.getParent();return null!=n&&(e=n.getChildIndex(this),n.removeChildAt(e,t)),this}removeChild(t,e={}){return t=this.getChildIndex(t),this.removeChildAt(t,e)}removeChildAt(t,e={}){return t=this.getChildAt(t),null!=this.children&&null!=t&&(this.unembed(t,e),t.remove(e)),t}remove(t={}){return this.batchUpdate("remove",(()=>{var e=this.getParent();e&&e.removeChild(this,t),!1!==t.deep&&this.eachChild((e=>e.remove(t))),this.model&&this.model.removeCell(this,t)})),this}transition(t,e,n={},r="/"){return this.animation.start(t,e,n,r)}stopTransition(t,e,n="/"){return this.animation.stop(t,e,n),this}getTransitions(){return this.animation.get()}translate(t,e,n){return this}scale(t,e,n,r){return this}addTools(t,e,n){t=Array.isArray(t)?t:[t];var r="string"==typeof e?e:null;e="object"==typeof e?e:"object"==typeof n?n:{};if(e.reset)return this.setTools({name:r,items:t,local:e.local},e);let i=_.Z(this.getTools());return null==i||null==r||i.name===r?((i=null==i?{}:i).items||(i.items=[]),i.name=r,i.items=[...i.items,...t],this.setTools(Object.assign({},i),e)):void 0}setTools(t,e={}){return null==t?this.removeTools():this.store.set("tools",Dc.normalizeTools(t),e),this}getTools(){return this.store.get("tools")}removeTools(t={}){return this.store.remove("tools",t),this}hasTools(t){var e=this.getTools();return null!=e&&(null==t||e.name===t)}hasTool(t){var e=this.getTools();return null!=e&&e.items.some((e=>"string"==typeof e?e===t:e.name===t))}removeTool(t,e={}){var n=_.Z(this.getTools());if(n){let s=!1;const o=n.items.slice();var r=t=>{o.splice(t,1),s=!0};if("number"==typeof t)r(t);else for(let e=o.length-1;0<=e;--e){var i=o[e];("string"==typeof i?i===t:i.name===t)&&r(e)}s&&(n.items=o,this.setTools(n,e))}return this}getBBox(t){return new _s}getConnectionPoint(t,e){return new Js}toJSON(t={}){const e=Object.assign({},this.store.get()),n=Object.prototype.toString,r=this.isNode()?"node":this.isEdge()?"edge":"cell";if(!e.shape){const t=this.constructor;throw new Error(`Unable to serialize ${r} missing "shape" prop, check the ${r} "${t.name||n.call(t)}"`)}const i=this.constructor,s=!0===t.diff,o=e.attrs||{};t=i.getDefaults(!0);const a=s?this.preprocess(t,!0):t,l=a.attrs||{},h={};return Object.entries(e).forEach((([t,i])=>{if(null!=i&&!Array.isArray(i)&&"object"==typeof i&&!X.Z(i))throw new Error(`Can only serialize ${r} with plain-object props, but got a "${n.call(i)}" type of key "${t}" on ${r} "${this.id}"`);var o;"attrs"!==t&&"shape"!==t&&s&&(o=a[t],I.Z(i,o))&&delete e[t]})),Object.keys(o).forEach((t=>{const e=o[t],n=l[t];Object.keys(e).forEach((r=>{const i=e[r],s=n?n[r]:null;null==i||"object"!=typeof i||Array.isArray(i)?null!=n&&I.Z(s,i)||(null==h[t]&&(h[t]={}),h[t][r]=i):Object.keys(i).forEach((e=>{var o=i[e];null!=n&&null!=s&&W.Z(s)&&I.Z(s[e],o)||(null==h[t]&&(h[t]={}),null==h[t][r]&&(h[t][r]={}),h[t][r][e]=o)}))}))})),t=Object.assign(Object.assign({},e),{attrs:J(h)?void 0:h}),null==t.attrs&&delete t.attrs,0===t.angle&&delete t.angle,_.Z(t)}clone(t={}){var e;return t.deep?Dc.deepClone(this)[this.id]:(e=Object.assign({},this.store.get()),t.keepId||delete e.id,delete e.parent,delete e.children,new this.constructor(e))}findView(t){return t.findViewByCell(this)}startBatch(t,e={},n=this.model){return this.notify("batch:start",{name:t,data:e,cell:this}),n&&n.startBatch(t,Object.assign(Object.assign({},e),{cell:this})),this}stopBatch(t,e={},n=this.model){return n&&n.stopBatch(t,Object.assign(Object.assign({},e),{cell:this})),this.notify("batch:stop",{name:t,data:e,cell:this}),this}batchUpdate(t,e,n){var r=this.model;this.startBatch(t,n,r),e=e();return this.stopBatch(t,n,r),e}dispose(){this.removeFromParent(),this.store.dispose()}}Dc.defaults={},Dc.attrHooks={},Dc.propHooks=[],ve([yt.dispose()],Dc.prototype,"dispose",null),(Dc||(Dc={})).normalizeTools=function(t){return"string"==typeof t?{items:[t]}:Array.isArray(t)?{items:t}:t.items?t:{items:[t]}},(kc=Dc=Dc||{}).toStringTag="X6."+kc.name,kc.isCell=function(t){var e;return null!=t&&(t instanceof kc||(null==(e=t[Symbol.toStringTag])||e===kc.toStringTag)&&"function"==typeof t.isNode&&"function"==typeof t.isEdge&&"function"==typeof t.prop&&"function"==typeof t.attr)},(jc=Dc=Dc||{}).getCommonAncestor=function(...t){const e=t.filter((t=>null!=t)).map((t=>t.getAncestors())).sort(((t,e)=>t.length-e.length));return e.shift().find((t=>e.every((e=>e.includes(t)))))||null},jc.getCellsBBox=function(t,e={}){let n=null;for(let i=0,s=t.length;i<s;i+=1){var r=t[i];let s=r.getBBox(e);s&&(r.isNode()&&null!=(r=r.getAngle())&&0!==r&&(s=s.bbox(r)),n=null==n?s:n.union(s))}return n},jc.deepClone=function(t){return t=[t,...t.getDescendants({deep:!0})],jc.cloneCells(t)},jc.cloneCells=function(t){const e=(t=xt(t)).reduce(((t,e)=>(t[e.id]=e.clone(),t)),{});return t.forEach((t=>{var n=e[t.id],r=(n.isEdge()&&(r=n.getSourceCellId(),i=n.getTargetCellId(),r&&e[r]&&n.setSource(Object.assign(Object.assign({},n.getSource()),{cell:e[r].id})),i)&&e[i]&&n.setTarget(Object.assign(Object.assign({},n.getTarget()),{cell:e[i].id})),t.getParent()),i=(r&&e[r.id]&&n.setParent(e[r.id]),t.getChildren());i&&i.length&&0<(r=i.reduce(((t,n)=>(e[n.id]&&t.push(e[n.id]),t)),[])).length&&n.setChildren(r)})),e},(Lc=Dc=Dc||{}).config({propHooks(t){var e=t["tools"];t=Rc(t,["tools"]);return e&&(t.tools=Lc.normalizeTools(e)),t}});{let fd,md;e=Bc=Bc||{},e.exist=function(t,e){return e?null!=fd&&fd.exist(t):null!=md&&md.exist(t)},e.setEdgeRegistry=function(t){fd=t},e.setNodeRegistry=function(t){md=t}}class Ic{constructor(t){this.ports=[],this.groups={},this.init(_.Z(t))}getPorts(){return this.ports}getGroup(t){return null!=t?this.groups[t]:null}getPortsByGroup(t){return this.ports.filter((e=>e.group===t||null==e.group&&null==t))}getPortsLayoutByGroup(t,e){const n=this.getPortsByGroup(t);t=t?this.getGroup(t):null,t=t?t.position:null;var r=t?t.name:null;let i;if(null!=r){var s=Zl.registry.get(r);if(null==s)return Zl.registry.onNotFound(r);i=s}else i=Zl.presets.left;return r=n.map((t=>t&&t.position&&t.position.args||{})),s=t&&t.args||{},i(r,e,s).map(((t,r)=>(r=n[r],{portLayout:t,portId:r.id,portSize:r.size,portAttrs:r.attrs,labelSize:r.label.size,labelLayout:this.getPortLabelLayout(r,Js.create(t.position),e)})))}init(t){const{groups:e,items:n}=t;null!=e&&Object.keys(e).forEach((t=>{this.groups[t]=this.parseGroup(e[t])})),Array.isArray(n)&&n.forEach((t=>{this.ports.push(this.parsePort(t))}))}parseGroup(t){return Object.assign(Object.assign({},t),{label:this.getLabel(t,!0),position:this.getPortPosition(t.position,!0)})}parsePort(t){var e=Object.assign({},t);t=this.getGroup(t.group)||{};return e.markup=e.markup||t.markup,e.attrs=D.Z({},t.attrs,e.attrs),e.position=this.createPosition(t,e),e.label=D.Z({},t.label,this.getLabel(e)),e.zIndex=this.getZIndex(t,e),e.size=Object.assign(Object.assign({},t.size),e.size),e}getZIndex(t,e){return"number"==typeof e.zIndex?e.zIndex:"number"==typeof t.zIndex||"auto"===t.zIndex?t.zIndex:"auto"}createPosition(t,e){return D.Z({name:"left",args:{}},t.position,{args:e.args})}getPortPosition(t,e=!1){if(null==t){if(e)return{name:"left",args:{}}}else{if("string"==typeof t)return{name:t,args:{}};if(Array.isArray(t))return{name:"absolute",args:{x:t[0],y:t[1]}};if("object"==typeof t)return t}return{args:{}}}getPortLabelPosition(t,e=!1){if(null==t){if(e)return{name:"left",args:{}}}else{if("string"==typeof t)return{name:t,args:{}};if("object"==typeof t)return t}return{args:{}}}getLabel(t,e=!1){return t=t.label||{},t.position=this.getPortLabelPosition(t.position,e),t}getPortLabelLayout(t,e,n){var r=t.label.position.name||"left";t=t.label.position.args||{},r=Ul.registry.get(r)||Ul.presets.left;return r?r(e,n,t):null}}var Vc,zc,Fc=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};class $c extends Dc{get[Symbol.toStringTag](){return $c.toStringTag}constructor(t={}){super(t),this.initPorts()}preprocess(t,e){var n,{x:r,y:i,width:s,height:o}=t;t=Fc(t,["x","y","width","height"]);return null==r&&null==i||(n=t.position,t.position=Object.assign(Object.assign({},n),{x:null!=r?r:n?n.x:0,y:null!=i?i:n?n.y:0})),null==s&&null==o||(r=t.size,t.size=Object.assign(Object.assign({},r),{width:null!=s?s:r?r.width:0,height:null!=o?o:r?r.height:0})),super.preprocess(t,e)}isNode(){return!0}size(t,e,n){return void 0===t?this.getSize():"number"==typeof t?this.setSize(t,e,n):this.setSize(t,e)}getSize(){var t=this.store.get("size");return t?Object.assign({},t):{width:1,height:1}}setSize(t,e,n){return"object"==typeof t?this.resize(t.width,t.height,e):this.resize(t,e,n),this}resize(t,e,n={}){this.startBatch("resize",n);var r=n.direction;if(r){var i=this.getSize();switch(r){case"left":case"right":e=i.height;break;case"top":case"bottom":t=i.width}let l={right:0,"top-right":0,top:1,"top-left":1,left:2,"bottom-left":2,bottom:3,"bottom-right":3}[r];r=Ki.normalize(this.getAngle()||0);var s=(n.absolute&&(l=(l+Math.floor((r+45)/90))%4),this.getBBox());let h;s=(h=0===l?s.getBottomLeft():1===l?s.getCorner():2===l?s.getTopRight():s.getOrigin()).clone().rotate(-r,s.getCenter());var o=Math.sqrt(t*t+e*e)/2,a=l*Math.PI/2;a=(a+=Math.atan(l%2==0?e/t:t/e))-Ki.toRad(r),r=Js.fromPolar(o,a,s).clone().translate(t/-2,e/-2);this.store.set("size",{width:t,height:e},n),this.setPosition(r.x,r.y,n)}else this.store.set("size",{width:t,height:e},n);return this.stopBatch("resize",n),this}scale(t,e,n,r={}){return t=this.getBBox().scale(t,e,null==n?void 0:n),this.startBatch("scale",r),this.setPosition(t.x,t.y,r),this.resize(t.width,t.height,r),this.stopBatch("scale"),this}position(t,e,n){return"number"==typeof t?this.setPosition(t,e,n):this.getPosition(t)}getPosition(t={}){if(t.relative){t=this.getParent();if(null!=t&&t.isNode())return e=this.getPosition(),t=t.getPosition(),{x:e.x-t.x,y:e.y-t.y}}var e=this.store.get("position");return e?Object.assign({},e):{x:0,y:0}}setPosition(t,e,n={}){let r,i,s;return(s="object"==typeof t?(r=t.x,i=t.y,e||{}):(r=t,i=e,n||{})).relative&&null!=(t=this.getParent())&&t.isNode()&&(e=t.getPosition(),r+=e.x,i+=e.y),s.deep?(n=this.getPosition(),this.translate(r-n.x,i-n.y,s)):this.store.set("position",{x:r,y:i},s),this}translate(t=0,e=0,n={}){var r,i,s,o,a;return 0===t&&0===e||(n.translateBy=n.translateBy||this.id,r=this.getPosition(),null!=n.restrict&&n.translateBy===this.id&&(i=this.getBBox({deep:!0}),o=n.restrict,s=r.x-i.x,a=r.y-i.y,s=Math.max(o.x+s,Math.min(o.x+o.width+s-i.width,r.x+t)),o=Math.max(o.y+a,Math.min(o.y+o.height+a-i.height,r.y+e)),t=s-r.x,e=o-r.y),a={x:r.x+t,y:r.y+e},n.tx=t,n.ty=e,n.transition?("object"!=typeof n.transition&&(n.transition={}),this.transition("position",a,Object.assign(Object.assign({},n.transition),{interp:_i.object})),this.eachChild((r=>{var i;(null==(i=n.exclude)?void 0:i.includes(r))||r.translate(t,e,n)}))):(this.startBatch("translate",n),this.store.set("position",a,n),this.eachChild((r=>{var i;(null==(i=n.exclude)?void 0:i.includes(r))||r.translate(t,e,n)})),this.stopBatch("translate",n))),this}angle(t,e){return null==t?this.getAngle():this.rotate(t,e)}getAngle(){return this.store.get("angle",0)}rotate(t,e={}){var n,r,i,s,o=this.getAngle();return e.center?(n=this.getSize(),r=this.getPosition(),(s=this.getBBox().getCenter()).rotate(o-t,e.center),i=s.x-n.width/2-r.x,s=s.y-n.height/2-r.y,this.startBatch("rotate",{angle:t,options:e}),this.setPosition(r.x+i,r.y+s,e),this.rotate(t,Object.assign(Object.assign({},e),{center:null})),this.stopBatch("rotate")):this.store.set("angle",e.absolute?t:(o+t)%360,e),this}getBBox(t={}){return t.deep?((t=this.getDescendants({deep:!0,breadthFirst:!0})).push(this),Dc.getCellsBBox(t)):_s.fromPositionAndSize(this.getPosition(),this.getSize())}getConnectionPoint(t,e){var n=this.getBBox(),r=n.getCenter();t=t.getTerminal(e);return null!=t&&(e=t.port)&&this.hasPort(e)&&(t=this.getPort(e))&&t.group?(t=this.getPortsPosition(t.group)[e].position,e=Js.create(t).translate(n.getOrigin()),(t=this.getAngle())&&e.rotate(-t,r),e):r}fit(t={}){var e,n,r,i,s=(this.getChildren()||[]).filter((t=>t.isNode()));return 0!==s.length&&(this.startBatch("fit-embeds",t),t.deep&&s.forEach((e=>e.fit(t))),({x:s,y:e,width:n,height:r}=Dc.getCellsBBox(s)),s-=(i=sn(t.padding)).left,e-=i.top,n+=i.left+i.right,r+=i.bottom+i.top,this.store.set({position:{x:s,y:e},size:{width:n,height:r}},t),this.stopBatch("fit-embeds")),this}get portContainerMarkup(){return this.getPortContainerMarkup()}set portContainerMarkup(t){this.setPortContainerMarkup(t)}getDefaultPortContainerMarkup(){return this.store.get("defaultPortContainerMarkup")||Xl.getPortContainerMarkup()}getPortContainerMarkup(){return this.store.get("portContainerMarkup")||this.getDefaultPortContainerMarkup()}setPortContainerMarkup(t,e={}){return this.store.set("portContainerMarkup",Xl.clone(t),e),this}get portMarkup(){return this.getPortMarkup()}set portMarkup(t){this.setPortMarkup(t)}getDefaultPortMarkup(){return this.store.get("defaultPortMarkup")||Xl.getPortMarkup()}getPortMarkup(){return this.store.get("portMarkup")||this.getDefaultPortMarkup()}setPortMarkup(t,e={}){return this.store.set("portMarkup",Xl.clone(t),e),this}get portLabelMarkup(){return this.getPortLabelMarkup()}set portLabelMarkup(t){this.setPortLabelMarkup(t)}getDefaultPortLabelMarkup(){return this.store.get("defaultPortLabelMarkup")||Xl.getPortLabelMarkup()}getPortLabelMarkup(){return this.store.get("portLabelMarkup")||this.getDefaultPortLabelMarkup()}setPortLabelMarkup(t,e={}){return this.store.set("portLabelMarkup",Xl.clone(t),e),this}get ports(){var t=this.store.get("ports",{items:[]});return null==t.items&&(t.items=[]),t}getPorts(){return _.Z(this.ports.items)}getPortsByGroup(t){return this.getPorts().filter((e=>e.group===t))}getPort(t){return _.Z(this.ports.items.find((e=>e.id&&e.id===t)))}getPortAt(t){return this.ports.items[t]||null}hasPorts(){return 0<this.ports.items.length}hasPort(t){return-1!==this.getPortIndex(t)}getPortIndex(t){const e="string"==typeof t?t:t.id;return null!=e?this.ports.items.findIndex((t=>t.id===e)):-1}getPortsPosition(t){var e=this.getSize();return this.port.getPortsLayoutByGroup(t,new _s(0,0,e.width,e.height)).reduce(((t,e)=>{var n=e.portLayout;return t[e.portId]={position:Object.assign({},n.position),angle:n.angle||0},t}),{})}getPortProp(t,e){return this.getPropByPath(this.prefixPortPath(t,e))}setPortProp(t,e,n,r){if("string"==typeof e||Array.isArray(e)){const i=this.prefixPortPath(t,e),s=n;return this.setPropByPath(i,s,r)}const i=this.prefixPortPath(t),s=e;return this.setPropByPath(i,s,n)}removePortProp(t,e,n){return"string"==typeof e||Array.isArray(e)?this.removePropByPath(this.prefixPortPath(t,e),n):this.removePropByPath(this.prefixPortPath(t),e)}portProp(t,e,n,r){return null==e?this.getPortProp(t):"string"==typeof e||Array.isArray(e)?2===arguments.length?this.getPortProp(t,e):null==n?this.removePortProp(t,e,r):this.setPortProp(t,e,n,r):this.setPortProp(t,e,n)}prefixPortPath(t,e){var n=this.getPortIndex(t);if(-1===n)throw new Error(`Unable to find port with id: "${t}"`);return null==e||""===e?["ports","items",""+n]:Array.isArray(e)?["ports","items",""+n,...e]:`ports/items/${n}/`+e}addPort(t,e){var n=[...this.ports.items];return n.push(t),this.setPropByPath("ports/items",n,e),this}addPorts(t,e){return this.setPropByPath("ports/items",[...this.ports.items,...t],e),this}insertPort(t,e,n){var r=[...this.ports.items];return r.splice(t,0,e),this.setPropByPath("ports/items",r,n),this}removePort(t,e={}){return this.removePortAt(this.getPortIndex(t),e)}removePortAt(t,e={}){var n;return 0<=t&&((n=[...this.ports.items]).splice(t,1),e.rewrite=!0,this.setPropByPath("ports/items",n,e)),this}removePorts(t,e){let n;return Array.isArray(t)?(n=e||{},t.length&&(n.rewrite=!0,e=[...this.ports.items].filter((e=>!t.some((t=>(t="string"==typeof t?t:t.id,e.id===t))))),this.setPropByPath("ports/items",e,n))):((n=t||{}).rewrite=!0,this.setPropByPath("ports/items",[],n)),this}getParsedPorts(){return this.port.getPorts()}getParsedGroups(){return this.port.groups}getPortsLayoutByGroup(t,e){return this.port.getPortsLayoutByGroup(t,e)}initPorts(){this.updatePortData(),this.on("change:ports",(()=>{this.processRemovedPort(),this.updatePortData()}))}processRemovedPort(){var t=this.ports;const e={},n=(t.items.forEach((t=>{t.id&&(e[t.id]=!0)})),{});(this.store.getPrevious("ports")||{items:[]}).items.forEach((t=>{t.id&&!e[t.id]&&(n[t.id]=!0)})),t=this.model,t&&!J(n)&&(t.getConnectedEdges(this,{incoming:!0}).forEach((t=>{var e=t.getTargetPortId();e&&n[e]&&t.remove()})),t.getConnectedEdges(this,{outgoing:!0}).forEach((t=>{var e=t.getSourcePortId();e&&n[e]&&t.remove()})))}validatePorts(){const t={},e=[];return this.ports.items.forEach((n=>{"object"!=typeof n&&e.push(`Invalid port ${n}.`),null==n.id&&(n.id=this.generatePortId()),t[n.id]&&e.push("Duplicitied port id."),t[n.id]=!0})),e}generatePortId(){return Je()}updatePortData(){var t=this.validatePorts();if(0<t.length)throw this.store.set("ports",this.store.getPrevious("ports")),new Error(t.join(" "));const e=this.port?this.port.getPorts():null,n=(this.port=new Ic(this.ports),this.port.getPorts());t=e?n.filter((t=>e.find((e=>e.id===t.id))?null:t)):[...n];var r=e?e.filter((t=>n.find((e=>e.id===t.id))?null:t)):[];0<t.length&&this.notify("ports:added",{added:t,cell:this,node:this}),0<r.length&&this.notify("ports:removed",{removed:r,cell:this,node:this})}}$c.defaults={angle:0,position:{x:0,y:0},size:{width:1,height:1}},(Vc=$c=$c||{}).toStringTag="X6."+Vc.name,Vc.isNode=function(t){var e;return null!=t&&(t instanceof Vc||(null==(e=t[Symbol.toStringTag])||e===Vc.toStringTag)&&"function"==typeof t.isNode&&"function"==typeof t.isEdge&&"function"==typeof t.prop&&"function"==typeof t.attr&&"function"==typeof t.size&&"function"==typeof t.position)},($c||($c={})).config({propHooks(t){var e=t["ports"];t=Fc(t,["ports"]);return e&&(t.ports=Array.isArray(e)?{items:e}:e),t}}),(zc=$c=$c||{}).registry=Eo.create({type:"node",process(t,e){if(Bc.exist(t,!0))throw new Error(`Node with name '${t}' was registered by anthor Edge`);if("function"==typeof e)return e.config({shape:t}),e;let n=zc;var r=e["inherit"],i=(e=Fc(e,["inherit"]),r&&("string"==typeof r?null==(i=this.get(r))?this.onNotFound(r,"inherited"):n=i:n=r),null==e.constructorName&&(e.constructorName=t),n.define.call(n,e));return i.config({shape:t}),i}}),Bc.setNodeRegistry(zc.registry);{var Gc=$c=$c||{};let vd=0;Gc.define=function(t){var{constructorName:e,overwrite:n}=t;t=Fc(t,["constructorName","overwrite"]);return(e=dt((e=e||t.shape)?Ze(e):"CustomNode"+(vd+=1),this)).config(t),t.shape&&Gc.registry.register(t.shape,e,n),e},Gc.create=function(t){var e=t.shape||"rect",n=Gc.registry.get(e);return n?new n(t):Gc.registry.onNotFound(e)}}var qc,Hc,Zc,Uc=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};class Jc extends Dc{get[Symbol.toStringTag](){return Jc.toStringTag}constructor(t={}){super(t)}preprocess(t,e){var n,{source:r,sourceCell:i,sourcePort:s,sourcePoint:o,target:a,targetCell:l,targetPort:h,targetPoint:u}=t,c=(t=Uc(t,["source","sourceCell","sourcePort","sourcePoint","target","targetCell","targetPort","targetPoint"]),t=>"string"==typeof t||"number"==typeof t);if(null!=r&&(Dc.isCell(r)?t.source={cell:r.id}:c(r)?t.source={cell:r}:Js.isPoint(r)?t.source=r.toJSON():Array.isArray(r)?t.source={x:r[0],y:r[1]}:(n=r.cell,Dc.isCell(n)?t.source=Object.assign(Object.assign({},r),{cell:n.id}):t.source=r)),null!=i||null!=s){let e=t.source;null!=i&&(n=c(i)?i:i.id,e?e.cell=n:e=t.source={cell:n}),null!=s&&e&&(e.port=s)}else null!=o&&(t.source=Js.create(o).toJSON());if(null!=a&&(Dc.isCell(a)?t.target={cell:a.id}:c(a)?t.target={cell:a}:Js.isPoint(a)?t.target=a.toJSON():Array.isArray(a)?t.target={x:a[0],y:a[1]}:(r=a.cell,Dc.isCell(r)?t.target=Object.assign(Object.assign({},a),{cell:r.id}):t.target=a)),null!=l||null!=h){let e=t.target;null!=l&&(i=c(l)?l:l.id,e?e.cell=i:e=t.target={cell:i}),null!=h&&e&&(e.port=h)}else null!=u&&(t.target=Js.create(u).toJSON());return super.preprocess(t,e)}setup(){super.setup(),this.on("change:labels",(t=>this.onLabelsChanged(t))),this.on("change:vertices",(t=>this.onVertexsChanged(t)))}isEdge(){return!0}disconnect(t={}){return this.store.set({source:{x:0,y:0},target:{x:0,y:0}},t),this}get source(){return this.getSource()}set source(t){this.setSource(t)}getSource(){return this.getTerminal("source")}getSourceCellId(){return this.source.cell}getSourcePortId(){return this.source.port}setSource(t,e,n={}){return this.setTerminal("source",t,e,n)}get target(){return this.getTarget()}set target(t){this.setTarget(t)}getTarget(){return this.getTerminal("target")}getTargetCellId(){return this.target.cell}getTargetPortId(){return this.target.port}setTarget(t,e,n={}){return this.setTerminal("target",t,e,n)}getTerminal(t){return Object.assign({},this.store.get(t))}setTerminal(t,e,n,r={}){var i;return Dc.isCell(e)?this.store.set(t,D.Z({},n,{cell:e.id}),r):(i=e,Js.isPoint(e)||null!=i.x&&null!=i.y?this.store.set(t,D.Z({},n,{x:i.x,y:i.y}),r):this.store.set(t,_.Z(e),r)),this}getSourcePoint(){return this.getTerminalPoint("source")}getTargetPoint(){return this.getTerminalPoint("target")}getTerminalPoint(t){var e=this[t];return Js.isPointLike(e)?Js.create(e):(e=this.getTerminalCell(t))?e.getConnectionPoint(this,t):new Js}getSourceCell(){return this.getTerminalCell("source")}getTargetCell(){return this.getTerminalCell("target")}getTerminalCell(t){return this.model&&(t="source"===t?this.getSourceCellId():this.getTargetCellId(),t)?this.model.getCell(t):null}getSourceNode(){return this.getTerminalNode("source")}getTargetNode(){return this.getTerminalNode("target")}getTerminalNode(t){let e=this;for(var n={};e&&e.isEdge();){if(n[e.id])return null;n[e.id]=!0,e=e.getTerminalCell(t)}return e&&e.isNode()?e:null}get router(){return this.getRouter()}set router(t){null==t?this.removeRouter():this.setRouter(t)}getRouter(){return this.store.get("router")}setRouter(t,e,n){return"object"==typeof t?this.store.set("router",t,e):this.store.set("router",{name:t,args:e},n),this}removeRouter(t={}){return this.store.remove("router",t),this}get connector(){return this.getConnector()}set connector(t){null==t?this.removeConnector():this.setConnector(t)}getConnector(){return this.store.get("connector")}setConnector(t,e,n){return"object"==typeof t?this.store.set("connector",t,e):this.store.set("connector",{name:t,args:e},n),this}removeConnector(t={}){return this.store.remove("connector",t)}getDefaultLabel(){var t=this.constructor;t=this.store.get("defaultLabel")||t.defaultLabel||{};return _.Z(t)}get labels(){return this.getLabels()}set labels(t){this.setLabels(t)}getLabels(){return[...this.store.get("labels",[])].map((t=>this.parseLabel(t)))}setLabels(t,e={}){return this.store.set("labels",Array.isArray(t)?t:[t],e),this}insertLabel(t,e,n={}){var r=this.getLabels(),i=r.length;let s=null!=e&&Number.isFinite(e)?e:i;return s<0&&(s=i+s+1),r.splice(s,0,this.parseLabel(t)),this.setLabels(r,n)}appendLabel(t,e={}){return this.insertLabel(t,-1,e)}getLabelAt(t){var e=this.getLabels();return null!=t&&Number.isFinite(t)?this.parseLabel(e[t]):null}setLabelAt(t,e,n={}){var r;return null!=t&&Number.isFinite(t)&&((r=this.getLabels())[t]=this.parseLabel(e),this.setLabels(r,n)),this}removeLabelAt(t,e={}){var n=this.getLabels();t=null!=t&&Number.isFinite(t)?t:-1,t=n.splice(t,1);return this.setLabels(n,e),t.length?t[0]:null}parseLabel(t){return"string"==typeof t?this.constructor.parseStringLabel(t):t}onLabelsChanged({previous:t,current:e}){var n=t&&e?e.filter((e=>t.find((t=>e===t||I.Z(e,t)))?null:e)):e?[...e]:[],r=t&&e?t.filter((t=>e.find((e=>t===e||I.Z(t,e)))?null:t)):t?[...t]:[];0<n.length&&this.notify("labels:added",{added:n,cell:this,edge:this}),0<r.length&&this.notify("labels:removed",{removed:r,cell:this,edge:this})}get vertices(){return this.getVertices()}set vertices(t){this.setVertices(t)}getVertices(){return[...this.store.get("vertices",[])]}setVertices(t,e={}){return t=Array.isArray(t)?t:[t],this.store.set("vertices",t.map((t=>Js.toJSON(t))),e),this}insertVertex(t,e,n={}){var r=this.getVertices(),i=r.length;let s=null!=e&&Number.isFinite(e)?e:i;return s<0&&(s=i+s+1),r.splice(s,0,Js.toJSON(t)),this.setVertices(r,n)}appendVertex(t,e={}){return this.insertVertex(t,-1,e)}getVertexAt(t){return null!=t&&Number.isFinite(t)?this.getVertices()[t]:null}setVertexAt(t,e,n={}){var r;return null!=t&&Number.isFinite(t)&&((r=this.getVertices())[t]=e,this.setVertices(r,n)),this}removeVertexAt(t,e={}){var n=this.getVertices();t=null!=t&&Number.isFinite(t)?t:-1;return n.splice(t,1),this.setVertices(n,e)}onVertexsChanged({previous:t,current:e}){var n=t&&e?e.filter((e=>t.find((t=>Js.equals(e,t)))?null:e)):e?[...e]:[],r=t&&e?t.filter((t=>e.find((e=>Js.equals(t,e)))?null:t)):t?[...t]:[];0<n.length&&this.notify("vertexs:added",{added:n,cell:this,edge:this}),0<r.length&&this.notify("vertexs:removed",{removed:r,cell:this,edge:this})}getDefaultMarkup(){return this.store.get("defaultMarkup")||Xl.getEdgeMarkup()}getMarkup(){return super.getMarkup()||this.getDefaultMarkup()}translate(t,e,n={}){return n.translateBy=n.translateBy||this.id,n.tx=t,n.ty=e,this.applyToPoints((n=>({x:(n.x||0)+t,y:(n.y||0)+e})),n)}scale(t,e,n,r={}){return this.applyToPoints((r=>Js.create(r).scale(t,e,n).toJSON()),r)}applyToPoints(t,e={}){var n={},r=this.getSource(),i=this.getTarget();Js.isPointLike(r)&&(n.source=t(r)),Js.isPointLike(i)&&(n.target=t(i)),r=this.getVertices();return 0<r.length&&(n.vertices=r.map(t)),this.store.set(n,e),this}getBBox(){return this.getPolyline().bbox()}getConnectionPoint(){return this.getPolyline().pointAt(.5)}getPolyline(){var t=[this.getSourcePoint(),...this.getVertices().map((t=>Js.create(t))),this.getTargetPoint()];return new lo(t)}updateParent(t){let e=null;var n=this.getSourceCell(),r=this.getTargetCell(),i=this.getParent();return n&&r&&(e=n===r||n.isDescendantOf(r)?r:r.isDescendantOf(n)?n:Dc.getCommonAncestor(n,r)),i&&e&&e.id!==i.id&&i.unembed(this,t),!e||i&&i.id===e.id||e.embed(this,t),e}hasLoop(t={}){var e=this.getSource(),n=this.getTarget();e=e.cell,n=n.cell;if(!e||!n)return!1;let r=e===n;return!r&&t.deep&&this._model&&(e=this.getSourceCell(),n=this.getTargetCell(),e)&&n?e.isAncestorOf(n,t)||n.isAncestorOf(e,t):r}getFragmentAncestor(){var t=[this,this.getSourceNode(),this.getTargetNode()].filter((t=>null!=t));return this.getCommonAncestor(...t)}isFragmentDescendantOf(t){var e=this.getFragmentAncestor();return!!e&&(e.id===t.id||e.isDescendantOf(t))}}Jc.defaults={},(Jc||(Jc={})).equalTerminals=function(t,e){return t.cell===e.cell&&(t.port===e.port||null==t.port&&null==e.port)},(K=Jc=Jc||{}).defaultLabel={markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}],attrs:{text:{fill:"#000",fontSize:14,textAnchor:"middle",textVerticalAnchor:"middle",pointerEvents:"none"},rect:{ref:"label",fill:"#fff",rx:3,ry:3,refWidth:1,refHeight:1,refX:0,refY:0}},position:{distance:.5}},K.parseStringLabel=function(t){return{attrs:{label:{text:t}}}},(qc=Jc=Jc||{}).toStringTag="X6."+qc.name,qc.isEdge=function(t){var e;return null!=t&&(t instanceof qc||(null==(e=t[Symbol.toStringTag])||e===qc.toStringTag)&&"function"==typeof t.isNode&&"function"==typeof t.isEdge&&"function"==typeof t.prop&&"function"==typeof t.attr&&"function"==typeof t.disconnect&&"function"==typeof t.getSource&&"function"==typeof t.getTarget)},(Hc=Jc=Jc||{}).registry=Eo.create({type:"edge",process(t,e){if(Bc.exist(t,!1))throw new Error(`Edge with name '${t}' was registered by anthor Node`);if("function"==typeof e)return e.config({shape:t}),e;let n=Hc;var{inherit:r="edge"}=e,i=(e=Uc(e,["inherit"]),"string"==typeof r?null==(i=this.get(r||"edge"))&&r?this.onNotFound(r,"inherited"):n=i:n=r,null==e.constructorName&&(e.constructorName=t),n.define.call(n,e));return i.config({shape:t}),i}}),Bc.setEdgeRegistry(Hc.registry);{var Wc=Jc=Jc||{};let yd=0;Wc.define=function(t){var{constructorName:e,overwrite:n}=t;t=Uc(t,["constructorName","overwrite"]);return(e=dt((e=e||t.shape)?Ze(e):"CustomEdge"+(yd+=1),this)).config(t),t.shape&&Wc.registry.register(t.shape,e,n),e},Wc.create=function(t){var e=t.shape||"edge",n=Wc.registry.get(e);return n?new n(t):Wc.registry.onNotFound(e)}}Zc=Jc=Jc||{},a="basic.edge",Zc.config({shape:a,propHooks(t){var{label:e,vertices:n}=t;t=Uc(t,["label","vertices"]);return e&&(null==t.labels&&(t.labels=[]),e="string"==typeof e?Zc.parseStringLabel(e):e,t.labels.push(e)),n&&Array.isArray(n)&&(t.vertices=n.map((t=>Js.create(t).toJSON()))),t}}),Zc.registry.register(a,Zc),n(52262),n(24506);class Xc extends yt{constructor(t,e={}){super(),this.length=0,this.comparator=e.comparator||"zIndex",this.clean(),t&&this.reset(t,{silent:!0})}toJSON(){return this.cells.map((t=>t.toJSON()))}add(t,e,n){let r,i;i="number"==typeof e?(r=e,Object.assign({merge:!1},n)):(r=this.length,Object.assign({merge:!1},e)),(r=r>this.length?this.length:r)<0&&(r+=this.length+1),t=Array.isArray(t)?t:[t];const s=this.comparator&&"number"!=typeof e&&!1!==i.sort,o=this.comparator||null;let a=!1;const l=[],h=[];return t.forEach((t=>{const e=this.get(t);e?i.merge&&!t.isSameStore(e)&&(e.setProp(t.getProp(),n),h.push(e),s)&&!a&&(a=null==o||"function"==typeof o?e.hasChanged():"string"==typeof o?e.hasChanged(o):o.some((t=>e.hasChanged(t)))):(l.push(t),this.reference(t))})),l.length&&(s&&(a=!0),this.cells.splice(r,0,...l),this.length=this.cells.length),a&&this.sort({silent:!0}),!i.silent&&(l.forEach(((t,e)=>{e={cell:t,index:r+e,options:i},this.trigger("added",e),i.dryrun||t.notify("added",Object.assign({},e))})),a&&this.trigger("sorted"),l.length||h.length)&&this.trigger("updated",{added:l,merged:h,removed:[],options:i}),this}remove(t,e={}){var n=Array.isArray(t)?t:[t];n=this.removeCells(n,e);return!e.silent&&0<n.length&&this.trigger("updated",{options:e,removed:n,added:[],merged:[]}),Array.isArray(t)?n:n[0]}removeCells(t,e){var n=[];for(let s=0;s<t.length;s+=1){var r,i=this.get(t[s]);null==i||(r=this.cells.indexOf(i),this.cells.splice(r,1),--this.length,delete this.map[i.id],n.push(i),this.unreference(i),e.dryrun||i.remove(),e.silent)||(this.trigger("removed",{cell:i,index:r,options:e}),e.dryrun)||i.notify("removed",{cell:i,index:r,options:e})}return n}reset(t,e={}){const n=this.cells.slice();if(n.forEach((t=>this.unreference(t))),this.clean(),this.add(t,Object.assign({silent:!0},e)),!e.silent){const t=this.cells.slice(),r=(this.trigger("reseted",{options:e,previous:n,current:t}),[]),i=[];t.forEach((t=>{n.some((e=>e.id===t.id))||r.push(t)})),n.forEach((e=>{t.some((t=>t.id===e.id))||i.push(e)})),this.trigger("updated",{options:e,added:r,removed:i,merged:[]})}return this}push(t,e){return this.add(t,this.length,e)}pop(t){var e=this.at(this.length-1);return this.remove(e,t)}unshift(t,e){return this.add(t,0,e)}shift(t){var e=this.at(0);return this.remove(e,t)}get(t){return null!=t&&(t="string"==typeof t||"number"==typeof t?t:t.id,this.map[t])||null}has(t){return null!=this.get(t)}at(t){return t<0&&(t+=this.length),this.cells[t]||null}first(){return this.at(0)}last(){return this.at(-1)}indexOf(t){return this.cells.indexOf(t)}toArray(){return this.cells.slice()}sort(t={}){return null!=this.comparator&&(this.cells=Ft(this.cells,this.comparator),t.silent||this.trigger("sorted")),this}clone(){return new this.constructor(this.cells.slice(),{comparator:this.comparator})}reference(t){(this.map[t.id]=t).on("*",this.notifyCellEvent,this)}unreference(t){t.off("*",this.notifyCellEvent,this),delete this.map[t.id]}notifyCellEvent(t,e){var n=e.cell;this.trigger("cell:"+t,e),n&&(n.isNode()?this.trigger("node:"+t,Object.assign(Object.assign({},e),{node:n})):n.isEdge()&&this.trigger("edge:"+t,Object.assign(Object.assign({},e),{edge:n})))}clean(){this.length=0,this.cells=[],this.map={}}dispose(){this.reset([])}}(function(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(o=(s<3?i(o):3<s?i(e,n,o):i(e,n))||o);3<s&&o&&Object.defineProperty(e,n,o)})([Xc.dispose()],Xc.prototype,"dispose",null);var Yc;Zt=function(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(o=(s<3?i(o):3<s?i(e,n,o):i(e,n))||o);return 3<s&&o&&Object.defineProperty(e,n,o),o};class _c extends yt{get[Symbol.toStringTag](){return _c.toStringTag}constructor(t=[]){super(),this.batches={},this.addings=new WeakMap,this.nodes={},this.edges={},this.outgoings={},this.incomings={},this.collection=new Xc(t),this.setup()}notify(t,e){this.trigger(t,e);var n=this.graph;return n&&("sorted"===t||"reseted"===t||"updated"===t?n.trigger("model:"+t,e):n.trigger(t,e)),this}setup(){var t=this.collection;t.on("sorted",(()=>this.notify("sorted",null))),t.on("updated",(t=>this.notify("updated",t))),t.on("cell:change:zIndex",(()=>this.sortOnChangeZ())),t.on("added",(({cell:t})=>{this.onCellAdded(t)})),t.on("removed",(t=>{var e=t.cell;this.onCellRemoved(e,t.options),this.notify("cell:removed",t),e.isNode()?this.notify("node:removed",Object.assign(Object.assign({},t),{node:e})):e.isEdge()&&this.notify("edge:removed",Object.assign(Object.assign({},t),{edge:e}))})),t.on("reseted",(t=>{this.onReset(t.current),this.notify("reseted",t)})),t.on("edge:change:source",(({edge:t})=>this.onEdgeTerminalChanged(t,"source"))),t.on("edge:change:target",(({edge:t})=>{this.onEdgeTerminalChanged(t,"target")}))}sortOnChangeZ(){this.collection.sort()}onCellAdded(t){var e=t.id;t.isEdge()?(t.updateParent(),this.edges[e]=!0,this.onEdgeTerminalChanged(t,"source"),this.onEdgeTerminalChanged(t,"target")):this.nodes[e]=!0}onCellRemoved(t,e){var n,r,i,s,o=t.id;t.isEdge()?(delete this.edges[o],n=t.getSource(),r=t.getTarget(),n&&n.cell&&0<=(i=(s=this.outgoings[n.cell])?s.indexOf(o):-1)&&(s.splice(i,1),0===s.length)&&delete this.outgoings[n.cell],r&&r.cell&&0<=(s=(i=this.incomings[r.cell])?i.indexOf(o):-1)&&(i.splice(s,1),0===i.length)&&delete this.incomings[r.cell]):delete this.nodes[o],e.clear||(e.disconnectEdges?this.disconnectConnectedEdges(t,e):this.removeConnectedEdges(t,e)),t.model===this&&(t.model=null)}onReset(t){this.nodes={},this.edges={},this.outgoings={},this.incomings={},t.forEach((t=>this.onCellAdded(t)))}onEdgeTerminalChanged(t,e){var n,r="source"===e?this.outgoings:this.incomings,i=t.previous(e),s=(i&&i.cell&&0<=(s=(n=r[i=Dc.isCell(i.cell)?i.cell.id:i.cell])?n.indexOf(t.id):-1)&&(n.splice(s,1),0===n.length)&&delete r[i],t.getTerminal(e));s&&s.cell&&(-1===(i=r[n=Dc.isCell(s.cell)?s.cell.id:s.cell]||[]).indexOf(t.id)&&i.push(t.id),r[n]=i)}prepareCell(t,e){return t.model||e&&e.dryrun||(t.model=this),null==t.zIndex&&t.setZIndex(this.getMaxZIndex()+1,{silent:!0}),t}resetCells(t,e={}){return t.map((t=>this.prepareCell(t,Object.assign(Object.assign({},e),{dryrun:!0})))),this.collection.reset(t,e),t.map((t=>this.prepareCell(t,{options:e}))),this}clear(t={}){const e=this.getCells();if(0!==e.length){const n=Object.assign(Object.assign({},t),{clear:!0});this.batchUpdate("clear",(()=>{for(var t=e.sort(((t,e)=>(t.isEdge()?1:2)-(e.isEdge()?1:2)));0<t.length;){var r=t.shift();r&&r.remove(n)}}),n)}return this}addNode(t,e={}){return t=$c.isNode(t)?t:this.createNode(t),this.addCell(t,e),t}updateNode(t,e={}){t=this.createNode(t);var n=t.getProp();return t.dispose(),this.updateCell(n,e)}createNode(t){return $c.create(t)}addEdge(t,e={}){return t=Jc.isEdge(t)?t:this.createEdge(t),this.addCell(t,e),t}createEdge(t){return Jc.create(t)}updateEdge(t,e={}){t=this.createEdge(t);var n=t.getProp();return t.dispose(),this.updateCell(n,e)}addCell(t,e={}){return Array.isArray(t)?this.addCells(t,e):(this.collection.has(t)||this.addings.has(t)||(this.addings.set(t,!0),this.collection.add(this.prepareCell(t,e),e),t.eachChild((t=>this.addCell(t,e))),this.addings.delete(t)),this)}addCells(t,e={}){var n=t.length;if(0!==n){const r=Object.assign(Object.assign({},e),{position:n-1,maxPosition:n-1});this.startBatch("add",Object.assign(Object.assign({},r),{cells:t})),t.forEach((t=>{this.addCell(t,r),--r.position})),this.stopBatch("add",Object.assign(Object.assign({},r),{cells:t}))}return this}updateCell(t,e={}){const n=t.id&&this.getCell(t.id);return!!n&&this.batchUpdate("update",(()=>(Object.entries(t).forEach((([t,r])=>n.setProp(t,r,e))),!0)),t)}removeCell(t,e={}){return t="string"==typeof t?this.getCell(t):t,t&&this.has(t)?this.collection.remove(t,e):null}updateCellId(t,e){var n;if(t.id!==e)return this.startBatch("update",{id:e}),t.prop("id",e),n=t.clone({keepId:!0}),this.addCell(n),this.getConnectedEdges(t).forEach((n=>{var r=n.getSourceCell(),i=n.getTargetCell();r===t&&n.setSource(Object.assign(Object.assign({},n.getSource()),{cell:e})),i===t&&n.setTarget(Object.assign(Object.assign({},n.getTarget()),{cell:e}))})),this.removeCell(t),this.stopBatch("update",{id:e}),n}removeCells(t,e={}){return t.length?this.batchUpdate("remove",(()=>t.map((t=>this.removeCell(t,e))))):[]}removeConnectedEdges(t,e={}){return t=this.getConnectedEdges(t),t.forEach((t=>{t.remove(e)})),t}disconnectConnectedEdges(t,e={}){const n="string"==typeof t?t:t.id;this.getConnectedEdges(t).forEach((t=>{var r=t.getSourceCellId(),i=t.getTargetCellId();r===n&&t.setSource({x:0,y:0},e),i===n&&t.setTarget({x:0,y:0},e)}))}has(t){return this.collection.has(t)}total(){return this.collection.length}indexOf(t){return this.collection.indexOf(t)}getCell(t){return this.collection.get(t)}getCells(){return this.collection.toArray()}getFirstCell(){return this.collection.first()}getLastCell(){return this.collection.last()}getMinZIndex(){var t=this.collection.first();return t&&t.getZIndex()||0}getMaxZIndex(){var t=this.collection.last();return t&&t.getZIndex()||0}getCellsFromCache(t){return t?Object.keys(t).map((t=>this.getCell(t))).filter((t=>null!=t)):[]}getNodes(){return this.getCellsFromCache(this.nodes)}getEdges(){return this.getCellsFromCache(this.edges)}getOutgoingEdges(t){return t="string"==typeof t?t:t.id,t=this.outgoings[t],t?t.map((t=>this.getCell(t))).filter((t=>t&&t.isEdge())):null}getIncomingEdges(t){return t="string"==typeof t?t:t.id,t=this.incomings[t],t?t.map((t=>this.getCell(t))).filter((t=>t&&t.isEdge())):null}getConnectedEdges(t,e={}){const n=[];if(t="string"==typeof t?this.getCell(t):t,null!=t){const r={},i=e.indirect;let s=e.incoming,o=e.outgoing;null==s&&null==o&&(s=o=!0);const a=(t,e)=>{var l=e?this.getOutgoingEdges(t):this.getIncomingEdges(t);null!=l&&l.forEach((t=>{r[t.id]||(n.push(t),r[t.id]=!0,i&&(s&&a(t,!1),o)&&a(t,!0))})),i&&t.isEdge()&&(l=e?t.getTargetCell():t.getSourceCell())&&l.isEdge()&&(r[l.id]||(n.push(l),a(l,e)))};if(o&&a(t,!0),s&&a(t,!1),e.deep){t=t.getDescendants({deep:!0});const i={},a=(t.forEach((t=>{t.isNode()&&(i[t.id]=!0)})),(t,s)=>{s=s?this.getOutgoingEdges(t.id):this.getIncomingEdges(t.id),null!=s&&s.forEach((t=>{var s,o;r[t.id]||(s=t.getSourceCell(),o=t.getTargetCell(),!e.enclosed&&s&&i[s.id]&&o&&i[o.id])||(n.push(t),r[t.id]=!0)}))});t.forEach((t=>{t.isEdge()||(o&&a(t,!0),s&&a(t,!1))}))}}return n}isBoundary(t,e){return t="string"==typeof t?this.getCell(t):t,e=e?this.getIncomingEdges(t):this.getOutgoingEdges(t),null==e||0===e.length}getBoundaryNodes(t){const e=[];return Object.keys(this.nodes).forEach((n=>{this.isBoundary(n,t)&&(n=this.getCell(n))&&e.push(n)})),e}getRoots(){return this.getBoundaryNodes(!0)}getLeafs(){return this.getBoundaryNodes(!1)}isRoot(t){return this.isBoundary(t,!0)}isLeaf(t){return this.isBoundary(t,!1)}getNeighbors(t,e={}){let n=e.incoming,r=e.outgoing;var i;null==n&&null==r&&(n=r=!0);const s=this.getConnectedEdges(t,e).reduce(((i,s)=>{var o=s.hasLoop(e),a=s.getSourceCell();s=s.getTargetCell();return n&&a&&a.isNode()&&!i[a.id]&&(!o&&(a===t||e.deep&&a.isDescendantOf(t))||(i[a.id]=a)),r&&s&&s.isNode()&&!i[s.id]&&(!o&&(s===t||e.deep&&s.isDescendantOf(t))||(i[s.id]=s)),i}),{});return t.isEdge()&&(n&&(i=t.getSourceCell())&&i.isNode()&&!s[i.id]&&(s[i.id]=i),r)&&(i=t.getTargetCell())&&i.isNode()&&!s[i.id]&&(s[i.id]=i),Object.keys(s).map((t=>s[t]))}isNeighbor(t,e,n={}){let r=n.incoming,i=n.outgoing;return null==r&&null==i&&(r=i=!0),this.getConnectedEdges(t,n).some((t=>{var n=t.getSourceCell();t=t.getTargetCell();return!(!r||!n||n.id!==e.id)||!(!i||!t||t.id!==e.id)}))}getSuccessors(t,e={}){const n=[];return this.search(t,((r,i)=>{r!==t&&this.matchDistance(i,e.distance)&&n.push(r)}),Object.assign(Object.assign({},e),{outgoing:!0})),n}isSuccessor(t,e,n={}){let r=!1;return this.search(t,((i,s)=>{if(i===e&&i!==t&&this.matchDistance(s,n.distance))return!(r=!0)}),Object.assign(Object.assign({},n),{outgoing:!0})),r}getPredecessors(t,e={}){const n=[];return this.search(t,((r,i)=>{r!==t&&this.matchDistance(i,e.distance)&&n.push(r)}),Object.assign(Object.assign({},e),{incoming:!0})),n}isPredecessor(t,e,n={}){let r=!1;return this.search(t,((i,s)=>{if(i===e&&i!==t&&this.matchDistance(s,n.distance))return!(r=!0)}),Object.assign(Object.assign({},n),{incoming:!0})),r}matchDistance(t,e){return null==e||("function"==typeof e?e(t):!(!Array.isArray(e)||!e.includes(t))||t===e)}getCommonAncestor(...t){const e=[];return t.forEach((t=>{t&&(Array.isArray(t)?e.push(...t):e.push(t))})),Dc.getCommonAncestor(...e)}getSubGraph(t,e={}){const n=[],r={},i=[],s=[],o=t=>{r[t.id]||(n.push(t),(r[t.id]=t).isEdge()&&s.push(t),t.isNode()&&i.push(t))};return t.forEach((t=>{o(t),e.deep&&t.getDescendants({deep:!0}).forEach((t=>o(t)))})),s.forEach((t=>{var e=t.getSourceCell();t=t.getTargetCell();e&&!r[e.id]&&(n.push(e),(r[e.id]=e).isNode())&&i.push(e),t&&!r[t.id]&&(n.push(t),(r[t.id]=t).isNode())&&i.push(t)})),i.forEach((t=>{this.getConnectedEdges(t,e).forEach((t=>{var e=t.getSourceCell(),i=t.getTargetCell();!r[t.id]&&e&&r[e.id]&&i&&r[i.id]&&(n.push(t),r[t.id]=t)}))})),n}cloneSubGraph(t,e={}){return t=this.getSubGraph(t,e),this.cloneCells(t)}cloneCells(t){return Dc.cloneCells(t)}getNodesFromPoint(t,e){const n="number"==typeof t?{x:t,y:e||0}:t;return this.getNodes().filter((t=>t.getBBox().containsPoint(n)))}getNodesInArea(t,e,n,r,i){const s="number"==typeof t?new _s(t,e,n,r):_s.create(t);n="number"==typeof t?i:e;const o=n&&n.strict;return this.getNodes().filter((t=>(t=t.getBBox(),o?s.containsRect(t):s.isIntersectWithRect(t))))}getEdgesInArea(t,e,n,r,i){const s="number"==typeof t?new _s(t,e,n,r):_s.create(t);n="number"==typeof t?i:e;const o=n&&n.strict;return this.getEdges().filter((t=>(t=t.getBBox(),0===t.width?t.inflate(1,0):0===t.height&&t.inflate(0,1),o?s.containsRect(t):s.isIntersectWithRect(t))))}getNodesUnderNode(t,e={}){var n=t.getBBox();return(null==e.by||"bbox"===e.by?this.getNodesInArea(n):this.getNodesFromPoint(n[e.by])).filter((e=>t.id!==e.id&&!e.isDescendantOf(t)))}getAllCellsBBox(){return this.getCellsBBox(this.getCells())}getCellsBBox(t,e={}){return Dc.getCellsBBox(t,e)}search(t,e,n={}){n.breadthFirst?this.breadthFirstSearch(t,e,n):this.depthFirstSearch(t,e,n)}breadthFirstSearch(t,e,n={}){const r=[];var i={};const s={};for(r.push(t),s[t.id]=0;0<r.length;){const t=r.shift();null==t||i[t.id]||!(i[t.id]=!0)!==M(e,this,t,s[t.id])&&this.getNeighbors(t,n).forEach((e=>{s[e.id]=s[t.id]+1,r.push(e)}))}}depthFirstSearch(t,e,n={}){const r=[];var i={};const s={};for(r.push(t),s[t.id]=0;0<r.length;){const t=r.pop();if(null!=t&&!i[t.id]&&!(i[t.id]=!0)!==M(e,this,t,s[t.id])){var o=this.getNeighbors(t,n);const e=r.length;o.forEach((n=>{s[n.id]=s[t.id]+1,r.splice(e,0,n)}))}}}getShortestPath(t,e,n={}){const r={};this.getEdges().forEach((t=>{var e=t.getSourceCellId();t=t.getTargetCellId();e&&t&&(r[e]||(r[e]=[]),r[t]||(r[t]=[]),r[e].push(t),n.directed||r[t].push(e))}));t="string"==typeof t?t:t.id;var i=Ji.run(r,t,n.weight),s=[];let o="string"==typeof e?e:e.id;for(i[o]&&s.push(o);o=i[o];)s.unshift(o);return s}translate(t,e,n){return this.getCells().filter((t=>!t.hasParent())).forEach((r=>r.translate(t,e,n))),this}resize(t,e,n){return this.resizeCells(t,e,this.getCells(),n)}resizeCells(t,e,n,r={}){var i=this.getCellsBBox(n);if(i){const s=Math.max(t/i.width,0),o=Math.max(e/i.height,0),a=i.getOrigin();n.forEach((t=>t.scale(s,o,a,r)))}return this}toJSON(t={}){return _c.toJSON(this.getCells(),t)}parseJSON(t){return _c.fromJSON(t)}fromJSON(t,e={}){return t=this.parseJSON(t),this.resetCells(t,e),this}startBatch(t,e={}){return this.batches[t]=(this.batches[t]||0)+1,this.notify("batch:start",{name:t,data:e}),this}stopBatch(t,e={}){return this.batches[t]=(this.batches[t]||0)-1,this.notify("batch:stop",{name:t,data:e}),this}batchUpdate(t,e,n={}){return this.startBatch(t,n),e=e(),this.stopBatch(t,n),e}hasActiveBatch(t=Object.keys(this.batches)){return(Array.isArray(t)?t:[t]).some((t=>0<this.batches[t]))}dispose(){this.collection.dispose()}}Zt([_c.dispose()],_c.prototype,"dispose",null),(Yc=_c=_c||{}).toStringTag="X6."+Yc.name,Yc.isModel=function(t){var e;return null!=t&&(t instanceof Yc||(null==(e=t[Symbol.toStringTag])||e===Yc.toStringTag)&&"function"==typeof t.addNode&&"function"==typeof t.addEdge&&null!=t.collection)},(l=_c=_c||{}).toJSON=function(t,e={}){return{cells:t.map((t=>t.toJSON(e)))}},l.fromJSON=function(t){const e=[];return Array.isArray(t)?e.push(...t):(t.cells&&e.push(...t.cells),t.nodes&&t.nodes.forEach((t=>{null==t.shape&&(t.shape="rect"),e.push(t)})),t.edges&&t.edges.forEach((t=>{null==t.shape&&(t.shape="edge"),e.push(t)}))),e.map((t=>{var e=t.shape;if(e){if($c.registry.exist(e))return $c.create(t);if(Jc.registry.exist(e))return Jc.create(t)}throw new Error("The `shape` should be specified when creating a node/edge instance")}))};var Kc=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};class Qc extends $c{get label(){return this.getLabel()}set label(t){this.setLabel(t)}getLabel(){return this.getAttrByPath("text/text")}setLabel(t,e){return null==t?this.removeLabel():this.setAttrByPath("text/text",t,e),this}removeLabel(){return this.removeAttrByPath("text/text"),this}}(Ce=Qc=Qc||{}).bodyAttr={fill:"#ffffff",stroke:"#333333",strokeWidth:2},Ce.labelAttr={fontSize:14,fill:"#000000",refX:.5,refY:.5,textAnchor:"middle",textVerticalAnchor:"middle",fontFamily:"Arial, helvetica, sans-serif"},Ce.config({attrs:{text:Object.assign({},Ce.labelAttr)},propHooks(t){var e=t["label"];t=Kc(t,["label"]);return e&&mt(t,"attrs/text/text",e),t},visible:!0});var tg=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};function eg(t,e,n={}){var r,i={constructorName:t,markup:([i,r="body"]=[t,n.selector],[{tagName:i,selector:r},{tagName:"text",selector:"label"}]),attrs:{[t]:Object.assign({},Qc.bodyAttr)}};return(n.parent||Qc).define(D.Z(i,e,{shape:t}))}eg("rect",{attrs:{body:{refWidth:"100%",refHeight:"100%"}}});const ng=Jc.define({shape:"edge",markup:[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}],attrs:{lines:{connection:!0,strokeLinejoin:"round"},wrap:{strokeWidth:10},line:{stroke:"#333",strokeWidth:2,targetMarker:"classic"}}});eg("ellipse",{attrs:{body:{refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%"}}});var rg=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};class ig extends Qc{get points(){return this.getPoints()}set points(t){this.setPoints(t)}getPoints(){return this.getAttrByPath("body/refPoints")}setPoints(t,e){return null==t?this.removePoints():this.setAttrByPath("body/refPoints",ig.pointsToString(t),e),this}removePoints(){return this.removeAttrByPath("body/refPoints"),this}}function sg(t){return"string"==typeof t?t:t.map((t=>Array.isArray(t)?t.join(","):Js.isPointLike(t)?t.x+", "+t.y:"")).join(" ")}(h=ig=ig||{}).pointsToString=sg,h.config({propHooks(t){var e=t["points"];t=rg(t,["points"]);return e&&(e=sg(e))&&mt(t,"attrs/body/refPoints",e),t}}),eg("polygon",{},{parent:ig}),eg("polyline",{},{parent:ig});var og,ag,lg=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n},hg=(Qc.define({shape:"path",markup:[{tagName:"rect",selector:"bg"},{tagName:"path",selector:"body"},{tagName:"text",selector:"label"}],attrs:{bg:{refWidth:"100%",refHeight:"100%",fill:"none",stroke:"none",pointerEvents:"all"},body:{fill:"none",stroke:"#000",strokeWidth:2}},propHooks(t){var e=t["path"];t=lg(t,["path"]);return e&&mt(t,"attrs/body/refD",e),t}}),function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n});Qc.define({shape:"text-block",markup:[{tagName:"rect",selector:"body"},Xe.SUPPORT_FOREIGNOBJECT?{tagName:"foreignObject",selector:"foreignObject",children:[{tagName:"div",ns:Dn.xhtml,selector:"label",style:{width:"100%",height:"100%",position:"static",backgroundColor:"transparent",textAlign:"center",margin:0,padding:"0px 5px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"}}]}:{tagName:"text",selector:"label",attrs:{textAnchor:"middle"}}],attrs:{body:Object.assign(Object.assign({},Qc.bodyAttr),{refWidth:"100%",refHeight:"100%"}),foreignObject:{refWidth:"100%",refHeight:"100%"},label:{style:{fontSize:14}}},propHooks(t){var e=t["text"];t=hg(t,["text"]);return e&&mt(t,"attrs/label/text",e),t},attrHooks:{text:{set(t,{cell:e,view:n,refBBox:r,elem:i,attrs:s}){var o,a;if(!(i instanceof HTMLElement))return s=s.style||{},o={text:t,width:-5,height:"100%"},a=Object.assign({textVerticalAnchor:"middle"},s),M(pl.presets.textWrap.set,this,o,{cell:e,view:n,elem:i,refBBox:r,attrs:a}),{fill:s.color||null};i.textContent=t},position(t,{refBBox:e,elem:n}){if(n instanceof SVGElement)return e.getCenter()}}}}),eg("image",{attrs:{image:{refWidth:"100%",refHeight:"100%"}},propHooks:(og="xlink:href",t=>{const{imageUrl:e,imageWidth:n,imageHeight:r}=t,i=tg(t,["imageUrl","imageWidth","imageHeight"]);return null==e&&null==n&&null==r||(t=()=>{var t;i.attrs&&(t=i.attrs.image,null!=e&&(t[og]=e),null!=n&&(t.width=n),null!=r&&(t.height=r),i.attrs.image=t)},i.attrs?null==i.attrs.image&&(i.attrs.image={}):i.attrs={image:{}},t()),i})},{selector:"image"}),eg("circle",{attrs:{body:{refCx:"50%",refCy:"50%",refR:"50%"}}});class ug extends jh{constructor(){super(...arguments),this.portsCache={}}get[Symbol.toStringTag](){return ug.toStringTag}getContainerClassName(){var t=[super.getContainerClassName(),this.prefixClassName("node")];return this.can("nodeMovable")||t.push(this.prefixClassName("node-immovable")),t.join(" ")}updateClassName(t){var e;t=t.target;t.hasAttribute("magnet")?(e=this.prefixClassName("port-unconnectable"),(this.can("magnetConnectable")?Nn:Tn)(t,e)):(t=this.prefixClassName("node-immovable"),this.can("nodeMovable")?this.removeClass(t):this.addClass(t))}isNodeView(){return!0}confirmUpdate(t,e={}){let n=t;return this.hasAction(n,"ports")&&(this.removePorts(),this.cleanPortsCache()),this.hasAction(n,"render")?(this.render(),this.removeAction(n,["render","update","resize","translate","rotate","ports","tools"])):(n=this.handleAction(n,"resize",(()=>this.resize()),"update"),n=this.handleAction(n,"update",(()=>this.update()),Ml.useCSSSelector?"ports":null),n=this.handleAction(n,"translate",(()=>this.translate())),n=this.handleAction(n,"rotate",(()=>this.rotate())),n=this.handleAction(n,"ports",(()=>this.renderPorts())),this.handleAction(n,"tools",(()=>{this.getFlag("tools")===t?this.renderTools():this.updateTools(e)})))}update(t){this.cleanCache(),Ml.useCSSSelector&&this.removePorts();var e=this.cell,n=e.getSize();e=e.getAttrs();this.updateAttrs(this.container,e,{attrs:t===e?null:t,rootBBox:new _s(0,0,n.width,n.height),selectors:this.selectors}),Ml.useCSSSelector&&this.renderPorts()}renderMarkup(){var t=this.cell.markup;if(t){if("string"==typeof t)throw new TypeError("Not support string markup.");return this.renderJSONMarkup(t)}throw new TypeError("Invalid node markup.")}renderJSONMarkup(t){t=this.parseJSONMarkup(t,this.container),this.selectors=t.selectors,this.container.appendChild(t.fragment)}render(){return this.empty(),this.renderMarkup(),this.resize(),this.updateTransform(),Ml.useCSSSelector||this.renderPorts(),this.renderTools(),this}resize(){this.cell.getAngle()&&this.rotate(),this.update()}translate(){this.updateTransform()}rotate(){this.updateTransform()}getTranslationString(){var t=this.cell.getPosition();return`translate(${t.x},${t.y})`}getRotationString(){var t=this.cell.getAngle();if(t)return`rotate(${t},${(t=this.cell.getSize()).width/2},${t.height/2})`}updateTransform(){let t=this.getTranslationString();var e=this.getRotationString();e&&(t+=" "+e),this.container.setAttribute("transform",t)}findPortElem(t,e){var n;t=t?this.portsCache[t]:null;return t?(n=t.portContentElement,t=t.portContentSelectors||{},this.findOne(e,n,t)):null}cleanPortsCache(){this.portsCache={}}removePorts(){Object.values(this.portsCache).forEach((t=>{Xn(t.portElement)}))}renderPorts(){const t=this.container,e=[];t.childNodes.forEach((t=>{e.push(t)}));var n=this.cell.getParsedPorts();const r=Jt(n,"zIndex");r.auto&&r.auto.forEach((n=>{n=this.getPortElement(n),t.append(n),e.push(n)})),Object.keys(r).forEach((t=>{var n;"auto"!==t&&(n=parseInt(t,10),this.appendPorts(r[t],n,e))})),this.updatePorts()}appendPorts(t,e,n){t=t.map((t=>this.getPortElement(t))),n[e]||e<0?Qn(n[Math.max(e,0)],t):_n(this.container,t)}getPortElement(t){var e=this.portsCache[t.id];return e?e.portElement:this.createPortElement(t)}createPortElement(t){var e=Xl.renderMarkup(this.cell.getPortContainerMarkup()).elem;if(null==e)throw new Error("Invalid port container markup.");var n,r=(n=Xl.renderMarkup(this.getPortMarkup(t))).elem,i=n.selectors;if(null==r)throw new Error("Invalid port markup.");this.setAttrs({port:t.id,"port-group":t.group},r);let s,o,a="x6-port",l=(t.group&&(a+=" x6-port-"+t.group),Tn(e,a),Tn(e,"x6-port"),Tn(r,"x6-port-body"),e.appendChild(r),i);if(this.existPortLabel(t)){if(n=Xl.renderMarkup(this.getPortLabelMarkup(t.label)),s=n.elem,o=n.selectors,null==s)throw new Error("Invalid port label markup.");if(i&&o){for(const t in o)if(i[t]&&t!==this.rootSelector)throw new Error("Selectors within port must be unique.");l=Object.assign(Object.assign({},i),o)}Tn(s,"x6-port-label"),e.appendChild(s)}return this.portsCache[t.id]={portElement:e,portSelectors:l,portLabelElement:s,portLabelSelectors:o,portContentElement:r,portContentSelectors:i},this.graph.options.onPortRendered&&this.graph.options.onPortRendered({port:t,node:this.cell,container:e,selectors:l,labelContainer:s,labelSelectors:o,contentContainer:r,contentSelectors:i}),e}updatePorts(){var t=this.cell.getParsedGroups();t=Object.keys(t);0===t.length?this.updatePortGroup():t.forEach((t=>this.updatePortGroup(t)))}updatePortGroup(t){var e=_s.fromSize(this.cell.getSize()),n=this.cell.getPortsLayoutByGroup(t,e);for(let a=0,l=n.length;a<l;a+=1){var r=n[a],i=r.portId,s=(i=this.portsCache[i]||{},r.portLayout),o=(this.applyPortTransform(i.portElement,s),null!=r.portAttrs&&(o={selectors:i.portSelectors||{}},r.portSize&&(o.rootBBox=_s.fromSize(r.portSize)),this.updateAttrs(i.portElement,r.portAttrs,o)),r.labelLayout);o&&i.portLabelElement&&(this.applyPortTransform(i.portLabelElement,o,-(s.angle||0)),o.attrs)&&(s={selectors:i.portLabelSelectors||{}},r.labelSize&&(s.rootBBox=_s.fromSize(r.labelSize)),this.updateAttrs(i.portLabelElement,o.attrs,s))}}applyPortTransform(t,e,n=0){var r=e.angle;e=e.position;Li(t,Pi().rotate(n).translate(e.x||0,e.y||0).rotate(r||0),{absolute:!0})}getPortMarkup(t){return t.markup||this.cell.portMarkup}getPortLabelMarkup(t){return t.markup||this.cell.portLabelMarkup}existPortLabel(t){return t.attrs&&t.attrs.text}getEventArgs(t,e,n){var r=this.cell;return null==e||null==n?{e:t,view:this,node:r,cell:r}:{e:t,x:e,y:n,view:this,node:r,cell:r}}getPortEventArgs(t,e,n){var r=this.cell;return n?{e:t,x:n.x,y:n.y,view:this,node:r,cell:r,port:e}:{e:t,view:this,node:r,cell:r,port:e}}notifyMouseDown(t,e,n){super.onMouseDown(t,e,n),this.notify("node:mousedown",this.getEventArgs(t,e,n))}notifyMouseMove(t,e,n){super.onMouseMove(t,e,n),this.notify("node:mousemove",this.getEventArgs(t,e,n))}notifyMouseUp(t,e,n){super.onMouseUp(t,e,n),this.notify("node:mouseup",this.getEventArgs(t,e,n))}notifyPortEvent(t,e,n){var r,i=this.findAttr("port",e.target);i&&(r=e.type,"node:port:mouseenter"===t?e.type="mouseenter":"node:port:mouseleave"===t&&(e.type="mouseleave"),this.notify(t,this.getPortEventArgs(e,i,n)),e.type=r)}onClick(t,e,n){super.onClick(t,e,n),this.notify("node:click",this.getEventArgs(t,e,n)),this.notifyPortEvent("node:port:click",t,{x:e,y:n})}onDblClick(t,e,n){super.onDblClick(t,e,n),this.notify("node:dblclick",this.getEventArgs(t,e,n)),this.notifyPortEvent("node:port:dblclick",t,{x:e,y:n})}onContextMenu(t,e,n){super.onContextMenu(t,e,n),this.notify("node:contextmenu",this.getEventArgs(t,e,n)),this.notifyPortEvent("node:port:contextmenu",t,{x:e,y:n})}onMouseDown(t,e,n){this.isPropagationStopped(t)||(this.notifyMouseDown(t,e,n),this.notifyPortEvent("node:port:mousedown",t,{x:e,y:n}),this.startNodeDragging(t,e,n))}onMouseMove(t,e,n){var r=this.getEventData(t),i=r.action;"magnet"===i?this.dragMagnet(t,e,n):("move"===i&&((i=r.targetView||this).dragNode(t,e,n),i.notify("node:moving",{e:t,x:e,y:n,view:i,cell:i.cell,node:i.cell})),this.notifyMouseMove(t,e,n),this.notifyPortEvent("node:port:mousemove",t,{x:e,y:n})),this.setEventData(t,r)}onMouseUp(t,e,n){var r=this.getEventData(t),i=r.action;"magnet"===i?this.stopMagnetDragging(t,e,n):(this.notifyMouseUp(t,e,n),this.notifyPortEvent("node:port:mouseup",t,{x:e,y:n}),"move"===i&&(r.targetView||this).stopNodeDragging(t,e,n)),i=r.targetMagnet;i&&this.onMagnetClick(t,i,e,n),this.checkMouseleave(t)}onMouseOver(t){super.onMouseOver(t),this.notify("node:mouseover",this.getEventArgs(t)),this.notifyPortEvent("node:port:mouseenter",t),this.notifyPortEvent("node:port:mouseover",t)}onMouseOut(t){super.onMouseOut(t),this.notify("node:mouseout",this.getEventArgs(t)),this.notifyPortEvent("node:port:mouseleave",t),this.notifyPortEvent("node:port:mouseout",t)}onMouseEnter(t){this.updateClassName(t),super.onMouseEnter(t),this.notify("node:mouseenter",this.getEventArgs(t))}onMouseLeave(t){super.onMouseLeave(t),this.notify("node:mouseleave",this.getEventArgs(t))}onMouseWheel(t,e,n,r){super.onMouseWheel(t,e,n,r),this.notify("node:mousewheel",Object.assign({delta:r},this.getEventArgs(t,e,n)))}onMagnetClick(t,e,n,r){var i=this.graph;i.view.getMouseMovedCount(t)>i.options.clickThreshold||this.notify("node:magnet:click",Object.assign({magnet:e},this.getEventArgs(t,n,r)))}onMagnetDblClick(t,e,n,r){this.notify("node:magnet:dblclick",Object.assign({magnet:e},this.getEventArgs(t,n,r)))}onMagnetContextMenu(t,e,n,r){this.notify("node:magnet:contextmenu",Object.assign({magnet:e},this.getEventArgs(t,n,r)))}onMagnetMouseDown(t,e,n,r){this.startMagnetDragging(t,n,r)}onCustomEvent(t,e,n,r){this.notify("node:customevent",Object.assign({name:e},this.getEventArgs(t,n,r))),super.onCustomEvent(t,e,n,r)}prepareEmbedding(t){var e=this.graph,n=this.getEventData(t).cell||this.cell,r=e.findViewByCell(n);e=e.snapToGrid(t.clientX,t.clientY);this.notify("node:embed",{e:t,node:n,view:r,cell:n,x:e.x,y:e.y,currentParent:n.getParent()})}processEmbedding(t,e){var n,r=e.cell||this.cell,i=e.graph||this.graph,s=i.options.embedding,o=s.findParent;let a="function"==typeof o?M(o,i,{view:this,node:this.cell}).filter((t=>Dc.isCell(t)&&this.cell.id!==t.id&&!t.isDescendantOf(this.cell))):i.model.getNodesUnderNode(r,{by:o}),l=(a=(a=s.frontOnly&&0<a.length&&(o=Jt(a,"zIndex"),n=re(Object.keys(o).map((t=>parseInt(t,10)))))?o[n]:a).filter((t=>t.visible)),null);var h=e.candidateEmbedView,u=s.validate;for(let g=a.length-1;0<=g;--g){var c=a[g];if(h&&h.cell.id===c.id){l=h;break}if(c=c.findView(i),u&&M(u,i,{child:this.cell,parent:c.cell,childView:this,parentView:c})){l=c;break}}this.clearEmbedding(e),l&&l.highlight(null,{type:"embedding"}),e.candidateEmbedView=l,o=i.snapToGrid(t.clientX,t.clientY),this.notify("node:embedding",{e:t,cell:r,node:r,view:i.findViewByCell(r),x:o.x,y:o.y,currentParent:r.getParent(),candidateParent:l?l.cell:null})}clearEmbedding(t){var e=t.candidateEmbedView;e&&(e.unhighlight(null,{type:"embedding"}),t.candidateEmbedView=null)}finalizeEmbedding(t,e){this.graph.startBatch("embedding");var n=e.cell||this.cell,r=e.graph||this.graph,i=r.findViewByCell(n),s=n.getParent(),o=e.candidateEmbedView;o?(o.unhighlight(null,{type:"embedding"}),(e.candidateEmbedView=null)!=s&&s.id===o.cell.id||o.cell.insertChild(n,void 0,{ui:!0})):s&&s.unembed(n,{ui:!0}),r.model.getConnectedEdges(n,{deep:!0}).forEach((t=>{t.updateParent({ui:!0})})),i&&o&&(e=r.snapToGrid(t.clientX,t.clientY),i.notify("node:embedded",{e:t,cell:n,x:e.x,y:e.y,node:n,view:r.findViewByCell(n),previousParent:s,currentParent:n.getParent()})),this.graph.stopBatch("embedding")}getDelegatedView(){let t=this.cell,e=this;for(;e&&!t.isEdge();){if(!t.hasParent()||e.can("stopDelegateOnDragging"))return e;t=t.getParent(),e=this.graph.findViewByCell(t)}return null}validateMagnet(t,e,n){var r;return"passive"!==e.getAttribute("magnet")&&(!(r=this.graph.options.connecting.validateMagnet)||M(r,this.graph,{e:n,magnet:e,view:t,cell:t.cell}))}startMagnetDragging(t,e,n){var r,i;this.can("magnetConnectable")&&(t.stopPropagation(),r=t.currentTarget,i=this.graph,this.setEventData(t,{targetMagnet:r}),this.validateMagnet(this,r,t)?(i.options.magnetThreshold<=0&&this.startConnectting(t,r,e,n),this.setEventData(t,{action:"magnet"}),this.stopPropagation(t)):this.onMouseDown(t,e,n),i.view.delegateDragEvents(t,this))}startConnectting(t,e,n,r){this.graph.model.startBatch("add-edge"),e=this.createEdgeFromMagnet(e,n,r),e.setEventData(t,e.prepareArrowheadDragging("target",{x:n,y:r,isNewEdge:!0,fallbackAction:"remove"})),this.setEventData(t,{edgeView:e}),e.notifyMouseDown(t,n,r)}getDefaultEdge(t,e){let n;var r=this.graph.options.connecting.createEdge;return r?M(r,this.graph,{sourceMagnet:e,sourceView:t,sourceCell:t.cell}):n}createEdgeFromMagnet(t,e,n){var r=this.graph,i=r.model,s=this.getDefaultEdge(this,t);return s.setSource(Object.assign(Object.assign({},s.getSource()),this.getEdgeTerminal(t,e,n,s,"source"))),s.setTarget(Object.assign(Object.assign({},s.getTarget()),{x:e,y:n})),s.addTo(i,{async:!1,ui:!0}),s.findView(r)}dragMagnet(t,e,n){var r=this.getEventData(t),i=r.edgeView;if(i)i.onMouseMove(t,e,n),this.autoScrollGraph(t.clientX,t.clientY);else{i=this.graph;var s=i.options.magnetThreshold,o=this.getEventTarget(t);r=r.targetMagnet;if("onleave"===s){if(r===o||r.contains(o))return}else if(i.view.getMouseMovedCount(t)<=s)return;this.startConnectting(t,r,e,n)}}stopMagnetDragging(t,e,n){var r=this.eventData(t).edgeView;r&&(r.onMouseUp(t,e,n),this.graph.model.stopBatch("add-edge"))}notifyUnhandledMouseDown(t,e,n){this.notify("node:unhandled:mousedown",{e:t,x:e,y:n,view:this,cell:this.cell,node:this.cell})}notifyNodeMove(t,e,n,r,i){let s=[i];var o=this.graph.getPlugin("selection");(s=o&&o.isSelectionMovable()&&(o=o.getSelectedCells()).includes(i)?o.filter((t=>t.isNode())):s).forEach((i=>{this.notify(t,{e:e,x:n,y:r,cell:i,node:i,view:i.findView(this.graph)})}))}getRestrictArea(t){var e=this.graph.options.translating.restrict;t="function"==typeof e?M(e,this.graph,t):e;return"number"==typeof t?this.graph.transform.getGraphArea().inflate(t):!0===t?this.graph.transform.getGraphArea():t||null}startNodeDragging(t,e,n){var r=this.getDelegatedView();if(null==r||!r.can("nodeMovable"))return this.notifyUnhandledMouseDown(t,e,n);this.setEventData(t,{targetView:r,action:"move"});var i=Js.create(r.cell.getPosition());r.setEventData(t,{moving:!1,offset:i.diff(e,n),restrict:this.getRestrictArea(r)})}dragNode(t,e,n){var r=this.cell,i=this.graph,s=i.getGridSize(),o=this.getEventData(t),a=o.offset,l=o.restrict;o.moving||(o.moving=!0,this.addClass("node-moving"),this.notifyNodeMove("node:move",t,e,n,this.cell)),this.autoScrollGraph(t.clientX,t.clientY),e=Qi.snapToGrid(e+a.x,s),n=Qi.snapToGrid(n+a.y,s);r.setPosition(e,n,{restrict:l,deep:!0,ui:!0}),i.options.embedding.enabled&&(o.embedding||(this.prepareEmbedding(t),o.embedding=!0),this.processEmbedding(t,o))}stopNodeDragging(t,e,n){var r=this.getEventData(t);r.embedding&&this.finalizeEmbedding(t,r),r.moving&&(this.removeClass("node-moving"),this.notifyNodeMove("node:moved",t,e,n,this.cell)),r.moving=!1,r.embedding=!1}autoScrollGraph(t,e){var n=this.graph.getPlugin("scroller");n&&n.autoScroll(t,e)}}(ag=ug=ug||{}).toStringTag="X6."+ag.name,ag.isNodeView=function(t){var e;return null!=t&&(t instanceof ag||(null==(e=t[Symbol.toStringTag])||e===ag.toStringTag)&&"function"==typeof t.isNodeView&&"function"==typeof t.isEdgeView&&"function"==typeof t.confirmUpdate&&"function"==typeof t.update&&"function"==typeof t.findPortElem&&"function"==typeof t.resize&&"function"==typeof t.rotate&&"function"==typeof t.translate)},ug.config({isSvgElement:!0,priority:0,bootstrap:["render"],actions:{view:["render"],markup:["render"],attrs:["update"],size:["resize","ports","tools"],angle:["rotate","tools"],position:["translate","tools"],ports:["ports"],tools:["tools"]}}),ug.registry.register("node",ug,!0);var cg,gg=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};class dg extends jh{constructor(){super(...arguments),this.POINT_ROUNDING=2,this.labelDestroyFn={}}get[Symbol.toStringTag](){return dg.toStringTag}getContainerClassName(){return[super.getContainerClassName(),this.prefixClassName("edge")].join(" ")}get sourceBBox(){var t,e=this.sourceView;return e?(t=this.sourceMagnet,e.isEdgeElement(t)?new _s(this.sourceAnchor.x,this.sourceAnchor.y):e.getBBoxOfElement(t||e.container)):(t=this.cell.getSource(),new _s(t.x,t.y))}get targetBBox(){var t,e=this.targetView;return e?(t=this.targetMagnet,e.isEdgeElement(t)?new _s(this.targetAnchor.x,this.targetAnchor.y):e.getBBoxOfElement(t||e.container)):(t=this.cell.getTarget(),new _s(t.x,t.y))}isEdgeView(){return!0}confirmUpdate(t,e={}){let n=t;if(this.hasAction(n,"source")){if(!this.updateTerminalProperties("source"))return n;n=this.removeAction(n,"source")}if(this.hasAction(n,"target")){if(!this.updateTerminalProperties("target"))return n;n=this.removeAction(n,"target")}return this.hasAction(n,"render")?(this.render(),this.removeAction(n,["render","update","labels","tools"])):(n=this.handleAction(n,"update",(()=>this.update(e))),n=this.handleAction(n,"labels",(()=>this.onLabelsChange(e))),this.handleAction(n,"tools",(()=>this.renderTools())))}render(){return this.empty(),this.renderMarkup(),this.labelContainer=null,this.renderLabels(),this.update(),this.renderTools(),this}renderMarkup(){var t=this.cell.markup;if(t){if("string"==typeof t)throw new TypeError("Not support string markup.");return this.renderJSONMarkup(t)}throw new TypeError("Invalid edge markup.")}renderJSONMarkup(t){t=this.parseJSONMarkup(t,this.container),this.selectors=t.selectors,this.container.append(t.fragment)}customizeLabels(){if(this.labelContainer){var t=this.cell,e=t.labels;for(let o=0,a=e.length;o<a;o+=1){var n=e[o],r=this.labelCache[o],i=this.labelSelectors[o],s=this.graph.options.onEdgeLabelRendered;s&&(s=s({edge:t,label:n,container:r,selectors:i}))&&(this.labelDestroyFn[o]=s)}}}destroyCustomizeLabels(){var t=this.cell.labels;if(this.labelCache&&this.labelSelectors&&this.labelDestroyFn)for(let i=0,s=t.length;i<s;i+=1){var e=this.labelDestroyFn[i],n=this.labelCache[i],r=this.labelSelectors[i];e&&n&&r&&e({edge:this.cell,label:t[i],container:n,selectors:r})}this.labelDestroyFn={}}renderLabels(){var t=this.cell,e=t.getLabels(),n=e.length;let r=this.labelContainer;if(this.labelCache={},this.labelSelectors={},n<=0)r&&r.parentNode&&r.parentNode.removeChild(r);else{r?this.empty(r):(r=Fn("g"),this.addClass(this.prefixClassName("edge-labels"),r),this.labelContainer=r);for(let n=0,s=e.length;n<s;n+=1){var i=e[n];i=this.normalizeLabelMarkup(this.parseLabelMarkup(i.markup));let s,o;if(o=(i?(s=i.node,i):(i=t.getDefaultLabel(),i=this.normalizeLabelMarkup(this.parseLabelMarkup(i.markup)),s=i.node,i)).selectors,s.setAttribute("data-index",""+n),r.appendChild(s),i=this.rootSelector,o[i])throw new Error("Ambiguous label root selector.");o[i]=s,this.labelCache[n]=s,this.labelSelectors[n]=o}null==r.parentNode&&this.container.appendChild(r),this.updateLabels(),this.customizeLabels()}return this}onLabelsChange(t={}){this.destroyCustomizeLabels(),this.shouldRerenderLabels(t)?this.renderLabels():this.updateLabels(),this.updateLabelPositions()}shouldRerenderLabels(t={}){var e=this.cell.previous("labels");if(null!=e&&"propertyPathArray"in t&&"propertyValue"in t){var n=t.propertyPathArray||[],r=n.length;if(1<r&&e[n[1]]){if(2===r)return"object"==typeof t.propertyValue&&R(t.propertyValue,"markup");if("markup"!==n[2])return!1}}return!0}parseLabelMarkup(t){return t?"string"==typeof t?this.parseLabelStringMarkup(t):this.parseJSONMarkup(t):null}parseLabelStringMarkup(t){var e=Wr.createVectors(t),n=document.createDocumentFragment();for(let i=0,s=e.length;i<s;i+=1){var r=e[i].node;n.appendChild(r)}return{fragment:n,selectors:{}}}normalizeLabelMarkup(t){if(null!=t){var e=t.fragment;if(!(e instanceof DocumentFragment&&e.hasChildNodes()))throw new Error("Invalid label markup.");let r;var n=e.childNodes;return(r=1<n.length||"G"!==n[0].nodeName.toUpperCase()?Wr.create("g").append(e):Wr.create(n[0])).addClass(this.prefixClassName("edge-label")),{node:r.node,selectors:t.selectors}}}updateLabels(){if(this.labelContainer){var t=this.cell,e=t.labels,n=this.can("edgeLabelMovable"),r=t.getDefaultLabel();for(let t=0,l=e.length;t<l;t+=1){var i=this.labelCache[t],s=this.labelSelectors[t],o=(i.setAttribute("cursor",n?"move":"default"),e[t]),a=D.Z({},r.attrs,o.attrs);this.updateAttrs(i,a,{selectors:s,rootBBox:o.size?_s.fromSize(o.size):void 0})}}}renderTools(){var t=this.cell.getTools();return this.addTools(t),this}update(t={}){this.cleanCache(),this.updateConnection(t);var e=this.cell.getAttrs(),{}=e;e=gg(e,["text"]);return null!=e&&this.updateAttrs(this.container,e,{selectors:this.selectors}),this.updateLabelPositions(),this.updateTools(t),this}removeRedundantLinearVertices(t={}){var e=this.cell,n=e.getVertices(),r=(n=[this.sourceAnchor,...n,this.targetAnchor],n.length),i=(n=new lo(n),n=(n.simplify({threshold:.01}),n.points.map((t=>t.toJSON()))),n.length);return r===i?0:(e.setVertices(n.slice(1,i-1),t),r-i)}getTerminalView(t){switch(t){case"source":return this.sourceView||null;case"target":return this.targetView||null;default:throw new Error(`Unknown terminal type '${t}'`)}}getTerminalAnchor(t){switch(t){case"source":return Js.create(this.sourceAnchor);case"target":return Js.create(this.targetAnchor);default:throw new Error(`Unknown terminal type '${t}'`)}}getTerminalConnectionPoint(t){switch(t){case"source":return Js.create(this.sourcePoint);case"target":return Js.create(this.targetPoint);default:throw new Error(`Unknown terminal type '${t}'`)}}getTerminalMagnet(t,e={}){switch(t){case"source":return e.raw?this.sourceMagnet:(n=this.sourceView)?this.sourceMagnet||n.container:null;case"target":var n;return e.raw?this.targetMagnet:(n=this.targetView)?this.targetMagnet||n.container:null;default:throw new Error(`Unknown terminal type '${t}'`)}}updateConnection(t={}){var e,n=this.cell;t.translateBy&&n.isFragmentDescendantOf(t.translateBy)?(e=t.tx||0,t=t.ty||0,this.routePoints=new lo(this.routePoints).translate(e,t).points,this.translateConnectionPoints(e,t),this.path.translate(e,t)):(e=n.getVertices(),t=this.findAnchors(e),this.sourceAnchor=t.source,this.targetAnchor=t.target,this.routePoints=this.findRoutePoints(e),n=this.findConnectionPoints(this.routePoints,this.sourceAnchor,this.targetAnchor),this.sourcePoint=n.source,this.targetPoint=n.target,t=this.findMarkerPoints(this.routePoints,this.sourcePoint,this.targetPoint),this.path=this.findPath(this.routePoints,t.source||this.sourcePoint,t.target||this.targetPoint)),this.cleanCache()}findAnchors(t){var e=this.cell,n=e.source,r=(e=e.target,t[0]);t=t[t.length-1];return e.priority&&!n.priority?this.findAnchorsOrdered("target",t,"source",r):this.findAnchorsOrdered("source",r,"target",t)}findAnchorsOrdered(t,e,n,r){let i,s;var o=this.cell,a=o[t],l=(o=o[n],this.getTerminalView(t)),h=this.getTerminalView(n),u=this.getTerminalMagnet(t),c=this.getTerminalMagnet(n);if(l){let n;n=e?Js.create(e):h?c:Js.create(o),i=this.getAnchor(a.anchor,l,u,n,t)}else i=Js.create(a);return s=h?(e=Js.create(r||i),this.getAnchor(o.anchor,h,c,e,n)):Js.isPointLike(o)?Js.create(o):new Js,{[t]:i,[n]:s}}getAnchor(t,e,n,r,i){var s=e.isEdgeElement(n),o=this.graph.options.connecting;let a,l="string"==typeof t?{name:t}:t;if(l||(t=s?("source"===i?o.sourceEdgeAnchor:o.targetEdgeAnchor)||o.edgeAnchor:("source"===i?o.sourceAnchor:o.targetAnchor)||o.anchor,l="string"==typeof t?{name:t}:t),!l)throw new Error("Anchor should be specified.");if(o=l.name,s){if(t=Su.registry.get(o),"function"!=typeof t)return Su.registry.onNotFound(o);a=M(t,this,e,n,r,l.args||{},i)}else{if(s=wu.registry.get(o),"function"!=typeof s)return wu.registry.onNotFound(o);a=M(s,this,e,n,r,l.args||{},i)}return a?a.round(this.POINT_ROUNDING):new Js}findRoutePoints(t=[]){var e=this.graph.options.connecting.router||Nu.presets.normal;e=this.cell.getRouter()||e;let n;if("function"==typeof e)n=M(e,this,t,{},this);else{var r="string"==typeof e?e:e.name,i=(e="string"!=typeof e&&e.args||{},r?Nu.registry.get(r):Nu.presets.normal);if("function"!=typeof i)return Nu.registry.onNotFound(r);n=M(i,this,t,e,this)}return null==n?t.map((t=>Js.create(t))):n.map((t=>Js.create(t)))}findConnectionPoints(t,e,n){var r,i=this.cell,s=this.graph.options.connecting,o=i.getSource(),a=(i=i.getTarget(),this.sourceView),l=this.targetView,h=t[0];t=t[t.length-1];let u,c;return u=a&&!a.isEdgeElement(this.sourceMagnet)?(r=this.sourceMagnet||a.container,h=h||n,h=new Qs(h,e),o=o.connectionPoint||s.sourceConnectionPoint||s.connectionPoint,this.getConnectionPoint(o,a,r,h,"source")):e,c=l&&!l.isEdgeElement(this.targetMagnet)?(o=this.targetMagnet||l.container,a=i.connectionPoint||s.targetConnectionPoint||s.connectionPoint,r=t||e,h=new Qs(r,n),this.getConnectionPoint(a,l,o,h,"target")):n,{source:u,target:c}}getConnectionPoint(t,e,n,r,i){var s,o,a=r.end;return null==t?a:(o="string"==typeof t?t:t.name,t="string"==typeof t?{}:t.args,"function"!=typeof(s=Ou.registry.get(o))?Ou.registry.onNotFound(o):(o=M(s,this,r,e,n,t||{},i))?o.round(this.POINT_ROUNDING):a)}findMarkerPoints(t,e,n){var r=t=>{var e=this.cell.getAttrs(),n=Object.keys(e);for(let i=0,s=n.length;i<s;i+=1){var r=e[n[i]];if(r[t+"Marker"]||r[t+"-marker"]){if(r=r.strokeWidth||r["stroke-width"],r)return parseFloat(r);break}}return null},i=t[0];t=t[t.length-1];let s,o;var a=r("source");a&&(s=e.clone().move(i||n,-a)),i=r("target");return i&&(o=n.clone().move(t||e,-i)),this.sourceMarkerPoint=s||e.clone(),this.targetMarkerPoint=o||n.clone(),{source:s,target:o}}findPath(t,e,n){var r=this.cell.getConnector()||this.graph.options.connecting.connector;let i,s,o;if("string"==typeof r?i=r:(i=r.name,s=r.args),i){if(r=ku.registry.get(i),"function"!=typeof r)return ku.registry.onNotFound(i);o=r}else o=ku.presets.normal;return r=M(o,this,e,n,t,Object.assign(Object.assign({},s),{raw:!0}),this),"string"==typeof r?Po.parse(r):r}translateConnectionPoints(t,e){this.sourcePoint.translate(t,e),this.targetPoint.translate(t,e),this.sourceAnchor.translate(t,e),this.targetAnchor.translate(t,e),this.sourceMarkerPoint.translate(t,e),this.targetMarkerPoint.translate(t,e)}updateLabelPositions(){if(null!=this.labelContainer&&this.path){var t=this.cell,e=t.getLabels();if(0!==e.length){t=t.getDefaultLabel();var n=this.normalizeLabelPosition(t.position);for(let t=0,s=e.length;t<s;t+=1){var r=e[t],i=this.labelCache[t];i&&(r=this.normalizeLabelPosition(r.position),r=D.Z({},n,r),r=this.getLabelTransformationMatrix(r),i.setAttribute("transform",Mi(r)))}}}return this}updateTerminalProperties(t){var e=this.cell,n=this.graph,r=(e=e[t],e=e&&e.cell,t+"View");if(e){var i=n.getCellById(e);if(!i)throw new Error(`Edge's ${t} node with id "${e}" not exists`);if(!(e=i.findView(n)))return!1;this[r]=e}else this[r]=null;return this.updateTerminalMagnet(t),!0}updateTerminalMagnet(t){var e=t+"Magnet",n=this.getTerminalView(t);if(n){let r=n.getMagnetFromEdgeTerminal(this.cell[t]);r===n.container&&(r=null),this[e]=r}else this[e]=null}getLabelPositionAngle(t){return t=this.cell.getLabelAt(t),t&&t.position&&"object"==typeof t.position&&t.position.angle||0}getLabelPositionArgs(t){if(t=this.cell.getLabelAt(t),t&&t.position&&"object"==typeof t.position)return t.position.options}getDefaultLabelPositionArgs(){var t=this.cell.getDefaultLabel();if(t&&t.position&&"object"==typeof t.position)return t.position.options}mergeLabelPositionArgs(t,e){return null===t?null:void 0===t?null===e?null:e:D.Z({},e,t)}getConnection(){return null!=this.path?this.path.clone():null}getConnectionPathData(){var t;return null!=this.path&&(t=this.cache.pathCache,R(t,"data")||(t.data=this.path.serialize()),t.data)||""}getConnectionSubdivisions(){var t;return null==this.path?null:(t=this.cache.pathCache,R(t,"segmentSubdivisions")||(t.segmentSubdivisions=this.path.getSegmentSubdivisions()),t.segmentSubdivisions)}getConnectionLength(){var t;return null==this.path?0:(t=this.cache.pathCache,R(t,"length")||(t.length=this.path.length({segmentSubdivisions:this.getConnectionSubdivisions()})),t.length)}getPointAtLength(t){return null==this.path?null:this.path.pointAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getPointAtRatio(t){return null==this.path?null:(nn(t)&&(t=parseFloat(t)/100),this.path.pointAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()}))}getTangentAtLength(t){return null==this.path?null:this.path.tangentAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getTangentAtRatio(t){return null==this.path?null:this.path.tangentAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPoint(t){return null==this.path?null:this.path.closestPoint(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPointLength(t){return null==this.path?null:this.path.closestPointLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPointRatio(t){return null==this.path?null:this.path.closestPointNormalizedLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getLabelPosition(t,e,n,r){var i={distance:0};let s,o=0;null!=(s="number"==typeof n?(o=n,r):n)&&(i.options=s);r=s&&s.absoluteOffset,n=!(s&&s.absoluteDistance);var a=s&&s.absoluteDistance&&s.reverseDistance,l=this.path,h={segmentSubdivisions:this.getConnectionSubdivisions()},u=(t=new Js(t,e),e=l.closestPointT(t,h),this.getConnectionLength()||0);let c,g,d=l.lengthAtT(e,h);return n&&(d=0<u?d/u:0),a&&(d=-1*(u-d)||1),i.distance=d,r||(c=l.tangentAtT(e)),g=c?c.pointOffset(t):(h=l.pointAtT(e),{x:(n=t.diff(h)).x,y:n.y}),i.offset=g,i.angle=o,i}normalizeLabelPosition(t){return"number"==typeof t?{distance:t}:t}getLabelTransformationMatrix(t){t=this.normalizeLabelPosition(t);var e=t.options||{},n=t.angle||0,r=t.distance,i=0<r&&r<=1;let s=0;var o={x:0,y:0},a=(t=t.offset,t=(t&&("number"==typeof t?s=t:(null!=t.x&&(o.x=t.x),null!=t.y&&(o.y=t.y))),0!==o.x||0!==o.y||0===s),e.keepGradient),l=(e=e.ensureLegibility,this.path),h={segmentSubdivisions:this.getConnectionSubdivisions()};i=i?r*this.getConnectionLength():r,r=l.tangentAtLength(i,h);let u,c=n;return r?(t?(u=r.start).translate(o):((i=r.clone()).rotate(-90,r.start),i.setLength(s),u=i.end),a&&(c=r.angle()+n,e)&&(c=Ki.normalize((c+90)%180-90))):(u=l.start,t&&u.translate(o)),Pi().translate(u.x,u.y).rotate(c)}getVertexIndex(t,e){var n=this.cell.getVertices(),r=this.getClosestPointLength(new Js(t,e));let i=0;if(null!=r)for(var s=n.length;i<s;i+=1){var o=n[i];o=this.getClosestPointLength(o);if(null!=o&&r<o)break}return i}getEventArgs(t,e,n){var r=this.cell;return null==e||null==n?{e:t,view:this,edge:r,cell:r}:{e:t,x:e,y:n,view:this,edge:r,cell:r}}notifyUnhandledMouseDown(t,e,n){this.notify("edge:unhandled:mousedown",{e:t,x:e,y:n,view:this,cell:this.cell,edge:this.cell})}notifyMouseDown(t,e,n){super.onMouseDown(t,e,n),this.notify("edge:mousedown",this.getEventArgs(t,e,n))}notifyMouseMove(t,e,n){super.onMouseMove(t,e,n),this.notify("edge:mousemove",this.getEventArgs(t,e,n))}notifyMouseUp(t,e,n){super.onMouseUp(t,e,n),this.notify("edge:mouseup",this.getEventArgs(t,e,n))}onClick(t,e,n){super.onClick(t,e,n),this.notify("edge:click",this.getEventArgs(t,e,n))}onDblClick(t,e,n){super.onDblClick(t,e,n),this.notify("edge:dblclick",this.getEventArgs(t,e,n))}onContextMenu(t,e,n){super.onContextMenu(t,e,n),this.notify("edge:contextmenu",this.getEventArgs(t,e,n))}onMouseDown(t,e,n){this.notifyMouseDown(t,e,n),this.startEdgeDragging(t,e,n)}onMouseMove(t,e,n){var r=this.getEventData(t);switch(r.action){case"drag-label":this.dragLabel(t,e,n);break;case"drag-arrowhead":this.dragArrowhead(t,e,n);break;case"drag-edge":this.dragEdge(t,e,n)}return this.notifyMouseMove(t,e,n),r}onMouseUp(t,e,n){var r=this.getEventData(t);switch(r.action){case"drag-label":this.stopLabelDragging(t,e,n);break;case"drag-arrowhead":this.stopArrowheadDragging(t,e,n);break;case"drag-edge":this.stopEdgeDragging(t,e,n)}return this.notifyMouseUp(t,e,n),this.checkMouseleave(t),r}onMouseOver(t){super.onMouseOver(t),this.notify("edge:mouseover",this.getEventArgs(t))}onMouseOut(t){super.onMouseOut(t),this.notify("edge:mouseout",this.getEventArgs(t))}onMouseEnter(t){super.onMouseEnter(t),this.notify("edge:mouseenter",this.getEventArgs(t))}onMouseLeave(t){super.onMouseLeave(t),this.notify("edge:mouseleave",this.getEventArgs(t))}onMouseWheel(t,e,n,r){super.onMouseWheel(t,e,n,r),this.notify("edge:mousewheel",Object.assign({delta:r},this.getEventArgs(t,e,n)))}onCustomEvent(t,e,n,r){if(Jn(t.target,"edge-tool",this.container)){if(t.stopPropagation(),this.can("useEdgeTools")){if("edge:remove"===e)return void this.cell.remove({ui:!0});this.notify("edge:customevent",Object.assign({name:e},this.getEventArgs(t,n,r)))}this.notifyMouseDown(t,n,r)}else this.notify("edge:customevent",Object.assign({name:e},this.getEventArgs(t,n,r))),super.onCustomEvent(t,e,n,r)}onLabelMouseDown(t,e,n){this.notifyMouseDown(t,e,n),this.startLabelDragging(t,e,n),this.getEventData(t).stopPropagation&&t.stopPropagation()}startEdgeDragging(t,e,n){this.can("edgeMovable")?this.setEventData(t,{x:e,y:n,moving:!1,action:"drag-edge"}):this.notifyUnhandledMouseDown(t,e,n)}dragEdge(t,e,n){var r=this.getEventData(t);r.moving||(r.moving=!0,this.addClass("edge-moving"),this.notify("edge:move",{e:t,x:e,y:n,view:this,cell:this.cell,edge:this.cell})),this.cell.translate(e-r.x,n-r.y,{ui:!0}),this.setEventData(t,{x:e,y:n}),this.notify("edge:moving",{e:t,x:e,y:n,view:this,cell:this.cell,edge:this.cell})}stopEdgeDragging(t,e,n){var r=this.getEventData(t);r.moving&&(this.removeClass("edge-moving"),this.notify("edge:moved",{e:t,x:e,y:n,view:this,cell:this.cell,edge:this.cell})),r.moving=!1}prepareArrowheadDragging(t,e){var n=this.getTerminalMagnet(t);n={action:"drag-arrowhead",x:e.x,y:e.y,isNewEdge:!0===e.isNewEdge,terminalType:t,initialMagnet:n,initialTerminal:Y.Z(this.cell[t]),fallbackAction:e.fallbackAction||"revert",getValidateConnectionArgs:this.createValidateConnectionArgs(t),options:e.options};return this.beforeArrowheadDragging(n),n}createValidateConnectionArgs(t){const e=[];e[4]=t,e[5]=this;let n,r=0,i=0;n="source"===t?(r=2,"target"):(i=2,"source");t=this.cell[n];var s=t.cell;if(s){let n;s=e[r]=this.graph.findViewByCell(s),s&&(n=s.getMagnetFromEdgeTerminal(t))===s.container&&(n=void 0),e[r+1]=n}return(t,n)=>(e[i]=t,e[i+1]=t.container===n?void 0:n,e)}beforeArrowheadDragging(t){t.zIndex=this.cell.zIndex,this.cell.toFront();var e=this.container.style;t.pointerEvents=e.pointerEvents,e.pointerEvents="none",this.graph.options.connecting.highlight&&this.highlightAvailableMagnets(t)}afterArrowheadDragging(t){null!=t.zIndex&&(this.cell.setZIndex(t.zIndex,{ui:!0}),t.zIndex=null),this.container.style.pointerEvents=t.pointerEvents||"",this.graph.options.connecting.highlight&&this.unhighlightAvailableMagnets(t)}validateConnection(t,e,n,r,i,s,o){var a=this.graph.options.connecting,l=a.allowLoop,h=a.allowNode,u=a.allowEdge,c=a.allowPort,g=a.allowMulti;a=a.validateConnection;const d=s?s.cell:null;var p="target"===i?n:t,f="target"===i?r:e;let m=!0;var v=a=>{var l="source"===i?o?o.port:null:d?d.getSourcePortId():null,h="target"===i?o?o.port:null:d?d.getTargetPortId():null;return M(a,this.graph,{edge:d,edgeView:s,sourceView:t,targetView:n,sourcePort:l,targetPort:h,sourceMagnet:e,targetMagnet:r,sourceCell:t?t.cell:null,targetCell:n?n.cell:null,type:i})};if(null!=l&&("boolean"==typeof l?l||t!==n||(m=!1):m=v(l)),m&&null!=c&&("boolean"==typeof c?!c&&f&&(m=!1):m=v(c)),m&&null!=u&&("boolean"==typeof u?!u&&dg.isEdgeView(p)&&(m=!1):m=v(u)),m&&null!=h&&null==f&&("boolean"==typeof h?!h&&ug.isNodeView(p)&&(m=!1):m=v(h)),m&&null!=g&&s){const t=s.cell,e="source"===i?o:t.getSource(),n="target"===i?o:t.getTarget();l=o?this.graph.getCellById(o.cell):null,e&&n&&e.cell&&n.cell&&l&&("function"==typeof g?m=v(g):(c=this.graph.model.getConnectedEdges(l,{outgoing:"source"===i,incoming:"target"===i})).length&&("withPort"===g?c.some((t=>{var r=t.getSource();t=t.getTarget();return r&&t&&r.cell===e.cell&&t.cell===n.cell&&null!=r.port&&r.port===e.port&&null!=t.port&&t.port===n.port}))&&(m=!1):g||c.some((t=>{var r=t.getSource();t=t.getTarget();return r&&t&&r.cell===e.cell&&t.cell===n.cell}))&&(m=!1)))}return m&&null!=a?v(a):m}allowConnectToBlank(t){var e,n,r,i,s,o=this.graph,a=o.options.connecting.allowBlank;return"function"!=typeof a?!!a:(e=o.findViewByCell(t),n=t.getSourceCell(),r=t.getTargetCell(),i=o.findViewByCell(n),s=o.findViewByCell(r),M(a,o,{edge:t,edgeView:e,sourceCell:n,targetCell:r,sourceView:i,targetView:s,sourcePort:t.getSourcePortId(),targetPort:t.getTargetPortId(),sourceMagnet:e.sourceMagnet,targetMagnet:e.targetMagnet}))}validateEdge(t,e,n){var r=this.graph;if(!this.allowConnectToBlank(t)){var i=t.getSourceCellId(),s=t.getTargetCellId();if(!i||!s)return!1}return i=r.options.connecting.validateEdge,!i||M(i,r,{edge:t,type:e,previous:n})}arrowheadDragging(t,e,n,r){r.x=e,r.y=n,r.currentTarget!==t&&(r.currentMagnet&&r.currentView&&r.currentView.unhighlight(r.currentMagnet,{type:"magnetAdsorbed"}),r.currentView=this.graph.findViewByElem(t),r.currentView&&(r.currentMagnet=r.currentView.findMagnet(t),r.currentMagnet)&&this.validateConnection(...r.getValidateConnectionArgs(r.currentView,r.currentMagnet),r.currentView.getEdgeTerminal(r.currentMagnet,e,n,this.cell,r.terminalType))?r.currentView.highlight(r.currentMagnet,{type:"magnetAdsorbed"}):r.currentMagnet=null),r.currentTarget=t,this.cell.prop(r.terminalType,{x:e,y:n},Object.assign(Object.assign({},r.options),{ui:!0}))}arrowheadDragged(t,e,n){var r=t.currentView,i=t.currentMagnet;i&&r&&(r.unhighlight(i,{type:"magnetAdsorbed"}),t=t.terminalType,r=r.getEdgeTerminal(i,e,n,this.cell,t),this.cell.setTerminal(t,r,{ui:!0}))}snapArrowhead(t,e,n){var r=this.graph,{snap:i,allowEdge:s}=r.options.connecting;const o="object"==typeof i&&i.radius||50,a="object"==typeof i&&i.anchor||"center";i=r.renderer.findViewsInArea({x:t-o,y:e-o,width:2*o,height:2*o},{nodeOnly:!0}),s&&(s=r.renderer.findEdgeViewsFromPoint({x:t,y:e},o).filter((t=>t!==this)),i.push(...s)),r=n.closestView||null;const l=n.closestMagnet||null;n.closestView=null,n.closestMagnet=null;let h,u=Number.MAX_SAFE_INTEGER;const c=new Js(t,e);let g;i.forEach((r=>{var i;"false"!==r.container.getAttribute("magnet")&&(r.isNodeView()?h=("center"===a?r.cell.getBBox().getCenter():r.cell.getBBox().getNearestPointToPoint(c)).distance(c):r.isEdgeView()&&(i=r.getClosestPoint(c),h=i?i.distance(c):Number.MAX_SAFE_INTEGER),h<o)&&h<u&&(l!==r.container&&!this.validateConnection(...n.getValidateConnectionArgs(r,null),r.getEdgeTerminal(r.container,t,e,this.cell,n.terminalType))||(u=h,n.closestView=r,n.closestMagnet=r.container)),r.container.querySelectorAll("[magnet]").forEach((i=>{var s;"false"!==i.getAttribute("magnet")&&(s=r.getBBoxOfElement(i),(h=c.distance(s.getCenter()))<o)&&h<u&&(l!==i&&!this.validateConnection(...n.getValidateConnectionArgs(r,i),r.getEdgeTerminal(i,t,e,this.cell,n.terminalType))||(u=h,n.closestView=r,n.closestMagnet=i))}))}));var s=n.terminalType,i=n.closestView,d=n.closestMagnet,p=l!==d;if(r&&p&&r.unhighlight(l,{type:"magnetAdsorbed"}),i){if(!p)return;i.highlight(d,{type:"magnetAdsorbed"}),g=i.getEdgeTerminal(d,t,e,this.cell,s)}else g={x:t,y:e};this.cell.setTerminal(s,g,{},Object.assign(Object.assign({},n.options),{ui:!0}))}snapArrowheadEnd(t){var e=t.closestView,n=t.closestMagnet;e&&n&&(e.unhighlight(n,{type:"magnetAdsorbed"}),t.currentMagnet=e.findMagnet(n)),t.closestView=null,t.closestMagnet=null}finishEmbedding(t){this.graph.options.embedding.enabled&&this.cell.updateParent()&&(t.zIndex=null)}fallbackConnection(t){"remove"===t.fallbackAction?this.cell.remove({ui:!0}):this.cell.prop(t.terminalType,t.initialTerminal,{ui:!0})}notifyConnectionEvent(t,e){var n,r,i,s,o,a,l=t.terminalType,h=t.initialTerminal,u=this.cell[l];u&&!Jc.equalTerminals(h,u)&&(a=this.graph,n=(r=h).cell?a.getCellById(r.cell):null,r=r.port,i=n?a.findViewByCell(n):null,h=n||t.isNewEdge?null:Js.create(h).toJSON(),s=(o=u).cell?a.getCellById(o.cell):null,o=o.port,a=s?a.findViewByCell(s):null,u=s?null:Js.create(u).toJSON(),this.notify("edge:connected",{e:e,previousCell:n,previousPort:r,previousView:i,previousPoint:h,currentCell:s,currentView:a,currentPort:o,currentPoint:u,previousMagnet:t.initialMagnet,currentMagnet:t.currentMagnet,edge:this.cell,view:this,type:l,isNew:t.isNewEdge}))}highlightAvailableMagnets(t){var e=this.graph,n=e.model.getCells();t.marked={};for(let s=0,o=n.length;s<o;s+=1){const o=e.findViewByCell(n[s]);if(o&&o.cell.id!==this.cell.id){var r=Array.prototype.slice.call(o.container.querySelectorAll("[magnet]")),i=("false"!==o.container.getAttribute("magnet")&&r.push(o.container),r.filter((e=>this.validateConnection(...t.getValidateConnectionArgs(o,e),o.getEdgeTerminal(e,t.x,t.y,this.cell,t.terminalType)))));if(0<i.length){for(let t=0,e=i.length;t<e;t+=1)o.highlight(i[t],{type:"magnetAvailable"});o.highlight(null,{type:"nodeAvailable"}),t.marked[o.cell.id]=i}}}}unhighlightAvailableMagnets(t){const e=t.marked||{};Object.keys(e).forEach((t=>{const n=this.graph.findViewByCell(t);n&&(e[t].forEach((t=>{n.unhighlight(t,{type:"magnetAvailable"})})),n.unhighlight(null,{type:"nodeAvailable"}))})),t.marked=null}startArrowheadDragging(t,e,n){var r;this.can("arrowheadMovable")?(r=t.target.getAttribute("data-terminal"),r=this.prepareArrowheadDragging(r,{x:e,y:n}),this.setEventData(t,r)):this.notifyUnhandledMouseDown(t,e,n)}dragArrowhead(t,e,n){var r=this.getEventData(t);this.graph.options.connecting.snap?this.snapArrowhead(e,n,r):this.arrowheadDragging(this.getEventTarget(t),e,n,r)}stopArrowheadDragging(t,e,n){var r=this.graph,i=this.getEventData(t);r.options.connecting.snap?this.snapArrowheadEnd(i):this.arrowheadDragged(i,e,n),r=this.validateEdge(this.cell,i.terminalType,i.initialTerminal);r?(this.finishEmbedding(i),this.notifyConnectionEvent(i,t)):this.fallbackConnection(i),this.afterArrowheadDragging(i)}startLabelDragging(t,e,n){var r,i,s,o;this.can("edgeLabelMovable")?(r=t.currentTarget,r=parseInt(r.getAttribute("data-index"),10),i=this.getLabelPositionAngle(r),o=this.getLabelPositionArgs(r),s=this.getDefaultLabelPositionArgs(),o=this.mergeLabelPositionArgs(o,s),this.setEventData(t,{index:r,positionAngle:i,positionArgs:o,stopPropagation:!0,action:"drag-label"})):this.setEventData(t,{stopPropagation:!0}),this.graph.view.delegateDragEvents(t,this)}dragLabel(t,e,n){t=this.getEventData(t);var r=this.cell.getLabelAt(t.index);r=D.Z({},r,{position:this.getLabelPosition(e,n,t.positionAngle,t.positionArgs)});this.cell.setLabelAt(t.index,r)}stopLabelDragging(t,e,n){}}(cg=dg=dg||{}).toStringTag="X6."+cg.name,cg.isEdgeView=function(t){var e;return null!=t&&(t instanceof cg||(null==(e=t[Symbol.toStringTag])||e===cg.toStringTag)&&"function"==typeof t.isNodeView&&"function"==typeof t.isEdgeView&&"function"==typeof t.confirmUpdate&&"function"==typeof t.update&&"function"==typeof t.getConnection)},dg.config({isSvgElement:!0,priority:1,bootstrap:["render","source","target"],actions:{view:["render"],markup:["render"],attrs:["update"],source:["source","update"],target:["target","update"],router:["update"],connector:["update"],labels:["labels"],defaultLabel:["labels"],tools:["tools"],vertices:["vertices","update"]}}),dg.registry.register("edge",dg,!0);class pg extends xh{get disposeContainer(){return!1}get options(){return this.graph.options}constructor(t){super(),this.graph=t;var{selectors:t,fragment:e}=Xl.parseJSONMarkup(pg.markup);this.background=t.background,this.grid=t.grid,this.svg=t.svg,this.defs=t.defs,this.viewport=t.viewport,this.primer=t.primer,this.stage=t.stage,this.decorator=t.decorator,this.overlay=t.overlay,this.container=this.options.container,this.restore=pg.snapshoot(this.container),Tn(this.container,this.prefixClassName("graph")),_n(this.container,e),this.delegateEvents()}delegateEvents(){var t=this.constructor;return super.delegateEvents(t.events),this}guard(t,e){return"mousedown"===t.type&&2===t.button||!(!this.options.guard||!this.options.guard(t,e))||(t.data&&void 0!==t.data.guarded?t.data.guarded:!(e&&e.cell&&Dc.isCell(e.cell)||this.svg===t.target||this.container===t.target||this.svg.contains(t.target)))}findView(t){return this.graph.findViewByElem(t)}onDblClick(t){this.options.preventDefaultDblClick&&t.preventDefault();t=this.normalizeEvent(t);var e,n=this.findView(t.target);this.guard(t,n)||(e=this.graph.snapToGrid(t.clientX,t.clientY),n?n.onDblClick(t,e.x,e.y):this.graph.trigger("blank:dblclick",{e:t,x:e.x,y:e.y}))}onClick(t){var e,n;this.getMouseMovedCount(t)<=this.options.clickThreshold&&(t=this.normalizeEvent(t),e=this.findView(t.target),this.guard(t,e)||(n=this.graph.snapToGrid(t.clientX,t.clientY),e?e.onClick(t,n.x,n.y):this.graph.trigger("blank:click",{e:t,x:n.x,y:n.y})))}isPreventDefaultContextMenu(t){let e=this.options.preventDefaultContextMenu;return"function"==typeof e?M(e,this.graph,{view:t}):e}onContextMenu(t){var e=this.normalizeEvent(t),n=this.findView(e.target);this.isPreventDefaultContextMenu(n)&&t.preventDefault(),this.guard(e,n)||(t=this.graph.snapToGrid(e.clientX,e.clientY),n?n.onContextMenu(e,t.x,t.y):this.graph.trigger("blank:contextmenu",{e:e,x:t.x,y:t.y}))}delegateDragEvents(t,e){null==t.data&&(t.data={}),this.setEventData(t,{currentView:e||null,mouseMovedCount:0,startPosition:{x:t.clientX,y:t.clientY}}),e=this.constructor,this.delegateDocumentEvents(e.documentEvents,t.data),this.undelegateEvents()}getMouseMovedCount(t){return this.getEventData(t).mouseMovedCount||0}onMouseDown(t){var e,n=this.normalizeEvent(t),r=this.findView(n.target);this.guard(n,r)||(this.options.preventDefaultMouseDown&&t.preventDefault(),e=this.graph.snapToGrid(n.clientX,n.clientY),r?r.onMouseDown(n,e.x,e.y):(this.options.preventDefaultBlankAction&&["touchstart"].includes(n.type)&&t.preventDefault(),this.graph.trigger("blank:mousedown",{e:n,x:e.x,y:e.y})),this.delegateDragEvents(n,r))}onMouseMove(t){var e,n=this.getEventData(t),r=n.startPosition;r&&r.x===t.clientX&&r.y===t.clientY||(null==n.mouseMovedCount&&(n.mouseMovedCount=0),n.mouseMovedCount+=1,n.mouseMovedCount<=this.options.moveThreshold)||(r=this.normalizeEvent(t),t=this.graph.snapToGrid(r.clientX,r.clientY),(e=n.currentView)?e.onMouseMove(r,t.x,t.y):this.graph.trigger("blank:mousemove",{e:r,x:t.x,y:t.y}),this.setEventData(r,n))}onMouseUp(t){this.undelegateDocumentEvents();var e=this.normalizeEvent(t),n=this.graph.snapToGrid(e.clientX,e.clientY),r=this.getEventData(t).currentView;r?r.onMouseUp(e,n.x,n.y):this.graph.trigger("blank:mouseup",{e:e,x:n.x,y:n.y}),t.isPropagationStopped()||(r=new Fi(t,{type:"click",data:t.data}),this.onClick(r)),t.stopImmediatePropagation(),this.delegateEvents()}onMouseOver(t){t=this.normalizeEvent(t);var e=this.findView(t.target);this.guard(t,e)||(e?e.onMouseOver(t):this.container!==t.target&&this.graph.trigger("blank:mouseover",{e:t}))}onMouseOut(t){t=this.normalizeEvent(t);var e=this.findView(t.target);this.guard(t,e)||(e?e.onMouseOut(t):this.container!==t.target&&this.graph.trigger("blank:mouseout",{e:t}))}onMouseEnter(t){t=this.normalizeEvent(t);var e,n=this.findView(t.target);this.guard(t,n)||(e=this.graph.findViewByElem(t.relatedTarget),n?e!==n&&n.onMouseEnter(t):e||this.graph.trigger("graph:mouseenter",{e:t}))}onMouseLeave(t){t=this.normalizeEvent(t);var e,n=this.findView(t.target);this.guard(t,n)||(e=this.graph.findViewByElem(t.relatedTarget),n?e!==n&&n.onMouseLeave(t):e||this.graph.trigger("graph:mouseleave",{e:t}))}onMouseWheel(t){t=this.normalizeEvent(t);var e,n,r=this.findView(t.target);this.guard(t,r)||(n=t.originalEvent,e=this.graph.snapToGrid(n.clientX,n.clientY),n=Math.max(-1,Math.min(1,n.wheelDelta||-n.detail)),r?r.onMouseWheel(t,e.x,e.y,n):this.graph.trigger("blank:mousewheel",{e:t,delta:n,x:e.x,y:e.y}))}onCustomEvent(t){var e,n=t.currentTarget,r=n.getAttribute("event")||n.getAttribute("data-event");r&&(n=this.findView(n))&&(t=this.normalizeEvent(t),this.guard(t,n)||(e=this.graph.snapToGrid(t.clientX,t.clientY),n.onCustomEvent(t,r,e.x,e.y)))}handleMagnetEvent(t,e){var n,r=t.currentTarget,i=r.getAttribute("magnet");i&&"false"!==i.toLowerCase()&&(i=this.findView(r))&&(t=this.normalizeEvent(t),this.guard(t,i)||(n=this.graph.snapToGrid(t.clientX,t.clientY),M(e,this.graph,i,t,r,n.x,n.y)))}onMagnetMouseDown(t){this.handleMagnetEvent(t,((t,e,n,r,i)=>{t.onMagnetMouseDown(e,n,r,i)}))}onMagnetDblClick(t){this.handleMagnetEvent(t,((t,e,n,r,i)=>{t.onMagnetDblClick(e,n,r,i)}))}onMagnetContextMenu(t){var e=this.findView(t.target);this.isPreventDefaultContextMenu(e)&&t.preventDefault(),this.handleMagnetEvent(t,((t,e,n,r,i)=>{t.onMagnetContextMenu(e,n,r,i)}))}onLabelMouseDown(t){var e,n=t.currentTarget;n=this.findView(n);n&&(t=this.normalizeEvent(t),this.guard(t,n)||(e=this.graph.snapToGrid(t.clientX,t.clientY),n.onLabelMouseDown(t,e.x,e.y)))}onImageDragStart(){return!1}dispose(){this.undelegateEvents(),this.undelegateDocumentEvents(),this.restore(),this.restore=()=>{}}}(function(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(o=(s<3?i(o):3<s?i(e,n,o):i(e,n))||o);3<s&&o&&Object.defineProperty(e,n,o)})([xh.dispose()],pg.prototype,"dispose",null),fe=pg=pg||{},p=Ml.prefixCls+"-graph",fe.markup=[{ns:Dn.xhtml,tagName:"div",selector:"background",className:p+"-background"},{ns:Dn.xhtml,tagName:"div",selector:"grid",className:p+"-grid"},{ns:Dn.svg,tagName:"svg",selector:"svg",className:p+"-svg",attrs:{width:"100%",height:"100%","xmlns:xlink":Dn.xlink},children:[{tagName:"defs",selector:"defs"},{tagName:"g",selector:"viewport",className:p+"-svg-viewport",children:[{tagName:"g",selector:"primer",className:p+"-svg-primer"},{tagName:"g",selector:"stage",className:p+"-svg-stage"},{tagName:"g",selector:"decorator",className:p+"-svg-decorator"},{tagName:"g",selector:"overlay",className:p+"-svg-overlay"}]}]}],fe.snapshoot=function(t){const e=t.cloneNode();return t.childNodes.forEach((t=>e.appendChild(t))),()=>{for(Yn(t);0<t.attributes.length;)t.removeAttribute(t.attributes[0].name);for(let r=0,i=e.attributes.length;r<i;r+=1){var n=e.attributes[r];t.setAttribute(n.name,n.value)}e.childNodes.forEach((e=>t.appendChild(e)))}},Pe=pg=pg||{},Ae=Ml.prefixCls,Pe.events={dblclick:"onDblClick",contextmenu:"onContextMenu",touchstart:"onMouseDown",mousedown:"onMouseDown",mouseover:"onMouseOver",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousewheel:"onMouseWheel",DOMMouseScroll:"onMouseWheel",[`mouseenter  .${Ae}-cell`]:"onMouseEnter",[`mouseleave  .${Ae}-cell`]:"onMouseLeave",[`mouseenter  .${Ae}-cell-tools`]:"onMouseEnter",[`mouseleave  .${Ae}-cell-tools`]:"onMouseLeave",[`mousedown   .${Ae}-cell [event]`]:"onCustomEvent",[`touchstart  .${Ae}-cell [event]`]:"onCustomEvent",[`mousedown   .${Ae}-cell [data-event]`]:"onCustomEvent",[`touchstart  .${Ae}-cell [data-event]`]:"onCustomEvent",[`dblclick    .${Ae}-cell [magnet]`]:"onMagnetDblClick",[`contextmenu .${Ae}-cell [magnet]`]:"onMagnetContextMenu",[`mousedown   .${Ae}-cell [magnet]`]:"onMagnetMouseDown",[`touchstart  .${Ae}-cell [magnet]`]:"onMagnetMouseDown",[`dblclick    .${Ae}-cell [data-magnet]`]:"onMagnetDblClick",[`contextmenu .${Ae}-cell [data-magnet]`]:"onMagnetContextMenu",[`mousedown   .${Ae}-cell [data-magnet]`]:"onMagnetMouseDown",[`touchstart  .${Ae}-cell [data-magnet]`]:"onMagnetMouseDown",[`dragstart   .${Ae}-cell image`]:"onImageDragStart",[`mousedown   .${Ae}-edge .${Ae}-edge-label`]:"onLabelMouseDown",[`touchstart  .${Ae}-edge .${Ae}-edge-label`]:"onLabelMouseDown"},Pe.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"};class fg extends w{get options(){return this.graph.options}get model(){return this.graph.model}get view(){return this.graph.view}constructor(t){super(),this.graph=t,this.init()}init(){}}class mg extends fg{init(){Ml.autoInsertCSS&&Hs("core",".x6-graph {\n  position: relative;\n  overflow: hidden;\n  outline: none;\n  touch-action: none;\n}\n.x6-graph-background,\n.x6-graph-grid,\n.x6-graph-svg {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}\n.x6-graph-background-stage,\n.x6-graph-grid-stage,\n.x6-graph-svg-stage {\n  user-select: none;\n}\n.x6-graph.x6-graph-pannable {\n  cursor: grab;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n}\n.x6-graph.x6-graph-panning {\n  cursor: grabbing;\n  cursor: -moz-grabbing;\n  cursor: -webkit-grabbing;\n  user-select: none;\n}\n.x6-node {\n  cursor: move;\n  /* stylelint-disable-next-line */\n}\n.x6-node.x6-node-immovable {\n  cursor: default;\n}\n.x6-node * {\n  -webkit-user-drag: none;\n}\n.x6-node .scalable * {\n  vector-effect: non-scaling-stroke;\n}\n.x6-node [magnet='true'] {\n  cursor: crosshair;\n  transition: opacity 0.3s;\n}\n.x6-node [magnet='true']:hover {\n  opacity: 0.7;\n}\n.x6-node foreignObject {\n  display: block;\n  overflow: visible;\n  background-color: transparent;\n}\n.x6-node foreignObject > body {\n  position: static;\n  width: 100%;\n  height: 100%;\n  margin: 0;\n  padding: 0;\n  overflow: visible;\n  background-color: transparent;\n}\n.x6-edge .source-marker,\n.x6-edge .target-marker {\n  vector-effect: non-scaling-stroke;\n}\n.x6-edge .connection {\n  stroke-linejoin: round;\n  fill: none;\n}\n.x6-edge .connection-wrap {\n  cursor: move;\n  opacity: 0;\n  fill: none;\n  stroke: #000;\n  stroke-width: 15;\n  stroke-linecap: round;\n  stroke-linejoin: round;\n}\n.x6-edge .connection-wrap:hover {\n  opacity: 0.4;\n  stroke-opacity: 0.4;\n}\n.x6-edge .vertices {\n  cursor: move;\n  opacity: 0;\n}\n.x6-edge .vertices .vertex {\n  fill: #1abc9c;\n}\n.x6-edge .vertices .vertex :hover {\n  fill: #34495e;\n  stroke: none;\n}\n.x6-edge .vertices .vertex-remove {\n  cursor: pointer;\n  fill: #fff;\n}\n.x6-edge .vertices .vertex-remove-area {\n  cursor: pointer;\n  opacity: 0.1;\n}\n.x6-edge .vertices .vertex-group:hover .vertex-remove-area {\n  opacity: 1;\n}\n.x6-edge .arrowheads {\n  cursor: move;\n  opacity: 0;\n}\n.x6-edge .arrowheads .arrowhead {\n  fill: #1abc9c;\n}\n.x6-edge .arrowheads .arrowhead :hover {\n  fill: #f39c12;\n  stroke: none;\n}\n.x6-edge .tools {\n  cursor: pointer;\n  opacity: 0;\n}\n.x6-edge .tools .tool-options {\n  display: none;\n}\n.x6-edge .tools .tool-remove circle {\n  fill: #f00;\n}\n.x6-edge .tools .tool-remove path {\n  fill: #fff;\n}\n.x6-edge:hover .vertices,\n.x6-edge:hover .arrowheads,\n.x6-edge:hover .tools {\n  opacity: 1;\n}\n.x6-highlight-opacity {\n  opacity: 0.3;\n}\n.x6-cell-tool-editor {\n  position: relative;\n  display: inline-block;\n  min-height: 1em;\n  margin: 0;\n  padding: 0;\n  line-height: 1;\n  white-space: normal;\n  text-align: center;\n  vertical-align: top;\n  overflow-wrap: normal;\n  outline: none;\n  transform-origin: 0 0;\n  -webkit-user-drag: none;\n}\n.x6-edge-tool-editor {\n  border: 1px solid #275fc5;\n  border-radius: 2px;\n}\n")}dispose(){Zs("core")}}(function(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(o=(s<3?i(o):3<s?i(e,n,o):i(e,n))||o);3<s&&o&&Object.defineProperty(e,n,o)})([mg.dispose()],mg.prototype,"dispose",null);var vg,yg,bg=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};(yg=vg=vg||{}).get=function(t){var e=t["grid"],n=bg(t,["grid","panning","mousewheel","embedding"]),r=t.container;if(null==r)throw new Error("Ensure the container of the graph is specified and valid");null==n.width&&(n.width=r.clientWidth),null==n.height&&(n.height=r.clientHeight);const i=D.Z({},yg.defaults,n);return r={size:10,visible:!1},i.grid="number"==typeof e?{size:e,visible:!1}:"boolean"==typeof e?Object.assign(Object.assign({},r),{visible:e}):Object.assign(Object.assign({},r),e),["panning","mousewheel","embedding"].forEach((e=>{var n=t[e];"boolean"==typeof n?i[e].enabled=n:i[e]=Object.assign(Object.assign({},i[e]),n)})),i},(vg||(vg={})).defaults={x:0,y:0,scaling:{min:.01,max:16},grid:{size:10,visible:!1},background:!1,panning:{enabled:!1,eventTypes:["leftMouseDown"]},mousewheel:{enabled:!1,factor:1.2,zoomAtMousePosition:!0},highlighting:{default:{name:"stroke",args:{padding:3}},nodeAvailable:{name:"className",args:{className:Ml.prefix("available-node")}},magnetAvailable:{name:"className",args:{className:Ml.prefix("available-magnet")}}},connecting:{snap:!1,allowLoop:!0,allowNode:!0,allowEdge:!1,allowPort:!0,allowBlank:!0,allowMulti:!0,highlight:!1,anchor:"center",edgeAnchor:"ratio",connectionPoint:"boundary",router:"normal",connector:"normal",validateConnection({type:t,sourceView:e,targetView:n}){return null!=("target"===t?n:e)},createEdge(){return new ng}},translating:{restrict:!1},embedding:{enabled:!1,findParent:"bbox",frontOnly:!0,validate:()=>!0},moveThreshold:0,clickThreshold:0,magnetThreshold:0,preventDefaultDblClick:!0,preventDefaultMouseDown:!1,preventDefaultContextMenu:!0,preventDefaultBlankAction:!0,interacting:{edgeLabelMovable:!1},async:!0,virtual:!1,guard:()=>!1};var xg,wg=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};class Cg extends fg{get elem(){return this.view.grid}get grid(){return this.options.grid}init(){this.startListening(),this.draw(this.grid)}startListening(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}stopListening(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}setVisible(t){this.grid.visible!==t&&(this.grid.visible=t,this.update())}getGridSize(){return this.grid.size}setGridSize(t){this.grid.size=Math.max(t,1),this.update()}show(){this.setVisible(!0),this.update()}hide(){this.setVisible(!1),this.update()}clear(){this.elem.style.backgroundImage=""}draw(t){this.clear(),this.instance=null,Object.assign(this.grid,t),this.patterns=this.resolveGrid(t),this.update()}update(t={}){const e=this.grid.size;if(e<=1||!this.grid.visible)return this.clear();const n=this.graph.matrix(),r=this.getInstance(),i=Array.isArray(t)?t:[t];this.patterns.forEach(((t,s)=>{var o="pattern_"+s,a=n.a||1,l=n.d||1,{update:h,markup:u}=t;t=wg(t,["update","markup"]),t=Object.assign(Object.assign(Object.assign({},t),i[s]),{sx:a,sy:l,ox:n.e||0,oy:n.f||0,width:e*a,height:e*l}),r.has(o)||r.add(o,Wr.create("pattern",{id:o,patternUnits:"userSpaceOnUse"},Wr.createVectors(u)).node),s=r.get(o);"function"==typeof h&&h(s.childNodes[0],t);let c=t.ox%t.width,g=(c<0&&(c+=t.width),t.oy%t.height);g<0&&(g+=t.height),ur(s,{x:c,y:g,width:t.width,height:t.height})})),t=(new XMLSerializer).serializeToString(r.root),t=`url(data:image/svg+xml;base64,${btoa(t)})`,this.elem.style.backgroundImage=t}getInstance(){return this.instance||(this.instance=new No),this.instance}resolveGrid(t){if(!t)return[];var e=t.type;if(null==e)return[Object.assign(Object.assign({},No.presets.dot),t.args)];var n=No.registry.get(e);if(n){let e=t.args||[];return Array.isArray(e)||(e=[e]),Array.isArray(n)?n.map(((t,n)=>Object.assign(Object.assign({},t),e[n]))):[Object.assign(Object.assign({},n),e[0])]}return No.registry.onNotFound(e)}dispose(){this.stopListening(),this.clear()}}(function(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(o=(s<3?i(o):3<s?i(e,n,o):i(e,n))||o);3<s&&o&&Object.defineProperty(e,n,o)})([fg.dispose()],Cg.prototype,"dispose",null);class Pg extends fg{get container(){return this.graph.view.container}get viewport(){return this.graph.view.viewport}get stage(){return this.graph.view.stage}init(){this.resize()}getMatrix(){var t=this.viewport.getAttribute("transform");return t!==this.viewportTransformString&&(this.viewportMatrix=this.viewport.getCTM(),this.viewportTransformString=t),Pi(this.viewportMatrix)}setMatrix(t){t=Pi(t);var e=Mi(t);this.viewport.setAttribute("transform",e),this.viewportMatrix=t,this.viewportTransformString=e}resize(t,e){let n=void 0===t?this.options.width:t,r=void 0===e?this.options.height:e;return this.options.width=n,this.options.height=r,"number"==typeof n&&(n=Math.round(n)),"number"==typeof r&&(r=Math.round(r)),this.container.style.width=null==n?"":n+"px",this.container.style.height=null==r?"":r+"px",t=this.getComputedSize(),this.graph.trigger("resize",Object.assign({},t)),this}getComputedSize(){let t=this.options.width,e=this.options.height;return Ke(t)||(t=this.container.clientWidth),Ke(e)||(e=this.container.clientHeight),{width:t,height:e}}getScale(){return Ni(this.getMatrix())}scale(t,e=t,n=0,r=0){t=this.clampScale(t),e=this.clampScale(e),(n||r)&&(i=(o=this.getTranslation()).tx-n*(t-1),s=o.ty-r*(e-1),i===o.tx&&s===o.ty||this.translate(i,s));var i,s,o=this.getMatrix();return o.a=t,o.d=e,this.setMatrix(o),this.graph.trigger("scale",{sx:t,sy:e,ox:n,oy:r}),this}clampScale(t){var e=this.graph.options.scaling;return en(t,e.min||.01,e.max||16)}getZoom(){return this.getScale().sx}zoom(t,e){e=e||{};let n=t,r=t;t=this.getScale();var i=this.getComputedSize();let s=i.width/2,o=i.height/2;return e.absolute||(n+=t.sx,r+=t.sy),e.scaleGrid&&(n=Math.round(n/e.scaleGrid)*e.scaleGrid,r=Math.round(r/e.scaleGrid)*e.scaleGrid),e.maxScale&&(n=Math.min(e.maxScale,n),r=Math.min(e.maxScale,r)),e.minScale&&(n=Math.max(e.minScale,n),r=Math.max(e.minScale,r)),e.center&&(s=e.center.x,o=e.center.y),n=this.clampScale(n),r=this.clampScale(r),(s||o)&&(i=this.getTranslation(),e=s-(s-i.tx)*(n/t.sx),t=o-(o-i.ty)*(r/t.sy),e===i.tx&&t===i.ty||this.translate(e,t)),this.scale(n,r),this}getRotation(){return ki(this.getMatrix())}rotate(t,e,n){null!=e&&null!=n||(e=(r=fl.getBBox(this.stage)).width/2,n=r.height/2);var r=this.getMatrix().translate(e,n).rotate(t).translate(-e,-n);return this.setMatrix(r),this}getTranslation(){return ji(this.getMatrix())}translate(t,e){var n=this.getMatrix();n.e=t||0,n.f=e||0,this.setMatrix(n),t=this.getTranslation();return this.options.x=t.tx,this.options.y=t.ty,this.graph.trigger("translate",Object.assign({},t)),this}setOrigin(t,e){return this.translate(t||0,e||0)}fitToContent(t,e,n,r){"object"==typeof t?(t=(i=t).gridWidth||1,e=i.gridHeight||1,n=i.padding||0,r=i):(t=t||1,e=e||1,n=n||0,null==r&&(r={}));var i=sn(n),s=(n=r.border||0,r.contentArea?_s.create(r.contentArea):this.getContentArea(r)),o=(n=(0<n&&s.inflate(n),this.getScale()),this.getTranslation()),a=n.sx;n=n.sy;s.x*=a,s.y*=n,s.width*=a,s.height*=n;let l=Math.max(Math.ceil((s.width+s.x)/t),1)*t,h=Math.max(Math.ceil((s.height+s.y)/e),1)*e,u=0,c=0;return("negative"===r.allowNewOrigin&&s.x<0||"positive"===r.allowNewOrigin&&0<=s.x||"any"===r.allowNewOrigin)&&(u=Math.ceil(-s.x/t)*t,u+=i.left,l+=u),("negative"===r.allowNewOrigin&&s.y<0||"positive"===r.allowNewOrigin&&0<=s.y||"any"===r.allowNewOrigin)&&(c=Math.ceil(-s.y/e)*e,c+=i.top,h+=c),l+=i.right,h+=i.bottom,l=Math.max(l,r.minWidth||0),h=Math.max(h,r.minHeight||0),l=Math.min(l,r.maxWidth||Number.MAX_SAFE_INTEGER),h=Math.min(h,r.maxHeight||Number.MAX_SAFE_INTEGER),t=this.getComputedSize(),s=l!==t.width||h!==t.height,(u!==o.tx||c!==o.ty)&&this.translate(u,c),s&&this.resize(l,h),new _s(-u/a,-c/n,l/a,h/n)}scaleContentToFit(t={}){this.scaleContentToFitImpl(t)}scaleContentToFitImpl(t={},e=!0){let n,r;if(r=t.contentArea?(i=t.contentArea,n=this.graph.localToGraph(i),Js.create(i)):(n=this.getContentBBox(t),this.graph.graphToLocal(n)),n.width&&n.height){var i=sn(t.padding),s=t.minScale||0,o=t.maxScale||Number.MAX_SAFE_INTEGER,a=t.minScaleX||s,l=t.maxScaleX||o;s=t.minScaleY||s,o=t.maxScaleY||o;let c;c=t.viewportArea||(u=this.getComputedSize(),{x:(h=this.getTranslation()).tx,y:h.ty,width:u.width,height:u.height}),c=_s.create(c).moveAndExpand({x:i.left,y:i.top,width:-i.left-i.right,height:-i.top-i.bottom});var h=this.getScale();let g=c.width/n.width*h.sx,d=c.height/n.height*h.sy;!1!==t.preserveAspectRatio&&(g=d=Math.min(g,d));var u=t.scaleGrid;u&&(g=u*Math.floor(g/u),d=u*Math.floor(d/u)),g=en(g,a,l),d=en(d,s,o),this.scale(g,d),e&&(i=this.options,h=c.x-r.x*g-i.x,t=c.y-r.y*d-i.y,this.translate(h,t))}}getContentArea(t={}){return!1!==t.useCellGeometry?this.model.getAllCellsBBox()||new _s:fl.getBBox(this.stage)}getContentBBox(t={}){return this.graph.localToGraph(this.getContentArea(t))}getGraphArea(){var t=_s.fromSize(this.getComputedSize());return this.graph.graphToLocal(t)}zoomToRect(t,e={}){t=_s.create(t);var n=this.graph;e.contentArea=t,null==e.viewportArea&&(e.viewportArea={x:n.options.x,y:n.options.y,width:this.options.width,height:this.options.height}),this.scaleContentToFitImpl(e,!1),n=t.getCenter();return this.centerPoint(n.x,n.y),this}zoomToFit(t={}){return this.zoomToRect(this.getContentArea(t),t)}centerPoint(t,e){var n=this.getComputedSize(),r=this.getScale(),i=this.getTranslation(),s=n.width/2;n=n.height/2;t=s-(t="number"==typeof t?t:s)*r.sx,e=n-(e="number"==typeof e?e:n)*r.sy,i.tx===t&&i.ty===e||this.translate(t,e)}centerContent(t){t=this.graph.getContentArea(t).getCenter(),this.centerPoint(t.x,t.y)}centerCell(t){return this.positionCell(t,"center")}positionPoint(t,e,n){var r=this.getComputedSize(),i=(r=((e=rn(e,Math.max(0,r.width)))<0&&(e=r.width+e),(n=rn(n,Math.max(0,r.height)))<0&&(n=r.height+n),this.getTranslation()),this.getScale());e-=t.x*i.sx,n-=t.y*i.sy;r.tx===e&&r.ty===n||this.translate(e,n)}positionRect(t,e){var n=_s.create(t);switch(e){case"center":return this.positionPoint(n.getCenter(),"50%","50%");case"top":return this.positionPoint(n.getTopCenter(),"50%",0);case"top-right":return this.positionPoint(n.getTopRight(),"100%",0);case"right":return this.positionPoint(n.getRightMiddle(),"100%","50%");case"bottom-right":return this.positionPoint(n.getBottomRight(),"100%","100%");case"bottom":return this.positionPoint(n.getBottomCenter(),"50%","100%");case"bottom-left":return this.positionPoint(n.getBottomLeft(),0,"100%");case"left":return this.positionPoint(n.getLeftMiddle(),0,"50%");case"top-left":return this.positionPoint(n.getTopLeft(),0,0);default:return this}}positionCell(t,e){return t=t.getBBox(),this.positionRect(t,e)}positionContent(t,e){return e=this.graph.getContentArea(e),this.positionRect(e,t)}}class Ag extends fg{get elem(){return this.view.background}init(){this.startListening(),this.options.background&&this.draw(this.options.background)}startListening(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}stopListening(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}updateBackgroundImage(t={}){let e=t.size||"auto auto",n=t.position||"center";t=this.graph.transform.getScale();var r,i=this.graph.translate();"object"==typeof n&&(r=i.tx+t.sx*(n.x||0),i=i.ty+t.sy*(n.y||0),n=r+`px ${i}px`),"object"==typeof e&&(e=`${(e=_s.fromSize(e).scale(t.sx,t.sy)).width}px ${e.height}px`),this.elem.style.backgroundSize=e,this.elem.style.backgroundPosition=n}drawBackgroundImage(t,e={}){if(t instanceof HTMLImageElement){var n=this.optionsCache;if(!n||n.image===e.image){let a;var r=e.opacity,i=e.size;let l=e.repeat||"no-repeat";var s=ys.registry.get(l);if("function"==typeof s){var o=e.quality||1;s=(t.width*=o,t.height*=o,s(t,e));if(!(s instanceof HTMLCanvasElement))throw new Error("Background pattern must return an HTML Canvas instance");a=s.toDataURL("image/png"),l=e.repeat&&l!==e.repeat?e.repeat:"repeat","object"==typeof i?(i.width*=s.width/t.width,i.height*=s.height/t.height):void 0===i&&(e.size={width:s.width/o,height:s.height/o})}else a=t.src,void 0===i&&(e.size={width:t.width,height:t.height});null!=n&&"object"==typeof e.size&&e.image===n.image&&e.repeat===n.repeat&&e.quality===n.quality&&(n.size=Y.Z(e.size)),s=this.elem.style,s.backgroundImage=`url(${a})`,s.backgroundRepeat=l,s.opacity=null==r||1<=r?"":""+r,this.updateBackgroundImage(e)}}else this.elem.style.backgroundImage=""}updateBackgroundColor(t){this.elem.style.backgroundColor=t||""}updateBackgroundOptions(t){this.graph.options.background=t}update(){this.optionsCache&&this.updateBackgroundImage(this.optionsCache)}draw(t){var e=t||{};if(this.updateBackgroundOptions(t),this.updateBackgroundColor(e.color),e.image){this.optionsCache=Y.Z(e);const n=document.createElement("img");n.onload=()=>this.drawBackgroundImage(n,t),n.setAttribute("crossorigin","anonymous"),n.src=e.image}else this.drawBackgroundImage(null),this.optionsCache=null}clear(){this.draw()}dispose(){this.clear(),this.stopListening()}}(function(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(o=(s<3?i(o):3<s?i(e,n,o):i(e,n))||o);3<s&&o&&Object.defineProperty(e,n,o)})([fg.dispose()],Ag.prototype,"dispose",null);class Eg extends fg{get widgetOptions(){return this.options.panning}get pannable(){return this.widgetOptions&&!0===this.widgetOptions.enabled}init(){this.onRightMouseDown=this.onRightMouseDown.bind(this),this.onSpaceKeyDown=this.onSpaceKeyDown.bind(this),this.onSpaceKeyUp=this.onSpaceKeyUp.bind(this),this.startListening(),this.updateClassName()}startListening(){this.graph.on("blank:mousedown",this.onMouseDown,this),this.graph.on("node:unhandled:mousedown",this.onMouseDown,this),this.graph.on("edge:unhandled:mousedown",this.onMouseDown,this),qi.on(this.graph.container,"mousedown",this.onRightMouseDown),qi.on(document.body,{keydown:this.onSpaceKeyDown,keyup:this.onSpaceKeyUp}),this.mousewheelHandle=new ws(this.graph.container,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.mousewheelHandle.enable()}stopListening(){this.graph.off("blank:mousedown",this.onMouseDown,this),this.graph.off("node:unhandled:mousedown",this.onMouseDown,this),this.graph.off("edge:unhandled:mousedown",this.onMouseDown,this),qi.off(this.graph.container,"mousedown",this.onRightMouseDown),qi.off(document.body,{keydown:this.onSpaceKeyDown,keyup:this.onSpaceKeyUp}),this.mousewheelHandle&&this.mousewheelHandle.disable()}allowPanning(t,e){return t.spaceKey=this.isSpaceKeyPressed,this.pannable&&Xi.isMatch(t,this.widgetOptions.modifiers,e)}startPanning(t){t=this.view.normalizeEvent(t),this.clientX=t.clientX,this.clientY=t.clientY,this.panning=!0,this.updateClassName(),qi.on(document.body,{"mousemove.panning touchmove.panning":this.pan.bind(this),"mouseup.panning touchend.panning":this.stopPanning.bind(this),"mouseleave.panning":this.stopPanning.bind(this)}),qi.on(window,"mouseup.panning",this.stopPanning.bind(this))}pan(t){t=this.view.normalizeEvent(t);var e=t.clientX-this.clientX,n=t.clientY-this.clientY;this.clientX=t.clientX,this.clientY=t.clientY,this.graph.translateBy(e,n)}stopPanning(t){this.panning=!1,this.updateClassName(),qi.off(document.body,".panning"),qi.off(window,".panning")}updateClassName(){var t=this.view.container,e=this.view.prefixClassName("graph-panning"),n=this.view.prefixClassName("graph-pannable");(this.pannable?this.panning?(Tn(t,e),Nn):(Nn(t,e),Tn):(Nn(t,e),Nn))(t,n)}onMouseDown({e:t}){var e;this.allowBlankMouseDown(t)&&(e=(e=this.graph.getPlugin("selection"))&&e.allowRubberband(t,!0),this.allowPanning(t,!0)||this.allowPanning(t)&&!e)&&this.startPanning(t)}onRightMouseDown(t){var e=this.widgetOptions.eventTypes;null!=e&&e.includes("rightMouseDown")&&2===t.button&&this.allowPanning(t,!0)&&this.startPanning(t)}onMouseWheel(t,e,n){this.graph.translateBy(-e,-n)}onSpaceKeyDown(t){32===t.which&&(this.isSpaceKeyPressed=!0)}onSpaceKeyUp(t){32===t.which&&(this.isSpaceKeyPressed=!1)}allowBlankMouseDown(t){var e=this.widgetOptions.eventTypes;return(null==e?void 0:e.includes("leftMouseDown"))&&0===t.button||(null==e?void 0:e.includes("mouseWheelDown"))&&1===t.button}allowMouseWheel(t){return this.pannable&&!t.ctrlKey&&(null==(t=this.widgetOptions.eventTypes)?void 0:t.includes("mouseWheel"))}autoPanning(t,e){var n=this.graph.getGraphArea();let r=0,i=0;t<=n.left+10&&(r=-10),e<=n.top+10&&(i=-10),t>=n.right-10&&(r=10),e>=n.bottom-10&&(i=10),0===r&&0===i||this.graph.translateBy(-r,-i)}enablePanning(){this.pannable||(this.widgetOptions.enabled=!0,this.updateClassName())}disablePanning(){this.pannable&&(this.widgetOptions.enabled=!1,this.updateClassName())}dispose(){this.stopListening()}}(function(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(o=(s<3?i(o):3<s?i(e,n,o):i(e,n))||o);3<s&&o&&Object.defineProperty(e,n,o)})([fg.dispose()],Eg.prototype,"dispose",null);class Mg extends fg{constructor(){super(...arguments),this.cumulatedFactor=1}get widgetOptions(){return this.options.mousewheel}init(){this.container=this.graph.container,this.target=this.widgetOptions.global?document:this.container,this.mousewheelHandle=new ws(this.target,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.widgetOptions.enabled&&this.enable(!0)}get disabled(){return!0!==this.widgetOptions.enabled}enable(t){(this.disabled||t)&&(this.widgetOptions.enabled=!0,this.mousewheelHandle.enable())}disable(){this.disabled||(this.widgetOptions.enabled=!1,this.mousewheelHandle.disable())}allowMouseWheel(t){var e=this.widgetOptions.guard;return(null==e||e(t))&&Xi.isMatch(t,this.widgetOptions.modifiers)}onMouseWheel(t){var e,n,r=this.widgetOptions.guard;(null==r||r(t))&&Xi.isMatch(t,this.widgetOptions.modifiers)&&(r=this.widgetOptions.factor||1.2,null==this.currentScale&&(this.startPos={x:t.clientX,y:t.clientY},this.currentScale=this.graph.transform.getScale().sx),t.deltaY<0?this.currentScale<.15?this.cumulatedFactor=(this.currentScale+.01)/this.currentScale:(this.cumulatedFactor=Math.round(this.currentScale*r*20)/20/this.currentScale,1===this.cumulatedFactor&&(this.cumulatedFactor=1.05)):this.currentScale<=.15?this.cumulatedFactor=(this.currentScale-.01)/this.currentScale:(this.cumulatedFactor=Math.round(this.currentScale*(1/r)*20)/20/this.currentScale,1===this.cumulatedFactor&&(this.cumulatedFactor=.95)),this.cumulatedFactor=Math.max(.01,Math.min(this.currentScale*this.cumulatedFactor,160)/this.currentScale),t=this.currentScale,r=this.graph.transform.clampScale(t*this.cumulatedFactor),n=this.widgetOptions.minScale||Number.MIN_SAFE_INTEGER,e=this.widgetOptions.maxScale||Number.MAX_SAFE_INTEGER,(r=en(r,n,e))!==t&&(this.widgetOptions.zoomAtMousePosition?(n=this.graph.getPlugin("scroller")?this.graph.clientToLocal(this.startPos):this.graph.clientToGraph(this.startPos),this.graph.zoom(r,{absolute:!0,center:n.clone()})):this.graph.zoom(r,{absolute:!0})),this.currentScale=null,this.cumulatedFactor=1)}dispose(){this.disable()}}(function(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(o=(s<3?i(o):3<s?i(e,n,o):i(e,n))||o);3<s&&o&&Object.defineProperty(e,n,o)})([w.dispose()],Mg.prototype,"dispose",null);class Sg extends fg{init(){this.resetRenderArea=A.Z(this.resetRenderArea,200,{leading:!0}),this.resetRenderArea(),this.startListening()}startListening(){this.graph.on("translate",this.resetRenderArea,this),this.graph.on("scale",this.resetRenderArea,this),this.graph.on("resize",this.resetRenderArea,this)}stopListening(){this.graph.off("translate",this.resetRenderArea,this),this.graph.off("scale",this.resetRenderArea,this),this.graph.off("resize",this.resetRenderArea,this)}enableVirtualRender(){this.options.virtual=!0,this.resetRenderArea()}disableVirtualRender(){this.options.virtual=!1,this.graph.renderer.setRenderArea(void 0)}resetRenderArea(){var t;this.options.virtual&&(t=this.graph.getGraphArea(),this.graph.renderer.setRenderArea(t))}dispose(){this.stopListening()}}(function(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(o=(s<3?i(o):3<s?i(e,n,o):i(e,n))||o);3<s&&o&&Object.defineProperty(e,n,o)})([fg.dispose()],Sg.prototype,"dispose",null);class Og{constructor(){this.isFlushing=!1,this.isFlushPending=!1,this.scheduleId=0,this.queue=[],this.frameInterval=33,this.initialTime=Date.now()}queueJob(t){var e;t.priority&xg.PRIOR?t.cb():0<=(e=this.findInsertionIndex(t))&&this.queue.splice(e,0,t)}queueFlush(){this.isFlushing||this.isFlushPending||(this.isFlushPending=!0,this.scheduleJob())}queueFlushSync(){this.isFlushing||this.isFlushPending||(this.isFlushPending=!0,this.flushJobsSync())}clearJobs(){this.queue.length=0,this.isFlushing=!1,this.isFlushPending=!1,this.cancelScheduleJob()}flushJobs(){this.isFlushPending=!1,this.isFlushing=!0;for(var t,e=this.getCurrentTime();(t=this.queue.shift())&&(t.cb(),!(this.getCurrentTime()-e>=this.frameInterval)););this.isFlushing=!1,this.queue.length&&this.queueFlush()}flushJobsSync(){var t;for(this.isFlushPending=!1,this.isFlushing=!0;t=this.queue.shift();)try{t.cb()}catch(t){}this.isFlushing=!1}findInsertionIndex(t){let e=0,n=this.queue.length,r=n-1;for(var i=t.priority;e<=r;){var s=(r-e>>1)+e;i<=this.queue[s].priority?e=s+1:(n=s,r=s-1)}return n}scheduleJob(){"requestIdleCallback"in window?(this.scheduleId&&this.cancelScheduleJob(),this.scheduleId=window.requestIdleCallback(this.flushJobs.bind(this),{timeout:100})):(this.scheduleId&&this.cancelScheduleJob(),this.scheduleId=window.setTimeout(this.flushJobs.bind(this)))}cancelScheduleJob(){"cancelIdleCallback"in window?this.scheduleId&&window.cancelIdleCallback(this.scheduleId):this.scheduleId&&clearTimeout(this.scheduleId),this.scheduleId=0}getCurrentTime(){return"object"==typeof performance&&"function"==typeof performance.now?performance.now():Date.now()-this.initialTime}}(u=xg=xg||{})[u.Update=2]="Update",u[u.RenderEdge=4]="RenderEdge",u[u.RenderNode=8]="RenderNode",u[u.PRIOR=1048576]="PRIOR";class Tg extends w{get model(){return this.graph.model}get container(){return this.graph.view.stage}constructor(t){super(),this.views={},this.willRemoveViews={},this.queue=new Og,this.graph=t,this.init()}init(){this.startListening(),this.renderViews(this.model.getCells())}startListening(){this.model.on("reseted",this.onModelReseted,this),this.model.on("cell:added",this.onCellAdded,this),this.model.on("cell:removed",this.onCellRemoved,this),this.model.on("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.on("cell:change:visible",this.onCellVisibleChanged,this)}stopListening(){this.model.off("reseted",this.onModelReseted,this),this.model.off("cell:added",this.onCellAdded,this),this.model.off("cell:removed",this.onCellRemoved,this),this.model.off("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.off("cell:change:visible",this.onCellVisibleChanged,this)}onModelReseted({options:t}){this.queue.clearJobs(),this.removeZPivots(),this.resetViews();var e=this.model.getCells();this.renderViews(e,Object.assign(Object.assign({},t),{queue:e.map((t=>t.id))}))}onCellAdded({cell:t,options:e}){this.renderViews([t],e)}onCellRemoved({cell:t}){this.removeViews([t])}onCellZIndexChanged({cell:t,options:e}){t=this.views[t.id],t&&this.requestViewUpdate(t.view,Tg.FLAG_INSERT,e,xg.Update,!0)}onCellVisibleChanged({cell:t,current:e}){this.toggleVisible(t,!!e)}requestViewUpdate(t,e,n={},r=xg.Update,i=!0){var s=t.cell.id,o=this.views[s];o&&(o.flag=e,o.options=n,!t.hasAction(e,["translate","resize","rotate"])&&!1!==n.async||(r=xg.PRIOR,i=!1),this.queue.queueJob({id:s,priority:r,cb:()=>{this.renderViewInArea(t,e,n);var r,i=n.queue;i&&(0<=(r=i.indexOf(t.cell.id))&&i.splice(r,1),0===i.length)&&this.graph.trigger("render:done")}}),this.getEffectedEdges(t).forEach((t=>{this.requestViewUpdate(t.view,t.flag,n,r,!1)})),i)&&this.flush()}setRenderArea(t){this.renderArea=t,this.flushWaitingViews()}isViewMounted(t){return null!=t&&!!(t=this.views[t.cell.id])&&t.state===Tg.ViewState.MOUNTED}renderViews(t,e={}){t.sort(((t,e)=>t.isNode()&&e.isEdge()?-1:0)),t.forEach((t=>{var n=t.id;let r=0,i=this.views[n];i?r=Tg.FLAG_INSERT:(t=this.createCellView(t))&&(t.graph=this.graph,r=Tg.FLAG_INSERT|t.getBootstrapFlag(),i={view:t,flag:r,options:e,state:Tg.ViewState.CREATED},this.views[n]=i),i&&this.requestViewUpdate(i.view,r,e,this.getRenderPriority(i.view),!1)})),this.flush()}renderViewInArea(t,e,n={}){var r=t.cell,i=r.id,s=this.views[i];if(s){let o=0;this.isUpdatable(t)||s.state===Tg.ViewState.MOUNTED?(o=this.updateView(t,e,n),s.flag=o):s.state=Tg.ViewState.WAITING,o&&r.isEdge()&&0==(o&t.getFlag(["source","target"]))&&this.queue.queueJob({id:i,priority:xg.RenderEdge,cb:()=>{this.updateView(t,e,n)}})}}removeViews(t){t.forEach((t=>{t=t.id;const e=this.views[t];e&&(this.willRemoveViews[t]=e,delete this.views[t],this.queue.queueJob({id:t,priority:this.getRenderPriority(e.view),cb:()=>{this.removeView(e.view)}}))})),this.flush()}flush(){this.graph.options.async?this.queue.queueFlush():this.queue.queueFlushSync()}flushWaitingViews(){Object.values(this.views).forEach((t=>{var e,n;t&&t.state===Tg.ViewState.WAITING&&(({view:t,flag:e,options:n}=t),this.requestViewUpdate(t,e,n,this.getRenderPriority(t),!1))})),this.flush()}updateView(t,e,n={}){if(null==t)return 0;if(jh.isCellView(t)){if(e&Tg.FLAG_REMOVE)return this.removeView(t.cell),0;e&Tg.FLAG_INSERT&&(this.insertView(t),e^=Tg.FLAG_INSERT)}return e?t.confirmUpdate(e,n):0}insertView(t){var e,n=this.views[t.cell.id];n&&(e=t.cell.getZIndex(),e=this.addZPivot(e),this.container.insertBefore(t.container,e),t.cell.isVisible()||this.toggleVisible(t.cell,!1),n.state=Tg.ViewState.MOUNTED,this.graph.trigger("view:mounted",{view:t}))}resetViews(){this.willRemoveViews=Object.assign(Object.assign({},this.views),this.willRemoveViews),Object.values(this.willRemoveViews).forEach((t=>{t&&this.removeView(t.view)})),this.views={},this.willRemoveViews={}}removeView(t){var e=t.cell,n=this.willRemoveViews[e.id];n&&t&&(n.view.remove(),delete this.willRemoveViews[e.id],this.graph.trigger("view:unmounted",{view:t}))}toggleVisible(t,e){var n=this.model.getConnectedEdges(t);for(let o=0,a=n.length;o<a;o+=1){var r,i,s=n[o];e?(r=s.getSourceCell(),i=s.getTargetCell(),r&&!r.isVisible()||i&&!i.isVisible()||this.toggleVisible(s,!0)):this.toggleVisible(s,!1)}t=this.views[t.id],t&&$r(t.view.container,{display:e?"unset":"none"})}addZPivot(t=0){null==this.zPivots&&(this.zPivots={});var e=this.zPivots,n=e[t];if(!n){n=e[t]=document.createComment("z-index:"+(t+1));let s=-1/0;for(const n in e){var r=+n;r<t&&r>s&&(s=r)}var i=this.container;s!==-1/0?(e=e[s],i.insertBefore(n,e.nextSibling)):i.insertBefore(n,i.firstChild)}return n}removeZPivots(){this.zPivots&&Object.values(this.zPivots).forEach((t=>{t&&t.parentNode&&t.parentNode.removeChild(t)})),this.zPivots={}}createCellView(t){var e={graph:this.graph},n=this.graph.options.createCellView;if(n){if(n=M(n,this.graph,t),n)return new n(t,e);if(null===n)return null}var r;n=t.view;return null!=n&&"string"==typeof n?(r=jh.registry.get(n))?new r(t,e):jh.registry.onNotFound(n):t.isNode()?new ug(t,e):t.isEdge()?new dg(t,e):null}getEffectedEdges(t){var e=[],n=t.cell,r=this.model.getConnectedEdges(n);for(let a=0,l=r.length;a<l;a+=1){var i,s=r[a],o=this.views[s.id];o&&(o=o.view,this.isViewMounted(o))&&(i=["update"],s.getTargetCell()===n&&i.push("target"),s.getSourceCell()===n&&i.push("source"),e.push({id:s.id,view:o,flag:o.getFlag(i)}))}return e}isUpdatable(t){if(t.isNodeView())return!this.renderArea||this.renderArea.isIntersectWithRect(t.cell.getBBox());if(t.isEdgeView()){t=t.cell;var e=t.getSourceCell();t=t.getTargetCell();if(this.renderArea&&e&&t)return this.renderArea.isIntersectWithRect(e.getBBox())||this.renderArea.isIntersectWithRect(t.getBBox())}return!0}getRenderPriority(t){return t.cell.isNode()?xg.RenderNode:xg.RenderEdge}dispose(){this.stopListening(),Object.keys(this.views).forEach((t=>{this.views[t].view.dispose()})),this.views={}}}(function(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(o=(s<3?i(o):3<s?i(e,n,o):i(e,n))||o);3<s&&o&&Object.defineProperty(e,n,o)})([w.dispose()],Tg.prototype,"dispose",null),(ye=Tg=Tg||{}).FLAG_INSERT=1<<30,ye.FLAG_REMOVE=1<<29,ye.FLAG_RENDER=67108863,(we=(we=Tg=Tg||{}).ViewState||(we.ViewState={}))[we.CREATED=0]="CREATED",we[we.MOUNTED=1]="MOUNTED",we[we.WAITING=2]="WAITING";class Ng extends fg{constructor(){super(...arguments),this.schedule=new Tg(this.graph)}requestViewUpdate(t,e,n={}){this.schedule.requestViewUpdate(t,e,n)}isViewMounted(t){return this.schedule.isViewMounted(t)}setRenderArea(t){this.schedule.setRenderArea(t)}findViewByElem(t){if(null!=t){var e=this.options.container;e="string"==typeof t?e.querySelector(t):t instanceof Element?t:t[0];if(e&&(t=this.graph.view.findAttr("data-cell-id",e),t&&(e=this.schedule.views,e[t])))return e[t].view}return null}findViewByCell(t){var e;return null!=t&&(t=Dc.isCell(t)?t.id:t,(e=this.schedule.views)[t])?e[t].view:null}findViewsFromPoint(t){const e={x:t.x,y:t.y};return this.model.getCells().map((t=>this.findViewByCell(t))).filter((t=>null!=t&&fl.getBBox(t.container,{target:this.view.stage}).containsPoint(e)))}findEdgeViewsFromPoint(t,e=5){return this.model.getEdges().map((t=>this.findViewByCell(t))).filter((n=>!(null==n||(n=n.getClosestPoint(t),!n))&&n.distance(t)<=e))}findViewsInArea(t,e={}){const n=_s.create(t);return this.model.getCells().map((t=>this.findViewByCell(t))).filter((t=>!(!t||e.nodeOnly&&!t.isNodeView())&&(0===(t=fl.getBBox(t.container,{target:this.view.stage})).width?t.inflate(1,0):0===t.height&&t.inflate(0,1),e.strict?n.containsRect(t):n.isIntersectWithRect(t))))}dispose(){this.schedule.dispose()}}(function(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(o=(s<3?i(o):3<s?i(e,n,o):i(e,n))||o);3<s&&o&&Object.defineProperty(e,n,o)})([fg.dispose()],Ng.prototype,"dispose",null);var kg=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};class jg extends fg{get cid(){return this.graph.view.cid}get svg(){return this.view.svg}get defs(){return this.view.defs}isDefined(t){return null!=this.svg.getElementById(t)}filter(t){let e=t.id;var n=t.name;if(e=e||`filter-${n}-${this.cid}-`+Ue(JSON.stringify(t)),!this.isDefined(e)){var r=bs.registry.get(n);if(null==r)return bs.registry.onNotFound(n);n=r(t.args||{}),r=Object.assign(Object.assign({x:-1,y:-1,width:3,height:3,filterUnits:"objectBoundingBox"},t.attrs),{id:e}),Wr.create(Xl.sanitize(n),r).appendTo(this.defs)}return e}gradient(t){let e=t.id;var n=t.type;return e=e||`gradient-${n}-${this.cid}-`+Ue(JSON.stringify(t)),this.isDefined(e)||(n=`<${n}>${t.stops.map((t=>{var e=null!=t.opacity&&Number.isFinite(t.opacity)?t.opacity:1;return`<stop offset="${t.offset}" stop-color="${t.color}" stop-opacity="${e}"/>`})).join("")}</${n}>`,t=Object.assign({id:e},t.attrs),Wr.create(n,t).appendTo(this.defs)),e}marker(t){const{id:e,refX:n,refY:r,markerUnits:i,markerOrient:s,tagName:o,children:a}=t,l=kg(t,["id","refX","refY","markerUnits","markerOrient","tagName","children"]);let h=e;return h=h||`marker-${this.cid}-`+Ue(JSON.stringify(t)),this.isDefined(h)||("path"!==o&&delete l.d,t=Wr.create("marker",{refX:n,refY:r,id:h,overflow:"visible",orient:null!=s?s:"auto",markerUnits:i||"userSpaceOnUse"},a?a.map((t=>{var e=t["tagName"];t=kg(t,["tagName"]);return Wr.create(""+e||"path",gr(Object.assign(Object.assign({},l),t)))})):[Wr.create(o||"path",gr(l))]),this.defs.appendChild(t.node)),h}remove(t){t=this.svg.getElementById(t),t&&t.parentNode&&t.parentNode.removeChild(t)}}class Lg extends fg{getClientMatrix(){return Pi(this.view.stage.getScreenCTM())}getClientOffset(){var t=this.view.svg.getBoundingClientRect();return new Js(t.left,t.top)}getPageOffset(){return this.getClientOffset().translate(window.scrollX,window.scrollY)}snapToGrid(t,e){return("number"==typeof t?this.clientToLocalPoint(t,e):this.clientToLocalPoint(t.x,t.y)).snapToGrid(this.graph.getGridSize())}localToGraphPoint(t,e){return t=Js.create(t,e),fl.transformPoint(t,this.graph.matrix())}localToClientPoint(t,e){return t=Js.create(t,e),fl.transformPoint(t,this.getClientMatrix())}localToPagePoint(t,e){return("number"==typeof t?this.localToGraphPoint(t,e):this.localToGraphPoint(t)).translate(this.getPageOffset())}localToGraphRect(t,e,n,r){return t=_s.create(t,e,n,r),fl.transformRectangle(t,this.graph.matrix())}localToClientRect(t,e,n,r){return t=_s.create(t,e,n,r),fl.transformRectangle(t,this.getClientMatrix())}localToPageRect(t,e,n,r){return("number"==typeof t?this.localToGraphRect(t,e,n,r):this.localToGraphRect(t)).translate(this.getPageOffset())}graphToLocalPoint(t,e){return t=Js.create(t,e),fl.transformPoint(t,this.graph.matrix().inverse())}clientToLocalPoint(t,e){return t=Js.create(t,e),fl.transformPoint(t,this.getClientMatrix().inverse())}clientToGraphPoint(t,e){return t=Js.create(t,e),fl.transformPoint(t,this.graph.matrix().multiply(this.getClientMatrix().inverse()))}pageToLocalPoint(t,e){return t=Js.create(t,e).diff(this.getPageOffset()),this.graphToLocalPoint(t)}graphToLocalRect(t,e,n,r){return t=_s.create(t,e,n,r),fl.transformRectangle(t,this.graph.matrix().inverse())}clientToLocalRect(t,e,n,r){return t=_s.create(t,e,n,r),fl.transformRectangle(t,this.getClientMatrix().inverse())}clientToGraphRect(t,e,n,r){return t=_s.create(t,e,n,r),fl.transformRectangle(t,this.graph.matrix().multiply(this.getClientMatrix().inverse()))}pageToLocalRect(t,e,n,r){return t=_s.create(t,e,n,r),e=this.getPageOffset(),t.x-=e.x,t.y-=e.y,this.graphToLocalRect(t)}}class Bg extends fg{constructor(){super(...arguments),this.highlights={}}init(){this.startListening()}startListening(){this.graph.on("cell:highlight",this.onCellHighlight,this),this.graph.on("cell:unhighlight",this.onCellUnhighlight,this)}stopListening(){this.graph.off("cell:highlight",this.onCellHighlight,this),this.graph.off("cell:unhighlight",this.onCellUnhighlight,this)}onCellHighlight({view:t,magnet:e,options:n={}}){var r,i;n=this.resolveHighlighter(n);n&&(r=this.getHighlighterId(e,n),this.highlights[r]||((i=n.highlighter).highlight(t,e,Object.assign({},n.args)),this.highlights[r]={cellView:t,magnet:e,highlighter:i,args:n.args}))}onCellUnhighlight({magnet:t,options:e={}}){e=this.resolveHighlighter(e),e&&(t=this.getHighlighterId(t,e),this.unhighlight(t))}resolveHighlighter(t){var e,n=this.options;let r=t.highlighter;return null==r&&(t=t.type,r=t&&n.highlighting[t]||n.highlighting.default),null==r?null:(n=(t="string"==typeof r?{name:r}:r).name,null==(e=vl.registry.get(n))?vl.registry.onNotFound(n):(vl.check(n,e),{name:n,highlighter:e,args:t.args||{}}))}getHighlighterId(t,e){return Bn(t),e.name+t.id+JSON.stringify(e.args)}unhighlight(t){var e=this.highlights[t];e&&(e.highlighter.unhighlight(e.cellView,e.magnet,e.args),delete this.highlights[t])}dispose(){Object.keys(this.highlights).forEach((t=>this.unhighlight(t))),this.stopListening()}}(function(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(o=(s<3?i(o):3<s?i(e,n,o):i(e,n))||o);3<s&&o&&Object.defineProperty(e,n,o)})([Bg.dispose()],Bg.prototype,"dispose",null);class Rg extends fg{getScroller(){var t=this.graph.getPlugin("scroller");return t&&t.options.enabled?t:null}getContainer(){var t=this.getScroller();return(t||this.graph).container.parentElement}getSensorTarget(){var t=this.options.autoResize;if(t)return"boolean"==typeof t?this.getContainer():t}init(){if(this.options.autoResize){const t=this.getSensorTarget();t&&Ui.bind(t,(()=>{var e=t.offsetWidth,n=t.offsetHeight;this.resize(e,n)}))}}resize(t,e){var n=this.getScroller();(n||this.graph.transform).resize(t,e)}dispose(){Ui.clear(this.graph.container)}}(function(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(o=(s<3?i(o):3<s?i(e,n,o):i(e,n))||o);3<s&&o&&Object.defineProperty(e,n,o)})([fg.dispose()],Rg.prototype,"dispose",null);var Dg,Ig;xe=function(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(o=(s<3?i(o):3<s?i(e,n,o):i(e,n))||o);return 3<s&&o&&Object.defineProperty(e,n,o),o};class Vg extends yt{get container(){return this.options.container}get[Symbol.toStringTag](){return Vg.toStringTag}constructor(t){super(),this.installedPlugins=new Set,this.options=vg.get(t),this.css=new mg(this),this.view=new pg(this),this.defs=new jg(this),this.coord=new Lg(this),this.transform=new Pg(this),this.highlight=new Bg(this),this.grid=new Cg(this),this.background=new Ag(this),this.options.model?this.model=this.options.model:(this.model=new _c,this.model.graph=this),this.renderer=new Ng(this),this.panning=new Eg(this),this.mousewheel=new Mg(this),this.virtualRender=new Sg(this),this.size=new Rg(this)}isNode(t){return t.isNode()}isEdge(t){return t.isEdge()}resetCells(t,e={}){return this.model.resetCells(t,e),this}clearCells(t={}){return this.model.clear(t),this}toJSON(t={}){return this.model.toJSON(t)}parseJSON(t){return this.model.parseJSON(t)}fromJSON(t,e={}){return this.model.fromJSON(t,e),this}getCellById(t){return this.model.getCell(t)}addNode(t,e={}){return this.model.addNode(t,e)}addNodes(t,e={}){return this.addCell(t.map((t=>$c.isNode(t)?t:this.createNode(t))),e)}createNode(t){return this.model.createNode(t)}removeNode(t,e={}){return this.model.removeCell(t,e)}addEdge(t,e={}){return this.model.addEdge(t,e)}addEdges(t,e={}){return this.addCell(t.map((t=>Jc.isEdge(t)?t:this.createEdge(t))),e)}removeEdge(t,e={}){return this.model.removeCell(t,e)}createEdge(t){return this.model.createEdge(t)}addCell(t,e={}){return this.model.addCell(t,e),this}removeCell(t,e={}){return this.model.removeCell(t,e)}removeCells(t,e={}){return this.model.removeCells(t,e)}removeConnectedEdges(t,e={}){return this.model.removeConnectedEdges(t,e)}disconnectConnectedEdges(t,e={}){return this.model.disconnectConnectedEdges(t,e),this}hasCell(t){return this.model.has(t)}getCells(){return this.model.getCells()}getCellCount(){return this.model.total()}getNodes(){return this.model.getNodes()}getEdges(){return this.model.getEdges()}getOutgoingEdges(t){return this.model.getOutgoingEdges(t)}getIncomingEdges(t){return this.model.getIncomingEdges(t)}getConnectedEdges(t,e={}){return this.model.getConnectedEdges(t,e)}getRootNodes(){return this.model.getRoots()}getLeafNodes(){return this.model.getLeafs()}isRootNode(t){return this.model.isRoot(t)}isLeafNode(t){return this.model.isLeaf(t)}getNeighbors(t,e={}){return this.model.getNeighbors(t,e)}isNeighbor(t,e,n={}){return this.model.isNeighbor(t,e,n)}getSuccessors(t,e={}){return this.model.getSuccessors(t,e)}isSuccessor(t,e,n={}){return this.model.isSuccessor(t,e,n)}getPredecessors(t,e={}){return this.model.getPredecessors(t,e)}isPredecessor(t,e,n={}){return this.model.isPredecessor(t,e,n)}getCommonAncestor(...t){return this.model.getCommonAncestor(...t)}getSubGraph(t,e={}){return this.model.getSubGraph(t,e)}cloneSubGraph(t,e={}){return this.model.cloneSubGraph(t,e)}cloneCells(t){return this.model.cloneCells(t)}getNodesFromPoint(t,e){return this.model.getNodesFromPoint(t,e)}getNodesInArea(t,e,n,r,i){return this.model.getNodesInArea(t,e,n,r,i)}getNodesUnderNode(t,e={}){return this.model.getNodesUnderNode(t,e)}searchCell(t,e,n={}){return this.model.search(t,e,n),this}getShortestPath(t,e,n={}){return this.model.getShortestPath(t,e,n)}getAllCellsBBox(){return this.model.getAllCellsBBox()}getCellsBBox(t,e={}){return this.model.getCellsBBox(t,e)}startBatch(t,e={}){this.model.startBatch(t,e)}stopBatch(t,e={}){this.model.stopBatch(t,e)}batchUpdate(t,e,n){var r="string"==typeof t?t:"update";t="string"==typeof t?e:t,n="function"==typeof e?n:e,this.startBatch(r,n),e=t();return this.stopBatch(r,n),e}updateCellId(t,e){return this.model.updateCellId(t,e)}findView(t){return Dc.isCell(t)?this.findViewByCell(t):this.findViewByElem(t)}findViews(t){return _s.isRectangleLike(t)?this.findViewsInArea(t):Js.isPointLike(t)?this.findViewsFromPoint(t):[]}findViewByCell(t){return this.renderer.findViewByCell(t)}findViewByElem(t){return this.renderer.findViewByElem(t)}findViewsFromPoint(t,e){return this.renderer.findViewsFromPoint("number"==typeof t?{x:t,y:e}:t)}findViewsInArea(t,e,n,r,i){return this.renderer.findViewsInArea("number"==typeof t?{x:t,y:e,width:n,height:r}:t,"number"==typeof t?i:e)}matrix(t){return void 0===t?this.transform.getMatrix():(this.transform.setMatrix(t),this)}resize(t,e){var n=this.getPlugin("scroller");return(n||this.transform).resize(t,e),this}scale(t,e=t,n=0,r=0){return void 0===t?this.transform.getScale():(this.transform.scale(t,e,n,r),this)}zoom(t,e){var n=this.getPlugin("scroller");if(n){if(void 0===t)return n.zoom();n.zoom(t,e)}else{if(void 0===t)return this.transform.getZoom();this.transform.zoom(t,e)}return this}zoomTo(t,e={}){var n=this.getPlugin("scroller");return(n||this.transform).zoom(t,Object.assign(Object.assign({},e),{absolute:!0})),this}zoomToRect(t,e={}){var n=this.getPlugin("scroller");return(n||this.transform).zoomToRect(t,e),this}zoomToFit(t={}){var e=this.getPlugin("scroller");return(e||this.transform).zoomToFit(t),this}rotate(t,e,n){return void 0===t?this.transform.getRotation():(this.transform.rotate(t,e,n),this)}translate(t,e){return void 0===t?this.transform.getTranslation():(this.transform.translate(t,e),this)}translateBy(t,e){var n=this.translate();t=n.tx+t,n=n.ty+e;return this.translate(t,n)}getGraphArea(){return this.transform.getGraphArea()}getContentArea(t={}){return this.transform.getContentArea(t)}getContentBBox(t={}){return this.transform.getContentBBox(t)}fitToContent(t,e,n,r){return this.transform.fitToContent(t,e,n,r)}scaleContentToFit(t={}){return this.transform.scaleContentToFit(t),this}center(t){return this.centerPoint(t)}centerPoint(t,e,n){var r=this.getPlugin("scroller");return r?r.centerPoint(t,e,n):this.transform.centerPoint(t,e),this}centerContent(t){var e=this.getPlugin("scroller");return(e||this.transform).centerContent(t),this}centerCell(t,e){var n=this.getPlugin("scroller");return n?n.centerCell(t,e):this.transform.centerCell(t),this}positionPoint(t,e,n,r={}){var i=this.getPlugin("scroller");return i?i.positionPoint(t,e,n,r):this.transform.positionPoint(t,e,n),this}positionRect(t,e,n){var r=this.getPlugin("scroller");return r?r.positionRect(t,e,n):this.transform.positionRect(t,e),this}positionCell(t,e,n){var r=this.getPlugin("scroller");return r?r.positionCell(t,e,n):this.transform.positionCell(t,e),this}positionContent(t,e){var n=this.getPlugin("scroller");return(n||this.transform).positionContent(t,e),this}snapToGrid(t,e){return this.coord.snapToGrid(t,e)}pageToLocal(t,e,n,r){return _s.isRectangleLike(t)?this.coord.pageToLocalRect(t):"number"==typeof t&&"number"==typeof e&&"number"==typeof n&&"number"==typeof r?this.coord.pageToLocalRect(t,e,n,r):this.coord.pageToLocalPoint(t,e)}localToPage(t,e,n,r){return _s.isRectangleLike(t)?this.coord.localToPageRect(t):"number"==typeof t&&"number"==typeof e&&"number"==typeof n&&"number"==typeof r?this.coord.localToPageRect(t,e,n,r):this.coord.localToPagePoint(t,e)}clientToLocal(t,e,n,r){return _s.isRectangleLike(t)?this.coord.clientToLocalRect(t):"number"==typeof t&&"number"==typeof e&&"number"==typeof n&&"number"==typeof r?this.coord.clientToLocalRect(t,e,n,r):this.coord.clientToLocalPoint(t,e)}localToClient(t,e,n,r){return _s.isRectangleLike(t)?this.coord.localToClientRect(t):"number"==typeof t&&"number"==typeof e&&"number"==typeof n&&"number"==typeof r?this.coord.localToClientRect(t,e,n,r):this.coord.localToClientPoint(t,e)}localToGraph(t,e,n,r){return _s.isRectangleLike(t)?this.coord.localToGraphRect(t):"number"==typeof t&&"number"==typeof e&&"number"==typeof n&&"number"==typeof r?this.coord.localToGraphRect(t,e,n,r):this.coord.localToGraphPoint(t,e)}graphToLocal(t,e,n,r){return _s.isRectangleLike(t)?this.coord.graphToLocalRect(t):"number"==typeof t&&"number"==typeof e&&"number"==typeof n&&"number"==typeof r?this.coord.graphToLocalRect(t,e,n,r):this.coord.graphToLocalPoint(t,e)}clientToGraph(t,e,n,r){return _s.isRectangleLike(t)?this.coord.clientToGraphRect(t):"number"==typeof t&&"number"==typeof e&&"number"==typeof n&&"number"==typeof r?this.coord.clientToGraphRect(t,e,n,r):this.coord.clientToGraphPoint(t,e)}defineFilter(t){return this.defs.filter(t)}defineGradient(t){return this.defs.gradient(t)}defineMarker(t){return this.defs.marker(t)}getGridSize(){return this.grid.getGridSize()}setGridSize(t){return this.grid.setGridSize(t),this}showGrid(){return this.grid.show(),this}hideGrid(){return this.grid.hide(),this}clearGrid(){return this.grid.clear(),this}drawGrid(t){return this.grid.draw(t),this}updateBackground(){return this.background.update(),this}drawBackground(t,e){var n=this.getPlugin("scroller");return null==n||null!=this.options.background&&e?this.background.draw(t):n.drawBackground(t,e),this}clearBackground(t){var e=this.getPlugin("scroller");return null==e||null!=this.options.background&&t?this.background.clear():e.clearBackground(t),this}enableVirtualRender(){return this.virtualRender.enableVirtualRender(),this}disableVirtualRender(){return this.virtualRender.disableVirtualRender(),this}isMouseWheelEnabled(){return!this.mousewheel.disabled}enableMouseWheel(){return this.mousewheel.enable(),this}disableMouseWheel(){return this.mousewheel.disable(),this}toggleMouseWheel(t){return null==t?this.isMouseWheelEnabled()?this.disableMouseWheel():this.enableMouseWheel():t?this.enableMouseWheel():this.disableMouseWheel(),this}isPannable(){var t=this.getPlugin("scroller");return t?t.isPannable():this.panning.pannable}enablePanning(){var t=this.getPlugin("scroller");return(t||this.panning).enablePanning(),this}disablePanning(){var t=this.getPlugin("scroller");return(t||this.panning).disablePanning(),this}togglePanning(t){return null==t?this.isPannable()?this.disablePanning():this.enablePanning():t!==this.isPannable()&&(t?this.enablePanning():this.disablePanning()),this}use(t,...e){return this.installedPlugins.has(t)||(this.installedPlugins.add(t),t.init(this,...e)),this}getPlugin(t){return Array.from(this.installedPlugins).find((e=>e.name===t))}getPlugins(t){return Array.from(this.installedPlugins).filter((e=>t.includes(e.name)))}enablePlugins(t){let e=t;return Array.isArray(e)||(e=[e]),t=this.getPlugins(e),null!=t&&t.forEach((t=>{var e;null!=(e=null==t?void 0:t.enable)&&e.call(t)})),this}disablePlugins(t){let e=t;return Array.isArray(e)||(e=[e]),t=this.getPlugins(e),null!=t&&t.forEach((t=>{var e;null!=(e=null==t?void 0:t.disable)&&e.call(t)})),this}isPluginEnabled(t){var e;t=this.getPlugin(t);return null==(e=null==t?void 0:t.isEnabled)?void 0:e.call(t)}disposePlugins(t){let e=t;return Array.isArray(e)||(e=[e]),t=this.getPlugins(e),null!=t&&t.forEach((t=>{t.dispose(),this.installedPlugins.delete(t)})),this}dispose(t=!0){t&&this.model.dispose(),this.css.dispose(),this.defs.dispose(),this.grid.dispose(),this.coord.dispose(),this.transform.dispose(),this.highlight.dispose(),this.background.dispose(),this.mousewheel.dispose(),this.panning.dispose(),this.view.dispose(),this.renderer.dispose(),this.installedPlugins.forEach((t=>{t.dispose()}))}}xe([yt.dispose()],Vg.prototype,"dispose",null),(f=Vg=Vg||{}).View=pg,f.Renderer=Ng,f.MouseWheel=Mg,f.DefsManager=jg,f.GridManager=Cg,f.CoordManager=Lg,f.TransformManager=Pg,f.HighlightManager=Bg,f.BackgroundManager=Ag,f.PanningManager=Eg,(Dg=Vg=Vg||{}).toStringTag="X6."+Dg.name,Dg.isGraph=function(t){return null!=t&&(t instanceof Dg||null==(t=t[Symbol.toStringTag])||t===Dg.toStringTag)},(Ig=Vg=Vg||{}).render=function(t,e){return t=t instanceof HTMLElement?new Ig({container:t}):new Ig(t),null!=e&&t.fromJSON(e),t},(c=Vg=Vg||{}).registerNode=$c.registry.register,c.registerEdge=Jc.registry.register,c.registerView=jh.registry.register,c.registerAttr=pl.registry.register,c.registerGrid=No.registry.register,c.registerFilter=bs.registry.register,c.registerNodeTool=iu.registry.register,c.registerEdgeTool=su.registry.register,c.registerBackground=ys.registry.register,c.registerHighlighter=vl.registry.register,c.registerPortLayout=Zl.registry.register,c.registerPortLabelLayout=Ul.registry.register,c.registerMarker=sl.registry.register,c.registerRouter=Nu.registry.register,c.registerConnector=ku.registry.register,c.registerAnchor=wu.registry.register,c.registerEdgeAnchor=Su.registry.register,c.registerConnectionPoint=Ou.registry.register,(m=Vg=Vg||{}).unregisterNode=$c.registry.unregister,m.unregisterEdge=Jc.registry.unregister,m.unregisterView=jh.registry.unregister,m.unregisterAttr=pl.registry.unregister,m.unregisterGrid=No.registry.unregister,m.unregisterFilter=bs.registry.unregister,m.unregisterNodeTool=iu.registry.unregister,m.unregisterEdgeTool=su.registry.unregister,m.unregisterBackground=ys.registry.unregister,m.unregisterHighlighter=vl.registry.unregister,m.unregisterPortLayout=Zl.registry.unregister,m.unregisterPortLabelLayout=Ul.registry.unregister,m.unregisterMarker=sl.registry.unregister,m.unregisterRouter=Nu.registry.unregister,m.unregisterConnector=ku.registry.unregister,m.unregisterAnchor=wu.registry.unregister,m.unregisterEdgeAnchor=Su.registry.unregister,m.unregisterConnectionPoint=Ou.registry.unregister;be=function(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(o=(s<3?i(o):3<s?i(e,n,o):i(e,n))||o);return 3<s&&o&&Object.defineProperty(e,n,o),o};var zg,Fg=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};class $g extends $c{}{var Gg=$g=$g||{};class bd extends ug{init(){super.init(),this.cell.on("change:*",this.onCellChangeAny,this)}onCellChangeAny({key:t}){var e=Gg.shapeMaps[this.cell.shape];e&&(e=e["effect"],e&&!e.includes(t)||this.renderHTMLComponent())}confirmUpdate(t){return t=super.confirmUpdate(t),this.handleAction(t,bd.action,(()=>this.renderHTMLComponent()))}renderHTMLComponent(){var t=this.selectors&&this.selectors.foContent;if(t){Yn(t);var e=Gg.shapeMaps[this.cell.shape];if(e){let n=e["html"];(n="function"==typeof n?n(this.cell):n)&&("string"==typeof n?t.innerHTML=n:_n(t,n))}}}dispose(){this.cell.off("change:*",this.onCellChangeAny,this)}}be([bd.dispose()],bd.prototype,"dispose",null),Gg.View=bd,(v=bd=Gg.View||(Gg.View={})).action="html",v.config({bootstrap:[v.action],actions:{html:v.action}}),ug.registry.register("html-view",v,!0)}(g=$g=$g||{}).config({view:"html-view",markup:[{tagName:"rect",selector:"body"},Object.assign({},Xl.getForeignObjectMarkup()),{tagName:"text",selector:"label"}],attrs:{body:{fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"},fo:{refWidth:"100%",refHeight:"100%"}}}),$c.registry.register("html",g,!0),(zg=$g=$g||{}).shapeMaps={},zg.register=function(t){var{shape:e,html:n,effect:r,inherit:i}=t;t=Fg(t,["shape","html","effect","inherit"]);if(!e)throw new Error("should specify shape in config");zg.shapeMaps[e]={html:n,effect:r},Vg.registerNode(e,Object.assign({inherit:i||"html"},t),!0)}}}]);